{"ast":null,"code":"import * as React from 'react';\nimport { useState, useRef, useEffect, useContext, useMemo, forwardRef, useImperativeHandle } from 'react';\nimport { MountedMapsContext } from './use-map';\nimport Mapbox from '../mapbox/mapbox';\nimport createRef from '../mapbox/create-ref';\nimport useIsomorphicLayoutEffect from '../utils/use-isomorphic-layout-effect';\nimport setGlobals from '../utils/set-globals';\nexport const MapContext = React.createContext(null);\nconst defaultProps = {\n  // Constraints\n  minZoom: 0,\n  maxZoom: 22,\n  minPitch: 0,\n  maxPitch: 60,\n  // Interaction handlers\n  scrollZoom: true,\n  boxZoom: true,\n  dragRotate: true,\n  dragPan: true,\n  keyboard: true,\n  doubleClickZoom: true,\n  touchZoomRotate: true,\n  touchPitch: true,\n  // Style\n  mapStyle: {\n    version: 8,\n    sources: {},\n    layers: []\n  },\n  styleDiffing: true,\n  projection: 'mercator',\n  renderWorldCopies: true,\n  // Callbacks\n  onError: e => console.error(e.error),\n  // Globals\n  RTLTextPlugin: 'https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js'\n};\nconst Map = forwardRef((props, ref) => {\n  const mountedMapsContext = useContext(MountedMapsContext);\n  const [mapInstance, setMapInstance] = useState(null);\n  const containerRef = useRef();\n  const {\n    current: contextValue\n  } = useRef({\n    mapLib: null,\n    map: null\n  });\n  useEffect(() => {\n    const mapLib = props.mapLib;\n    let isMounted = true;\n    let mapbox;\n    Promise.resolve(mapLib || import('mapbox-gl')).then(mapboxgl => {\n      if (!isMounted) {\n        return;\n      }\n\n      if (!mapboxgl.Map) {\n        // commonjs style\n        mapboxgl = mapboxgl.default;\n      }\n\n      if (!mapboxgl || !mapboxgl.Map) {\n        throw new Error('Invalid mapLib');\n      }\n\n      if (mapboxgl.supported(props)) {\n        setGlobals(mapboxgl, props);\n\n        if (props.reuseMaps) {\n          mapbox = Mapbox.reuse(props, containerRef.current);\n        }\n\n        if (!mapbox) {\n          mapbox = new Mapbox(mapboxgl.Map, props, containerRef.current);\n        }\n\n        contextValue.map = createRef(mapbox, mapboxgl);\n        contextValue.mapLib = mapboxgl;\n        setMapInstance(mapbox);\n        mountedMapsContext?.onMapMount(contextValue.map, props.id);\n      } else {\n        throw new Error('Map is not supported by this browser');\n      }\n    }).catch(error => {\n      props.onError({\n        type: 'error',\n        target: null,\n        originalEvent: null,\n        error\n      });\n    });\n    return () => {\n      isMounted = false;\n\n      if (mapbox) {\n        mountedMapsContext?.onMapUnmount(props.id);\n\n        if (props.reuseMaps) {\n          mapbox.recycle();\n        } else {\n          mapbox.destroy();\n        }\n      }\n    };\n  }, []);\n  useIsomorphicLayoutEffect(() => {\n    if (mapInstance) {\n      mapInstance.setProps(props);\n    }\n  });\n  useImperativeHandle(ref, () => contextValue.map, [mapInstance]);\n  const style = useMemo(() => ({\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    ...props.style\n  }), [props.style]);\n  return React.createElement(\"div\", {\n    id: props.id,\n    ref: containerRef,\n    style: style\n  }, mapInstance && React.createElement(MapContext.Provider, {\n    value: contextValue\n  }, props.children));\n});\nMap.displayName = 'Map';\nMap.defaultProps = defaultProps;\nexport default Map;","map":{"version":3,"mappings":"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","names":["React","useState","useRef","useEffect","useContext","useMemo","forwardRef","useImperativeHandle","MountedMapsContext","Mapbox","createRef","useIsomorphicLayoutEffect","setGlobals","MapContext","createContext","defaultProps","minZoom","maxZoom","minPitch","maxPitch","scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch","mapStyle","version","sources","layers","styleDiffing","projection","renderWorldCopies","onError","e","console","error","RTLTextPlugin","Map","props","ref","mountedMapsContext","mapInstance","setMapInstance","containerRef","current","contextValue","mapLib","map","isMounted","mapbox","Promise","resolve","then","mapboxgl","default","Error","supported","reuseMaps","reuse","onMapMount","id","catch","type","target","originalEvent","onMapUnmount","recycle","destroy","setProps","style","position","width","height","Provider","value","children","displayName"],"sources":["C:\\Users\\bhupe\\Downloads\\Term 4\\COMP4537\\MilestoneFinal\\ISAproject\\node_modules\\react-map-gl\\src\\components\\map.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  useState,\n  useRef,\n  useEffect,\n  useContext,\n  useMemo,\n  forwardRef,\n  useImperativeHandle\n} from 'react';\n\nimport {MountedMapsContext} from './use-map';\nimport Mapbox, {MapboxProps} from '../mapbox/mapbox';\nimport createRef, {MapRef} from '../mapbox/create-ref';\n\nimport type {CSSProperties} from 'react';\nimport useIsomorphicLayoutEffect from '../utils/use-isomorphic-layout-effect';\nimport setGlobals, {GlobalSettings} from '../utils/set-globals';\n\nexport type MapContextValue = {\n  mapLib: any;\n  map: MapRef;\n};\n\nexport const MapContext = React.createContext<MapContextValue>(null);\n\nexport type MapProps = MapboxProps &\n  GlobalSettings & {\n    mapLib?: any;\n    reuseMaps?: boolean;\n    /** Map container id */\n    id?: string;\n    /** Map container CSS style */\n    style?: CSSProperties;\n    children?: any;\n  };\n\nconst defaultProps: MapProps = {\n  // Constraints\n  minZoom: 0,\n  maxZoom: 22,\n  minPitch: 0,\n  maxPitch: 60,\n\n  // Interaction handlers\n  scrollZoom: true,\n  boxZoom: true,\n  dragRotate: true,\n  dragPan: true,\n  keyboard: true,\n  doubleClickZoom: true,\n  touchZoomRotate: true,\n  touchPitch: true,\n\n  // Style\n  mapStyle: {version: 8, sources: {}, layers: []},\n  styleDiffing: true,\n  projection: 'mercator',\n  renderWorldCopies: true,\n\n  // Callbacks\n  onError: e => console.error(e.error), // eslint-disable-line\n\n  // Globals\n  RTLTextPlugin:\n    'https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js'\n};\n\nconst Map = forwardRef<MapRef, MapProps>((props, ref) => {\n  const mountedMapsContext = useContext(MountedMapsContext);\n  const [mapInstance, setMapInstance] = useState<Mapbox>(null);\n  const containerRef = useRef();\n\n  const {current: contextValue} = useRef<MapContextValue>({mapLib: null, map: null});\n\n  useEffect(() => {\n    const mapLib = props.mapLib;\n    let isMounted = true;\n    let mapbox;\n\n    Promise.resolve(mapLib || import('mapbox-gl'))\n      .then(mapboxgl => {\n        if (!isMounted) {\n          return;\n        }\n\n        if (!mapboxgl.Map) {\n          // commonjs style\n          mapboxgl = mapboxgl.default;\n        }\n        if (!mapboxgl || !mapboxgl.Map) {\n          throw new Error('Invalid mapLib');\n        }\n\n        if (mapboxgl.supported(props)) {\n          setGlobals(mapboxgl, props);\n          if (props.reuseMaps) {\n            mapbox = Mapbox.reuse(props, containerRef.current);\n          }\n          if (!mapbox) {\n            mapbox = new Mapbox(mapboxgl.Map, props, containerRef.current);\n          }\n          contextValue.map = createRef(mapbox, mapboxgl);\n          contextValue.mapLib = mapboxgl;\n\n          setMapInstance(mapbox);\n          mountedMapsContext?.onMapMount(contextValue.map, props.id);\n        } else {\n          throw new Error('Map is not supported by this browser');\n        }\n      })\n      .catch(error => {\n        props.onError({\n          type: 'error',\n          target: null,\n          originalEvent: null,\n          error\n        });\n      });\n\n    return () => {\n      isMounted = false;\n      if (mapbox) {\n        mountedMapsContext?.onMapUnmount(props.id);\n        if (props.reuseMaps) {\n          mapbox.recycle();\n        } else {\n          mapbox.destroy();\n        }\n      }\n    };\n  }, []);\n\n  useIsomorphicLayoutEffect(() => {\n    if (mapInstance) {\n      mapInstance.setProps(props);\n    }\n  });\n\n  useImperativeHandle(ref, () => contextValue.map, [mapInstance]);\n\n  const style: CSSProperties = useMemo(\n    () => ({\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      ...props.style\n    }),\n    [props.style]\n  );\n\n  return (\n    <div id={props.id} ref={containerRef} style={style}>\n      {mapInstance && (\n        <MapContext.Provider value={contextValue}>{props.children}</MapContext.Provider>\n      )}\n    </div>\n  );\n});\n\nMap.displayName = 'Map';\nMap.defaultProps = defaultProps;\n\nexport default Map;\n"]},"metadata":{},"sourceType":"module"}