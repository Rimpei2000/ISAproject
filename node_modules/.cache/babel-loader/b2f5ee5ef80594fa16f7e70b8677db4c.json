{"ast":null,"code":"import _slicedToArray from\"C:/Users/bhupe/Downloads/Term 4/COMP4537/MilestoneFinal/ISAproject/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import react,{useState,useEffect}from\"react\";import Map,{Popup,Marker}from\"react-map-gl\";import Axios from\"axios\";import{Button}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function StreetFoodLocations(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),geopins=_useState2[0],setGeopins=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedFood=_useState4[0],setSelectedFood=_useState4[1];var streetFoodMarkers=[];var fetchStreetFoodLocs=function fetchStreetFoodLocs(){fetch(\"https://opendata.vancouver.ca/api/records/1.0/search/?dataset=food-vendors&q=&rows=100&facet=vendor_type&facet=status&facet=geo_localarea\").then(function(res){return res.json();}).then(function(result){for(var key in result.records){for(var internalKey in result.records[key]){var objData=result.records[key][internalKey];if(objData.geom!=undefined){streetFoodMarkers.push({longitude:objData.geom.coordinates[0],latitude:objData.geom.coordinates[1],name:objData.description,location:objData.location,id:objData.key});break;}}}setGeopins(streetFoodMarkers);});};var addMarkers=function addMarkers(){return geopins.map(function(ithMarker){return/*#__PURE__*/_jsx(Marker,{id:ithMarker.name,latitude:ithMarker.latitude,longitude:ithMarker.longitude,children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"none\",border:\"none\",cursor:\"pointer\"},onClick:function onClick(){setSelectedFood(ithMarker);},children:/*#__PURE__*/_jsx(\"img\",{style:{height:\"25px\"},src:\"./food.svg\",alt:ithMarker.name})})},ithMarker.id);});};var addPopup=function addPopup(){return geopins.map(function(ithMarker){return selectedFood&&selectedFood.id==ithMarker.id?/*#__PURE__*/_jsx(Popup,{id:ithMarker.id,latitude:ithMarker.latitude,longitude:ithMarker.longitude,offsetTop:-30,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:ithMarker.name}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:function onClick(){Axios.post(\"http://termproject.rshiratori.com/API/v1/AddFav\",{username:window.localStorage.getItem(\"username\"),favName:ithMarker.name,favCat:\"Food\",lat:ithMarker.latitude,lng:ithMarker.longitude});window.alert(\"Added\");},children:\"Add to favourites\"})]})}):null;});};useEffect(function(){fetchStreetFoodLocs();},[]);return/*#__PURE__*/_jsxs(Map,{initialViewState:{longitude:-123.19258095208848,latitude:49.25901995475811,zoom:11},style:{width:\"100vw\",height:\"100vh\",fog:{range:[-0.5,3],color:\"white\",\"horizon-blend\":0.1}},mapStyle:\"mapbox://styles/mapbox/streets-v9\",mapboxAccessToken:\"pk.eyJ1IjoiYmh1cGVzaGQiLCJhIjoiY2wxNXN1ZWVwMGoxNTNjcDhkZHh5Z2NsaCJ9.G67FI-pS8DZRWCX5Nt1vrA\",children:[addMarkers(),addPopup()]});}","map":{"version":3,"sources":["C:/Users/bhupe/Downloads/Term 4/COMP4537/MilestoneFinal/ISAproject/src/Components/activities/food.js"],"names":["react","useState","useEffect","Map","Popup","Marker","Axios","Button","StreetFoodLocations","geopins","setGeopins","selectedFood","setSelectedFood","streetFoodMarkers","fetchStreetFoodLocs","fetch","then","res","json","result","key","records","internalKey","objData","geom","undefined","push","longitude","coordinates","latitude","name","description","location","id","addMarkers","map","ithMarker","background","border","cursor","height","addPopup","post","username","window","localStorage","getItem","favName","favCat","lat","lng","alert","zoom","width","fog","range","color"],"mappings":"wJAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,GAAP,EAAcC,KAAd,CAAqBC,MAArB,KAAmC,cAAnC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,MAAT,KAAuB,iBAAvB,C,wFAEA,cAAe,SAASC,CAAAA,mBAAT,EAA+B,CAC5C,cAA8BP,QAAQ,CAAC,EAAD,CAAtC,wCAAOQ,OAAP,eAAgBC,UAAhB,eACA,eAAwCT,QAAQ,CAAC,IAAD,CAAhD,yCAAOU,YAAP,eAAqBC,eAArB,eACA,GAAMC,CAAAA,iBAAiB,CAAG,EAA1B,CAEA,GAAMC,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,EAAM,CAChCC,KAAK,CACH,2IADG,CAAL,CAGGC,IAHH,CAGQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EAHR,EAIGF,IAJH,CAIQ,SAACG,MAAD,CAAY,CAChB,IAAK,GAAIC,CAAAA,GAAT,GAAgBD,CAAAA,MAAM,CAACE,OAAvB,CAAgC,CAC9B,IAAK,GAAIC,CAAAA,WAAT,GAAwBH,CAAAA,MAAM,CAACE,OAAP,CAAeD,GAAf,CAAxB,CAA6C,CAC3C,GAAIG,CAAAA,OAAO,CAAGJ,MAAM,CAACE,OAAP,CAAeD,GAAf,EAAoBE,WAApB,CAAd,CACA,GAAIC,OAAO,CAACC,IAAR,EAAgBC,SAApB,CAA+B,CAC7BZ,iBAAiB,CAACa,IAAlB,CAAuB,CACrBC,SAAS,CAAEJ,OAAO,CAACC,IAAR,CAAaI,WAAb,CAAyB,CAAzB,CADU,CAErBC,QAAQ,CAAEN,OAAO,CAACC,IAAR,CAAaI,WAAb,CAAyB,CAAzB,CAFW,CAGrBE,IAAI,CAAEP,OAAO,CAACQ,WAHO,CAIrBC,QAAQ,CAAET,OAAO,CAACS,QAJG,CAKrBC,EAAE,CAAEV,OAAO,CAACH,GALS,CAAvB,EAOA,MACD,CACF,CACF,CACDV,UAAU,CAACG,iBAAD,CAAV,CACD,CArBH,EAsBD,CAvBD,CAyBA,GAAMqB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvB,MAAOzB,CAAAA,OAAO,CAAC0B,GAAR,CAAY,SAACC,SAAD,CAAe,CAChC,mBACE,KAAC,MAAD,EAEE,EAAE,CAAEA,SAAS,CAACN,IAFhB,CAGE,QAAQ,CAAEM,SAAS,CAACP,QAHtB,CAIE,SAAS,CAAEO,SAAS,CAACT,SAJvB,uBAME,eACE,KAAK,CAAE,CAAEU,UAAU,CAAE,MAAd,CAAsBC,MAAM,CAAE,MAA9B,CAAsCC,MAAM,CAAE,SAA9C,CADT,CAEE,OAAO,CAAE,kBAAM,CACb3B,eAAe,CAACwB,SAAD,CAAf,CACD,CAJH,uBAME,YACE,KAAK,CAAE,CAAEI,MAAM,CAAE,MAAV,CADT,CAEE,GAAG,CAAC,YAFN,CAGE,GAAG,CAAEJ,SAAS,CAACN,IAHjB,EANF,EANF,EACOM,SAAS,CAACH,EADjB,CADF,CAqBD,CAtBM,CAAP,CAuBD,CAxBD,CA0BA,GAAMQ,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACrB,MAAOhC,CAAAA,OAAO,CAAC0B,GAAR,CAAY,SAACC,SAAD,CAAe,CAChC,MAAOzB,CAAAA,YAAY,EAAIA,YAAY,CAACsB,EAAb,EAAmBG,SAAS,CAACH,EAA7C,cACL,KAAC,KAAD,EACE,EAAE,CAAEG,SAAS,CAACH,EADhB,CAEE,QAAQ,CAAEG,SAAS,CAACP,QAFtB,CAGE,SAAS,CAAEO,SAAS,CAACT,SAHvB,CAIE,SAAS,CAAE,CAAC,EAJd,uBAME,oCACE,mBAAIS,SAAS,CAACN,IAAd,EADF,cAEE,KAAC,MAAD,EACE,OAAO,CAAC,mBADV,CAEE,OAAO,CAAE,kBAAM,CACbxB,KAAK,CAACoC,IAAN,CAAW,iDAAX,CAA8D,CAC5DC,QAAQ,CAAEC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CADkD,CAE5DC,OAAO,CAAEX,SAAS,CAACN,IAFyC,CAG5DkB,MAAM,CAAE,MAHoD,CAI5DC,GAAG,CAAEb,SAAS,CAACP,QAJ6C,CAK5DqB,GAAG,CAAEd,SAAS,CAACT,SAL6C,CAA9D,EAOAiB,MAAM,CAACO,KAAP,CAAa,OAAb,EACD,CAXH,+BAFF,GANF,EADK,CA0BH,IA1BJ,CA2BD,CA5BM,CAAP,CA6BD,CA9BD,CAgCAjD,SAAS,CAAC,UAAM,CACdY,mBAAmB,GACpB,CAFQ,CAEN,EAFM,CAAT,CAIA,mBACE,MAAC,GAAD,EACE,gBAAgB,CAAE,CAChBa,SAAS,CAAE,CAAC,kBADI,CAEhBE,QAAQ,CAAE,iBAFM,CAGhBuB,IAAI,CAAE,EAHU,CADpB,CAME,KAAK,CAAE,CACLC,KAAK,CAAE,OADF,CAELb,MAAM,CAAE,OAFH,CAGLc,GAAG,CAAE,CACHC,KAAK,CAAE,CAAC,CAAC,GAAF,CAAO,CAAP,CADJ,CAEHC,KAAK,CAAE,OAFJ,CAGH,gBAAiB,GAHd,CAHA,CANT,CAeE,QAAQ,CAAC,mCAfX,CAgBE,iBAAiB,CAAC,4FAhBpB,WAkBGtB,UAAU,EAlBb,CAmBGO,QAAQ,EAnBX,GADF,CAuBD","sourcesContent":["import react, { useState, useEffect } from \"react\";\r\nimport Map, { Popup, Marker } from \"react-map-gl\";\r\nimport Axios from \"axios\";\r\nimport { Button } from \"react-bootstrap\";\r\n\r\nexport default function StreetFoodLocations() {\r\n  const [geopins, setGeopins] = useState([]);\r\n  const [selectedFood, setSelectedFood] = useState(null);\r\n  const streetFoodMarkers = [];\r\n\r\n  const fetchStreetFoodLocs = () => {\r\n    fetch(\r\n      \"https://opendata.vancouver.ca/api/records/1.0/search/?dataset=food-vendors&q=&rows=100&facet=vendor_type&facet=status&facet=geo_localarea\"\r\n    )\r\n      .then((res) => res.json())\r\n      .then((result) => {\r\n        for (let key in result.records) {\r\n          for (let internalKey in result.records[key]) {\r\n            let objData = result.records[key][internalKey];\r\n            if (objData.geom != undefined) {\r\n              streetFoodMarkers.push({\r\n                longitude: objData.geom.coordinates[0],\r\n                latitude: objData.geom.coordinates[1],\r\n                name: objData.description,\r\n                location: objData.location,\r\n                id: objData.key,\r\n              });\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        setGeopins(streetFoodMarkers);\r\n      });\r\n  };\r\n\r\n  const addMarkers = () => {\r\n    return geopins.map((ithMarker) => {\r\n      return (\r\n        <Marker\r\n          key={ithMarker.id}\r\n          id={ithMarker.name}\r\n          latitude={ithMarker.latitude}\r\n          longitude={ithMarker.longitude}\r\n        >\r\n          <button\r\n            style={{ background: \"none\", border: \"none\", cursor: \"pointer\" }}\r\n            onClick={() => {\r\n              setSelectedFood(ithMarker);\r\n            }}\r\n          >\r\n            <img\r\n              style={{ height: \"25px\" }}\r\n              src=\"./food.svg\"\r\n              alt={ithMarker.name}\r\n            />\r\n          </button>\r\n        </Marker>\r\n      );\r\n    });\r\n  };\r\n\r\n  const addPopup = () => {\r\n    return geopins.map((ithMarker) => {\r\n      return selectedFood && selectedFood.id == ithMarker.id ? (\r\n        <Popup\r\n          id={ithMarker.id}\r\n          latitude={ithMarker.latitude}\r\n          longitude={ithMarker.longitude}\r\n          offsetTop={-30}\r\n        >\r\n          <div>\r\n            <p>{ithMarker.name}</p>\r\n            <Button\r\n              variant=\"outline-secondary\"\r\n              onClick={() => {\r\n                Axios.post(\"http://termproject.rshiratori.com/API/v1/AddFav\", {\r\n                  username: window.localStorage.getItem(\"username\"),\r\n                  favName: ithMarker.name,\r\n                  favCat: \"Food\",\r\n                  lat: ithMarker.latitude,\r\n                  lng: ithMarker.longitude,\r\n                });\r\n                window.alert(\"Added\");\r\n              }}\r\n            >\r\n              Add to favourites\r\n            </Button>\r\n          </div>\r\n        </Popup>\r\n      ) : null;\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchStreetFoodLocs();\r\n  }, []);\r\n\r\n  return (\r\n    <Map\r\n      initialViewState={{\r\n        longitude: -123.19258095208848,\r\n        latitude: 49.25901995475811,\r\n        zoom: 11,\r\n      }}\r\n      style={{\r\n        width: \"100vw\",\r\n        height: \"100vh\",\r\n        fog: {\r\n          range: [-0.5, 3],\r\n          color: \"white\",\r\n          \"horizon-blend\": 0.1,\r\n        },\r\n      }}\r\n      mapStyle=\"mapbox://styles/mapbox/streets-v9\"\r\n      mapboxAccessToken=\"pk.eyJ1IjoiYmh1cGVzaGQiLCJhIjoiY2wxNXN1ZWVwMGoxNTNjcDhkZHh5Z2NsaCJ9.G67FI-pS8DZRWCX5Nt1vrA\"\r\n    >\r\n      {addMarkers()}\r\n      {addPopup()}\r\n    </Map>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}