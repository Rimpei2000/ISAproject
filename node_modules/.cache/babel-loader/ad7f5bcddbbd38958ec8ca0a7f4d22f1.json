{"ast":null,"code":"import _slicedToArray from\"C:/Users/bhupe/Downloads/Term 4/COMP4537/MilestoneFinal/ISAproject/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import Map,{Popup,Marker}from\"react-map-gl\";import Axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function HeritageBuildings(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),geopins=_useState2[0],setGeopins=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedBuilding=_useState4[0],setSelectedBuilding=_useState4[1];var buildingMarkers=[];var fetchHeritageBuildings=function fetchHeritageBuildings(){fetch(\"https://opendata.vancouver.ca/api/records/1.0/search/?dataset=heritage-sites&q=1\").then(function(res){return res.json();}).then(function(result){for(var key in result.records){for(var internalKey in result.records[key]){var objData=result.records[key][internalKey];if(objData.geo_point_2d!=undefined){buildingMarkers.push({longitude:objData.geo_point_2d[1],latitude:objData.geo_point_2d[0],name:objData.buildingnamespecifics==\"N/A\"?objData.category:objData.buildingnamespecifics,id:objData.id});break;}}}setGeopins(buildingMarkers);});};var addMarkers=function addMarkers(){return geopins.map(function(ithMarker){return/*#__PURE__*/_jsx(Marker,{id:ithMarker.name,latitude:ithMarker.latitude,longitude:ithMarker.longitude,children:/*#__PURE__*/_jsx(\"button\",{id:\"markerButtonId-\".concat(ithMarker.id),style:{background:\"none\",border:\"none\",cursor:\"pointer\"},onClick:function onClick(){setSelectedBuilding(ithMarker);},children:/*#__PURE__*/_jsx(\"img\",{style:{height:\"25px\"},src:\"./building.svg\",alt:ithMarker.name})},\"markerButtonKey-\".concat(ithMarker.id))},\"marker-\".concat(ithMarker.id));});};// const addToFavourites = (ithMarker) => {\n//   let isDuplicate = false;\n//   for (let key in geopins) {\n//     if (geopins[key][\"id\"] == ithMarker[\"id\"]) {\n//       isDuplicate = true;\n//     }\n//   }\n//   if (!isDuplicate) {\n//     favouriteBuildings.push(ithMarker);\n//     window.alert(\"Added!\");\n//   } else {\n//     window.alert(\"Already exists\");\n//   }\n// };\nvar addPopup=function addPopup(){return geopins.map(function(ithMarker){return selectedBuilding&&selectedBuilding.id==ithMarker.id?/*#__PURE__*/_jsx(Popup,{id:ithMarker.id,latitude:ithMarker.latitude,longitude:ithMarker.longitude,offsetTop:-30,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:ithMarker.name}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){Axios.post(\"http://localhost:3022/API/v1/AddFav\",{username:window.localStorage.getItem(\"username\"),favName:ithMarker.name,favCat:\"Heritage Buildings\",lat:ithMarker.latitude,lng:ithMarker.longitude});window.alert(\"Added\");},children:\"Add to favourites\"})]})},\"popup-\".concat(ithMarker.id)):null;});};useEffect(function(){fetchHeritageBuildings();},[]);return/*#__PURE__*/_jsxs(Map,{initialViewState:{longitude:-123.19258095208848,latitude:49.25901995475811,zoom:11},style:{width:\"80vw\",height:\"80vh\",fog:{range:[-0.5,3],color:\"white\",\"horizon-blend\":0.1}},mapStyle:\"mapbox://styles/mapbox/streets-v9\",mapboxAccessToken:\"pk.eyJ1IjoiYmh1cGVzaGQiLCJhIjoiY2wxNXN1ZWVwMGoxNTNjcDhkZHh5Z2NsaCJ9.G67FI-pS8DZRWCX5Nt1vrA\",children:[addMarkers(),addPopup()]});}// <div\n//         style={{\n//           position: \"absolute\",\n//           top: \"10px\",\n//           left: \"10px\",\n//           zIndex: \"1\",\n//         }}\n//       >\n//         <h1>Something to be displayed</h1>\n//       </div>","map":{"version":3,"sources":["C:/Users/bhupe/Downloads/Term 4/COMP4537/MilestoneFinal/ISAproject/src/Components/activities/buildings.js"],"names":["useState","useEffect","Map","Popup","Marker","Axios","HeritageBuildings","geopins","setGeopins","selectedBuilding","setSelectedBuilding","buildingMarkers","fetchHeritageBuildings","fetch","then","res","json","result","key","records","internalKey","objData","geo_point_2d","undefined","push","longitude","latitude","name","buildingnamespecifics","category","id","addMarkers","map","ithMarker","background","border","cursor","height","addPopup","post","username","window","localStorage","getItem","favName","favCat","lat","lng","alert","zoom","width","fog","range","color"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport Map, { Popup, Marker } from \"react-map-gl\";\r\nimport Axios from \"axios\";\r\n\r\nexport default function HeritageBuildings() {\r\n  const [geopins, setGeopins] = useState([]);\r\n  const [selectedBuilding, setSelectedBuilding] = useState(null);\r\n  const buildingMarkers = [];\r\n\r\n  const fetchHeritageBuildings = () => {\r\n    fetch(\r\n      \"https://opendata.vancouver.ca/api/records/1.0/search/?dataset=heritage-sites&q=1\"\r\n    )\r\n      .then((res) => res.json())\r\n      .then((result) => {\r\n        for (let key in result.records) {\r\n          for (let internalKey in result.records[key]) {\r\n            let objData = result.records[key][internalKey];\r\n            if (objData.geo_point_2d != undefined) {\r\n              buildingMarkers.push({\r\n                longitude: objData.geo_point_2d[1],\r\n                latitude: objData.geo_point_2d[0],\r\n                name:\r\n                  objData.buildingnamespecifics == \"N/A\"\r\n                    ? objData.category\r\n                    : objData.buildingnamespecifics,\r\n                id: objData.id,\r\n              });\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        setGeopins(buildingMarkers);\r\n      });\r\n  };\r\n\r\n  const addMarkers = () => {\r\n    return geopins.map((ithMarker) => {\r\n      return (\r\n        <Marker\r\n          key={`marker-${ithMarker.id}`}\r\n          id={ithMarker.name}\r\n          latitude={ithMarker.latitude}\r\n          longitude={ithMarker.longitude}\r\n        >\r\n          <button\r\n            key={`markerButtonKey-${ithMarker.id}`}\r\n            id={`markerButtonId-${ithMarker.id}`}\r\n            style={{ background: \"none\", border: \"none\", cursor: \"pointer\" }}\r\n            onClick={() => {\r\n              setSelectedBuilding(ithMarker);\r\n            }}\r\n          >\r\n            <img\r\n              style={{ height: \"25px\" }}\r\n              src=\"./building.svg\"\r\n              alt={ithMarker.name}\r\n            />\r\n          </button>\r\n        </Marker>\r\n      );\r\n    });\r\n  };\r\n\r\n  // const addToFavourites = (ithMarker) => {\r\n  //   let isDuplicate = false;\r\n  //   for (let key in geopins) {\r\n  //     if (geopins[key][\"id\"] == ithMarker[\"id\"]) {\r\n  //       isDuplicate = true;\r\n  //     }\r\n  //   }\r\n  //   if (!isDuplicate) {\r\n  //     favouriteBuildings.push(ithMarker);\r\n\r\n  //     window.alert(\"Added!\");\r\n  //   } else {\r\n  //     window.alert(\"Already exists\");\r\n  //   }\r\n  // };\r\n\r\n  const addPopup = () => {\r\n    return geopins.map((ithMarker) => {\r\n      return selectedBuilding && selectedBuilding.id == ithMarker.id ? (\r\n        <Popup\r\n          key={`popup-${ithMarker.id}`}\r\n          id={ithMarker.id}\r\n          latitude={ithMarker.latitude}\r\n          longitude={ithMarker.longitude}\r\n          offsetTop={-30}\r\n        >\r\n          <div>\r\n            <p>{ithMarker.name}</p>\r\n            <button\r\n              onClick={() => {\r\n                Axios.post(\"http://localhost:3022/API/v1/AddFav\", {\r\n                  username: window.localStorage.getItem(\"username\"),\r\n                  favName: ithMarker.name,\r\n                  favCat: \"Heritage Buildings\",\r\n                  lat: ithMarker.latitude,\r\n                  lng: ithMarker.longitude,\r\n                });\r\n\r\n                window.alert(\"Added\");\r\n              }}\r\n            >\r\n              Add to favourites\r\n            </button>\r\n          </div>\r\n        </Popup>\r\n      ) : null;\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchHeritageBuildings();\r\n  }, []);\r\n\r\n  return (\r\n    <Map\r\n      initialViewState={{\r\n        longitude: -123.19258095208848,\r\n        latitude: 49.25901995475811,\r\n        zoom: 11,\r\n      }}\r\n      style={{\r\n        width: \"80vw\",\r\n        height: \"80vh\",\r\n        fog: {\r\n          range: [-0.5, 3],\r\n          color: \"white\",\r\n          \"horizon-blend\": 0.1,\r\n        },\r\n      }}\r\n      mapStyle=\"mapbox://styles/mapbox/streets-v9\"\r\n      mapboxAccessToken=\"pk.eyJ1IjoiYmh1cGVzaGQiLCJhIjoiY2wxNXN1ZWVwMGoxNTNjcDhkZHh5Z2NsaCJ9.G67FI-pS8DZRWCX5Nt1vrA\"\r\n    >\r\n      {addMarkers()}\r\n      {addPopup()}\r\n    </Map>\r\n  );\r\n}\r\n\r\n// <div\r\n//         style={{\r\n//           position: \"absolute\",\r\n//           top: \"10px\",\r\n//           left: \"10px\",\r\n//           zIndex: \"1\",\r\n//         }}\r\n//       >\r\n//         <h1>Something to be displayed</h1>\r\n//       </div>\r\n"]},"metadata":{},"sourceType":"module"}