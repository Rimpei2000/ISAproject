!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,function(){"use strict";!function(e){var t,n,o,r,i,s,a,c,l,u;function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return e="string"!=typeof e?String(e):e}function f(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function v(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(o&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(i&&o&&a(e))this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var e,t,n=g(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=m(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(e,t){var n,r=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(e=t.method||this.method||"GET",n=e.toUpperCase(),-1<l.indexOf(n)?n:e),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function b(e){var r=new FormData;return e.trim().split("&").forEach(function(e){var t,n;e&&(t=(n=e.split("=")).shift().replace(/\+/g," "),n=n.join("=").replace(/\+/g," "),r.append(decodeURIComponent(t),decodeURIComponent(n)))}),r}function I(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}e.fetch||(t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,(i="ArrayBuffer"in e)&&(s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&-1<s.indexOf(Object.prototype.toString.call(e))}),p.prototype.append=function(e,t){e=h(e),t=d(t);var n=this.map[e];this.map[e]=n?n+","+t:t},p.prototype.delete=function(e){delete this.map[h(e)]},p.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},p.prototype.set=function(e,t){this.map[h(e)]=d(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),f(n)},p.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),f(t)},p.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),f(n)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries),l=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},_.call(w.prototype),_.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:0,statusText:""});return e.type="error",e},u=[301,302,303,307,308],I.redirect=function(e,t){if(-1===u.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=w,e.Response=I,e.fetch=function(n,r){return new Promise(function(i,e){var t=new w(n,r),s=new XMLHttpRequest;s.onload=function(){var e,r,t={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",r=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),n=t.shift().trim();n&&(t=t.join(":").trim(),r.append(n,t))}),r)};t.url="responseURL"in s?s.responseURL:t.headers.get("X-Request-URL");var n="response"in s?s.response:s.responseText;i(new I(n,t))},s.onerror=function(){e(new TypeError("Network request failed"))},s.ontimeout=function(){e(new TypeError("Network request failed"))},s.open(t.method,t.url,!0),"include"===t.credentials?s.withCredentials=!0:"omit"===t.credentials&&(s.withCredentials=!1),"responseType"in s&&o&&(s.responseType="blob"),t.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0)}("undefined"!=typeof self?self:void 0);function e(e){try{return!!e()}catch(e){return!0}}function t(e){if(!g(e))throw TypeError(String(e)+" is not an object");return e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=function(e){return e&&e.Math==Math&&e},i=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||Function("return this")(),s={exports:{}},o=!e(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),a={},c=function(e){return"object"==typeof e?null!==e:"function"==typeof e},l=c,u=i.document,h=l(u)&&l(u.createElement),d=function(e){return h?u.createElement(e):{}},f=d,p=!o&&!e(function(){return 7!=Object.defineProperty(f("div"),"a",{get:function(){return 7}}).a}),g=c,m=c,v=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},y=p,_=t,w=v,b=Object.defineProperty;a.f=o?b:function(e,t,n){if(_(e),t=w(t,!0),_(n),y)try{return b(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var I=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},T=a,E=I,S=o?function(e,t,n){return T.f(e,t,E(1,n))}:function(e,t,n){return e[t]=n,e},k=i,C=S,A=function(t,n){try{C(k,t,n)}catch(e){k[t]=n}return n},N=A,R="__core-js_shared__",x=i[R]||N(R,{}),P=x;(s.exports=function(e,t){return P[e]||(P[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"});function D(e,t){return M.call(e,t)}function O(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++L+F).toString(36)}var M={}.hasOwnProperty,L=0,F=Math.random(),U=e,j=!!Object.getOwnPropertySymbols&&!U(function(){return!String(Symbol())}),V=j&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,q=i,B=s.exports,$=D,K=O,W=j,z=V,H=B("wks"),G=q.Symbol,Q=z?G:G&&G.withoutSetter||K,Y=function(e){return $(H,e)||(W&&$(G,e)?H[e]=G[e]:H[e]=Q("Symbol."+e)),H[e]},J={};J[Y("toStringTag")]="z";var X="[object z]"===String(J),Z={exports:{}},ee=x,te=Function.toString;"function"!=typeof ee.inspectSource&&(ee.inspectSource=function(e){return te.call(e)});var ne,re,ie,se,oe,ae,ce,le,ue=ee.inspectSource,he=ue,de=i.WeakMap,fe="function"==typeof de&&/native code/.test(he(de)),pe=s.exports,ge=O,me=pe("keys"),ve=function(e){return me[e]||(me[e]=ge(e))},ye={},_e=c,we=S,be=D,Ie=ve,Te=ye,Ee=i.WeakMap;ce=fe?(ne=new Ee,re=ne.get,ie=ne.has,se=ne.set,oe=function(e,t){return se.call(ne,e,t),t},ae=function(e){return re.call(ne,e)||{}},function(e){return ie.call(ne,e)}):(Te[le=Ie("state")]=!0,oe=function(e,t){return we(e,le,t),t},ae=function(e){return be(e,le)?e[le]:{}},function(e){return be(e,le)});var Se={set:oe,get:ae,has:ce,enforce:function(e){return ce(e)?ae(e):oe(e,{})},getterFor:function(n){return function(e){var t;if(!_e(e)||(t=ae(e)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return t}}},ke=i,Ce=S,Ae=D,Ne=A,Re=ue,xe=Se.get,Pe=Se.enforce,De=String(String).split("String");(Z.exports=function(e,t,n,r){var i=!!r&&!!r.unsafe,s=!!r&&!!r.enumerable,o=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||Ae(n,"name")||Ce(n,"name",t),Pe(n).source=De.join("string"==typeof t?t:"")),e!==ke?(i?!o&&e[t]&&(s=!0):delete e[t],s?e[t]=n:Ce(e,t,n)):s?e[t]=n:Ne(t,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&xe(this).source||Re(this)});var Oe={}.toString,Me=function(e){return Oe.call(e).slice(8,-1)},Le=X,Fe=Me,Ue=Y("toStringTag"),je="Arguments"==Fe(function(){return arguments}()),Ve=Le?Fe:function(e){var t,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Ue))?n:je?Fe(t):"Object"==(n=Fe(t))&&"function"==typeof t.callee?"Arguments":n},qe=Ve,Be=Z.exports;X||Be(Object.prototype,"toString",X?{}.toString:function(){return"[object "+qe(this)+"]"},{unsafe:!0});var $e=Math.ceil,Ke=Math.floor,We=function(e){return isNaN(e=+e)?0:(0<e?Ke:$e)(e)},ze=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},He=We,Ge=ze,Qe=function(a){return function(e,t){var n,r,i=String(Ge(e)),s=He(t),o=i.length;return s<0||o<=s?a?"":void 0:(n=i.charCodeAt(s))<55296||56319<n||s+1===o||(r=i.charCodeAt(s+1))<56320||57343<r?a?i.charAt(s):n:a?i.slice(s,s+2):r-56320+(n-55296<<10)+65536}},Ye={codeAt:Qe(!1),charAt:Qe(!0)},Je={},Xe={},Ze={}.propertyIsEnumerable,et=Object.getOwnPropertyDescriptor,tt=et&&!Ze.call({1:2},1);Xe.f=tt?function(e){var t=et(this,e);return!!t&&t.enumerable}:Ze;function nt(e){return at(ct(e))}var rt=e,it=Me,st="".split,ot=rt(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==it(e)?st.call(e,""):Object(e)}:Object,at=ot,ct=ze,lt=Xe,ut=I,ht=nt,dt=v,ft=D,pt=p,gt=Object.getOwnPropertyDescriptor;Je.f=o?gt:function(e,t){if(e=ht(e),t=dt(t,!0),pt)try{return gt(e,t)}catch(e){}if(ft(e,t))return ut(!lt.f.call(e,t),e[t])};function mt(e){return"function"==typeof e?e:void 0}function vt(e,t){return arguments.length<2?mt(_t[e])||mt(wt[e]):_t[e]&&_t[e][t]||wt[e]&&wt[e][t]}var yt=i,_t=yt,wt=i,bt={},It=We,Tt=Math.min,Et=function(e){return 0<e?Tt(It(e),9007199254740991):0},St=We,kt=Math.max,Ct=Math.min,At=nt,Nt=Et,Rt=function(e,t){var n=St(e);return n<0?kt(n+t,0):Ct(n,t)},xt=function(a){return function(e,t,n){var r,i=At(e),s=Nt(i.length),o=Rt(n,s);if(a&&t!=t){for(;o<s;)if((r=i[o++])!=r)return!0}else for(;o<s;o++)if((a||o in i)&&i[o]===t)return a||o||0;return!a&&-1}},r={includes:xt(!0),indexOf:xt(!1)},Pt=D,Dt=nt,Ot=r.indexOf,Mt=ye,n=function(e,t){var n,r=Dt(e),i=0,s=[];for(n in r)!Pt(Mt,n)&&Pt(r,n)&&s.push(n);for(;t.length>i;)Pt(r,n=t[i++])&&(~Ot(s,n)||s.push(n));return s},l=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Lt=n,Ft=l.concat("length","prototype");bt.f=Object.getOwnPropertyNames||function(e){return Lt(e,Ft)};N={};N.f=Object.getOwnPropertySymbols;var Ut=bt,jt=N,Vt=t,R=vt("Reflect","ownKeys")||function(e){var t=Ut.f(Vt(e)),n=jt.f;return n?t.concat(n(e)):t},qt=D,Bt=R,$t=Je,Kt=a,U=function(e,t){for(var n=Bt(t),r=Kt.f,i=$t.f,s=0;s<n.length;s++){var o=n[s];qt(e,o)||r(e,o,i(t,o))}},Wt=e,zt=/#|\.prototype\./,B=function(e,t){var n=Gt[Ht(e)];return n==Yt||n!=Qt&&("function"==typeof t?Wt(t):!!t)},Ht=B.normalize=function(e){return String(e).replace(zt,".").toLowerCase()},Gt=B.data={},Qt=B.NATIVE="N",Yt=B.POLYFILL="P",q=B,Jt=i,Xt=Je.f,Zt=S,en=Z.exports,tn=A,nn=U,rn=q,z=function(e,t){var n,r,i,s=e.target,o=e.global,a=e.stat,c=o?Jt:a?Jt[s]||tn(s,{}):(Jt[s]||{}).prototype;if(c)for(n in t){if(r=t[n],i=e.noTargetGet?(i=Xt(c,n))&&i.value:c[n],!rn(o?n:s+(a?".":"#")+n,e.forced)&&void 0!==i){if(typeof r==typeof i)continue;nn(r,i)}(e.sham||i&&i.sham)&&Zt(r,"sham",!0),en(c,n,r,e)}},sn=ze,K=function(e){return Object(sn(e))},J=!e(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),on=D,an=K,x=J,cn=ve("IE_PROTO"),ln=Object.prototype,ee=x?Object.getPrototypeOf:function(e){return e=an(e),on(e,cn)?e[cn]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ln:null},he=ee,de=S,pe=D,fe=Y("iterator"),Ee=!1;[].keys&&("next"in(or=[].keys())?(ar=he(he(or)))!==Object.prototype&&(Er=ar):Ee=!0),pe(Er=null==Er?{}:Er,fe)||de(Er,fe,function(){return this});function un(){}var hn,Te={IteratorPrototype:Er,BUGGY_SAFARI_ITERATORS:Ee},dn=n,fn=l,Ie=Object.keys||function(e){return dn(e,fn)},pn=a,gn=t,mn=Ie,Le=o?Object.defineProperties:function(e,t){gn(e);for(var n,r=mn(t),i=r.length,s=0;s<i;)pn.f(e,n=r[s++],t[n]);return e},Be=vt("document","documentElement"),vn=t,yn=Le,_n=l,X=ye,wn=Be,bn=d,In="prototype",Tn="script",En=ve("IE_PROTO"),Sn=function(e){return"<"+Tn+">"+e+"</"+Tn+">"},kn=function(){try{hn=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;kn=hn?function(e){e.write(Sn("")),e.close();var t=e.parentWindow.Object;return e=null,t}(hn):(e=bn("iframe"),t="java"+Tn+":",e.style.display="none",wn.appendChild(e),e.src=String(t),(e=e.contentWindow.document).open(),e.write(Sn("document.F=Object")),e.close(),e.F);for(var n=_n.length;n--;)delete kn[In][_n[n]];return kn()};X[En]=!0;function Cn(){return this}function An(){return this}var Qe=Object.create||function(e,t){var n;return null!==e?(un[In]=vn(e),n=new un,un[In]=null,n[En]=e):n=kn(),void 0===t?n:yn(n,t)},Nn=a.f,Rn=D,xn=Y("toStringTag"),tt=function(e,t,n){e&&!Rn(e=n?e:e.prototype,xn)&&Nn(e,xn,{configurable:!0,value:t})},Ze={},Pn=Te.IteratorPrototype,Dn=Qe,On=I,Mn=tt,Ln=Ze,Fn=c,Un=t,jn=function(e){if(!Fn(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e},rt=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return Un(e),jn(t),r?n.call(e,t):e.__proto__=t,e}}():void 0),Vn=z,qn=function(e,t,n){var r=t+" Iterator";return e.prototype=Dn(Pn,{next:On(1,n)}),Mn(e,r,!1),Ln[r]=Cn,e},Bn=ee,$n=rt,Kn=tt,Wn=S,zn=Z.exports,p=Y,Hn=Ze,Gn=Te.IteratorPrototype,Qn=Te.BUGGY_SAFARI_ITERATORS,Yn=p("iterator"),Jn="values",Xn="entries",xt=function(e,t,n,r,i,s,o){qn(n,t,r);function a(e){if(e===i&&p)return p;if(!Qn&&e in d)return d[e];switch(e){case"keys":case Jn:case Xn:return function(){return new n(this,e)}}return function(){return new n(this)}}var c,l,u=t+" Iterator",h=!1,d=e.prototype,f=d[Yn]||d["@@iterator"]||i&&d[i],p=!Qn&&f||a(i),g="Array"==t&&d.entries||f;if(g&&(g=Bn(g.call(new e)),Gn!==Object.prototype&&g.next&&(Bn(g)!==Gn&&($n?$n(g,Gn):"function"!=typeof g[Yn]&&Wn(g,Yn,An)),Kn(g,u,!0))),i==Jn&&f&&f.name!==Jn&&(h=!0,p=function(){return f.call(this)}),d[Yn]!==p&&Wn(d,Yn,p),Hn[t]=p,i)if(c={values:a(Jn),keys:s?p:a("keys"),entries:a(Xn)},o)for(l in c)!Qn&&!h&&l in d||zn(d,l,c[l]);else Vn({target:t,proto:!0,forced:Qn||h},c);return c},Zn=Ye.charAt,r=Se,R=xt,er="String Iterator",tr=r.set,nr=r.getterFor(er);R(String,"String",function(e){tr(this,{type:er,string:String(e),index:0})},function(){var e=nr(this),t=e.string,n=e.index;return n>=t.length?{value:void 0,done:!0}:(n=Zn(t,n),e.index+=n.length,{value:n,done:!1})});var B=Qe,A=a,rr=Y("unscopables"),ir=Array.prototype;null==ir[rr]&&A.f(ir,rr,{configurable:!0,value:B(null)});var J=function(e){ir[rr][e]=!0},sr=nt,x=J,he=Ze,or=Se,ar=xt,cr="Array Iterator",lr=or.set,ur=or.getterFor(cr),pe=ar(Array,"Array",function(e,t){lr(this,{type:cr,target:sr(e),index:0,kind:t})},function(){var e=ur(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");he.Arguments=he.Array,x("keys"),x("values"),x("entries");var hr,dr=i,fr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pr=pe,gr=S,de=Y,mr=de("iterator"),vr=de("toStringTag"),yr=pr.values;for(hr in fr){var _r=dr[hr],wr=_r&&_r.prototype;if(wr){if(wr[mr]!==yr)try{gr(wr,mr,yr)}catch(Eb){wr[mr]=yr}if(wr[vr]||gr(wr,vr,hr),fr[hr])for(var br in pr)if(wr[br]!==pr[br])try{gr(wr,br,pr[br])}catch(Eb){wr[br]=pr[br]}}}function Ir(e,t){this.stopped=e,this.result=t}var fe=i.Promise,Tr=Z.exports,Er=function(e,t,n){for(var r in t)Tr(e,r,t[r],n);return e},Sr=vt,kr=a,Cr=o,Ar=Y("species"),Ee=function(e){var t=Sr(e),n=kr.f;Cr&&t&&!t[Ar]&&n(t,Ar,{configurable:!0,get:function(){return this}})},n=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Le=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},l={exports:{}},Nr=Ze,Rr=Y("iterator"),xr=Array.prototype,X=function(e){return void 0!==e&&(Nr.Array===e||xr[Rr]===e)},Pr=n,Te=function(r,i,e){if(Pr(r),void 0===i)return r;switch(e){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}},Dr=Ve,Or=Ze,Mr=Y("iterator"),p=function(e){if(null!=e)return e[Mr]||e["@@iterator"]||Or[Dr(e)]},Lr=t,Ye=function(t,e,n,r){try{return r?e(Lr(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&Lr(i.call(t)),e}},Fr=t,Ur=X,jr=Et,Vr=Te,qr=p,Br=Ye;(l.exports=function(e,t,n,r,i){var s,o,a,c,l,u,h,d=Vr(t,n,r?2:1);if(i)s=e;else{if("function"!=typeof(o=qr(e)))throw TypeError("Target is not iterable");if(Ur(o)){for(a=0,c=jr(e.length);a<c;a++)if((l=r?d(Fr(h=e[a])[0],h[1]):d(e[a]))&&l instanceof Ir)return l;return new Ir(!1)}s=o.call(e)}for(u=s.next;!(h=u.call(s)).done;)if("object"==typeof(l=Br(s,d,h.value,r))&&l&&l instanceof Ir)return l;return new Ir(!1)}).stop=function(e){return new Ir(!0,e)};var $r=Y("iterator"),Kr=!1;try{var Wr=0,zr={next:function(){return{done:!!Wr++}},return:function(){Kr=!0}};zr[$r]=function(){return this},Array.from(zr,function(){throw 2})}catch(Eb){}function Hr(e){return function(){ai(e)}}var Gr,r=function(e,t){if(!t&&!Kr)return!1;var n=!1;try{var r={};r[$r]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Qr=t,Yr=n,Jr=Y("species"),R=function(e,t){var n,r=Qr(e).constructor;return void 0===r||null==(n=Qr(r)[Jr])?t:Yr(n)},A=vt("navigator","userAgent")||"",B=/(iphone|ipod|ipad).*applewebkit/i.test(A),Xr=i,or=e,ar=Me,he=Te,Zr=Be,ei=d,x=B,ti=Xr.location,de=Xr.setImmediate,Ze=Xr.clearImmediate,ni=Xr.process,zr=Xr.MessageChannel,ri=Xr.Dispatch,ii=0,si={},oi="onreadystatechange",ai=function(e){var t;si.hasOwnProperty(e)&&(t=si[e],delete si[e],t())},Be=function(e){ai(e.data)},d=function(e){Xr.postMessage(e+"",ti.protocol+"//"+ti.host)};de&&Ze||(de=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return si[++ii]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Gr(ii),ii},Ze=function(e){delete si[e]},"process"==ar(ni)?Gr=function(e){ni.nextTick(Hr(e))}:ri&&ri.now?Gr=function(e){ri.now(Hr(e))}:zr&&!x?(wi=(yi=new zr).port2,yi.port1.onmessage=Be,Gr=he(wi.postMessage,wi,1)):!Xr.addEventListener||"function"!=typeof postMessage||Xr.importScripts||or(d)||"file:"===ti.protocol?Gr=oi in ei("script")?function(e){Zr.appendChild(ei("script"))[oi]=function(){Zr.removeChild(this),ai(e)}}:function(e){setTimeout(Hr(e),0)}:(Gr=d,Xr.addEventListener("message",Be,!1)));var ci,li,ui,hi,di,fi,pi,gi,ar={set:de,clear:Ze},mi=i,x=Je.f,zr=Me,vi=ar.set,yi=B,he=mi.MutationObserver||mi.WebKitMutationObserver,_i=mi.process,wi=mi.Promise,bi="process"==zr(_i),or=x(mi,"queueMicrotask"),d=or&&or.value;d||(ci=function(){var e,t;for(bi&&(e=_i.domain)&&e.exit();li;){t=li.fn,li=li.next;try{t()}catch(e){throw li?hi():ui=void 0,e}}ui=void 0,e&&e.enter()},hi=bi?function(){_i.nextTick(ci)}:he&&!yi?(di=!0,fi=document.createTextNode(""),new he(ci).observe(fi,{characterData:!0}),function(){fi.data=di=!di}):wi&&wi.resolve?(pi=wi.resolve(void 0),gi=pi.then,function(){gi.call(pi,ci)}):function(){vi.call(mi,ci)});function Ii(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=Ti(n),this.reject=Ti(r)}var Be=d||function(e){var t={fn:e,next:void 0};ui&&(ui.next=t),li||(li=t,hi()),ui=t},de={},Ti=n;de.f=function(e){return new Ii(e)};var Ei=t,Si=c,ki=de,Ze=function(e,t){if(Ei(e),Si(t)&&t.constructor===e)return t;var n=ki.f(e);return(0,n.resolve)(t),n.promise},Ci=i,B=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},zr=A,x=i.process,or=x&&x.versions,yi=or&&or.v8;yi?ji=(Li=yi.split("."))[0]+Li[1]:zr&&(!(Li=zr.match(/Edge\/(\d+)/))||74<=Li[1])&&(Li=zr.match(/Chrome\/(\d+)/))&&(ji=Li[1]);var Ai,Ni,Ri,xi,he=ji&&+ji,wi=z,Pi=i,d=vt,A=fe,x=Z.exports,or=Er,yi=tt,zr=Ee,Di=c,Oi=n,Mi=Le,Li=Me,Fi=ue,Ui=l.exports,ji=r,Vi=R,qi=ar.set,Bi=Be,$i=Ze,Ki=function(e,t){var n=Ci.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))},ue=de,Wi=B,ar=Se,Be=q,zi=he,Hi=Y("species"),Gi="Promise",Qi=ar.get,Yi=ar.set,Ji=ar.getterFor(Gi),Xi=A,Zi=Pi.TypeError,es=Pi.document,ts=Pi.process,ns=d("fetch"),rs=ue.f,is=rs,ss="process"==Li(ts),os=!!(es&&es.createEvent&&Pi.dispatchEvent),as="unhandledrejection",cs="rejectionhandled",ls=1,us=2,hs=1,ds=2,Be=Be(Gi,function(){if(!(Fi(Xi)!==String(Xi))){if(66===zi)return!0;if(!ss&&"function"!=typeof PromiseRejectionEvent)return!0}if(51<=zi&&/native code/.test(Xi))return!1;function e(e){e(function(){},function(){})}var t=Xi.resolve(1);return(t.constructor={})[Hi]=e,!(t.then(function(){})instanceof e)}),ji=Be||!ji(function(e){Xi.all(e).catch(function(){})}),fs=function(e){var t;return!(!Di(e)||"function"!=typeof(t=e.then))&&t},ps=function(f,p,g){var m;p.notified||(p.notified=!0,m=p.reactions,Bi(function(){for(var r,i,e=p.value,t=p.state==ls,n=0;m.length>n;){var s,o,a,c=m[n++],l=t?c.ok:c.fail,u=c.resolve,h=c.reject,d=c.domain;try{l?(t||(p.rejection===ds&&function(e,t){qi.call(Pi,function(){if(ss)ts.emit("rejectionHandled",e);else gs(cs,e,t.value)})}(f,p),p.rejection=hs),!0===l?s=e:(d&&d.enter(),s=l(e),d&&(d.exit(),a=!0)),s===c.promise?h(Zi("Promise-chain cycle")):(o=fs(s))?o.call(s,u,h):u(s)):h(e)}catch(e){d&&!a&&d.exit(),h(e)}}p.reactions=[],p.notified=!1,g&&!p.rejection&&(r=f,i=p,qi.call(Pi,function(){var e,t=i.value,n=ms(i);if(n&&(e=Wi(function(){ss?ts.emit("unhandledRejection",t,r):gs(as,r,t)}),i.rejection=ss||ms(i)?ds:hs,e.error))throw e.value}))}))},gs=function(e,t,n){var r,i;os?((r=es.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Pi.dispatchEvent(r)):r={promise:t,reason:n},(i=Pi["on"+e])?i(r):e===as&&Ki("Unhandled promise rejection",n)},ms=function(e){return e.rejection!==hs&&!e.parent},vs=function(t,n,r,i){return function(e){t(n,r,e,i)}},ys=function(e,t,n,r){t.done||(t.done=!0,(t=r?r:t).value=n,t.state=us,ps(e,t,!0))},_s=function(n,r,e,t){if(!r.done){r.done=!0,t&&(r=t);try{if(n===e)throw Zi("Promise can't be resolved itself");var i=fs(e);i?Bi(function(){var t={done:!1};try{i.call(e,vs(_s,n,t,r),vs(ys,n,t,r))}catch(e){ys(n,t,e,r)}}):(r.value=e,r.state=ls,ps(n,r,!1))}catch(e){ys(n,{done:!1},e,r)}}};Be&&(Xi=function(e){Mi(this,Xi,Gi),Oi(e),Ai.call(this);var t=Qi(this);try{e(vs(_s,this,t),vs(ys,this,t))}catch(e){ys(this,t,e)}},(Ai=function(e){Yi(this,{type:Gi,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=or(Xi.prototype,{then:function(e,t){var n=Ji(this),r=rs(Vi(this,Xi));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=ss?ts.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ps(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Ni=function(){var e=new Ai,t=Qi(e);this.promise=e,this.resolve=vs(_s,e,t),this.reject=vs(ys,e,t)},ue.f=rs=function(e){return e===Xi||e===Ri?new Ni:is(e)},"function"==typeof A&&(xi=A.prototype.then,x(A.prototype,"then",function(e,t){var n=this;return new Xi(function(e,t){xi.call(n,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof ns&&wi({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return $i(Xi,ns.apply(Pi,arguments))}}))),wi({global:!0,wrap:!0,forced:Be},{Promise:Xi}),yi(Xi,Gi,!1),zr(Gi),Ri=d(Gi),wi({target:Gi,stat:!0,forced:Be},{reject:function(e){var t=rs(this);return t.reject.call(void 0,e),t.promise}}),wi({target:Gi,stat:!0,forced:Be},{resolve:function(e){return $i(this,e)}}),wi({target:Gi,stat:!0,forced:ji},{all:function(e){var a=this,t=rs(a),c=t.resolve,l=t.reject,n=Wi(function(){var r=Oi(a.resolve),i=[],s=0,o=1;Ui(e,function(e){var t=s++,n=!1;i.push(void 0),o++,r.call(a,e).then(function(e){n||(n=!0,i[t]=e,--o||c(i))},l)}),--o||c(i)});return n.error&&l(n.value),t.promise},race:function(e){var n=this,r=rs(n),i=r.reject,t=Wi(function(){var t=Oi(n.resolve);Ui(e,function(e){t.call(n,e).then(r.resolve,i)})});return t.error&&i(t.value),r.promise}});var d=z,ws=n,bs=de,Is=B,Ts=l.exports;d({target:"Promise",stat:!0},{allSettled:function(e){var a=this,t=bs.f(a),c=t.resolve,n=t.reject,r=Is(function(){var r=ws(a.resolve),i=[],s=0,o=1;Ts(e,function(e){var t=s++,n=!1;i.push(void 0),o++,r.call(a,e).then(function(e){n||(n=!0,i[t]={status:"fulfilled",value:e},--o||c(i))},function(e){n||(n=!0,i[t]={status:"rejected",reason:e},--o||c(i))})}),--o||c(i)});return r.error&&n(r.value),t.promise}});var Be=z,Es=fe,wi=e,Ss=vt,ks=R,Cs=Ze,ji=Z.exports;Be({target:"Promise",proto:!0,real:!0,forced:!!Es&&wi(function(){Es.prototype.finally.call({then:function(){}},function(){})})},{finally:function(t){var n=ks(this,Ss("Promise")),e="function"==typeof t;return this.then(e?function(e){return Cs(n,t()).then(function(){return e})}:t,e?function(e){return Cs(n,t()).then(function(){throw e})}:t)}}),"function"!=typeof Es||Es.prototype.finally||ji(Es.prototype,"finally",Ss("Promise").prototype.finally),yt.Promise;function As(e,t){var n=this;if(!(n instanceof As))return new As(e,t);xs&&(n=xs(new Error(t),Rs(n)));var r=[];return Ps(e,r.push,r),Ns?Os(n,{errors:r,type:"AggregateError"}):n.errors=r,void 0!==t&&Ds(n,"message",String(t)),n}var d=z,Ns=o,Rs=ee,xs=rt,fe=Qe,Ze=a,Be=I,Ps=l.exports,Ds=S,wi=Se,Os=wi.set,Ms=wi.getterFor("AggregateError");As.prototype=fe(Error.prototype,{constructor:Be(5,As),message:Be(5,""),name:Be(5,"AggregateError")}),Ns&&Ze.f(As.prototype,"errors",{get:function(){return Ms(this).errors},configurable:!0}),d({global:!0},{AggregateError:As});var Ls=de,Fs=B;z({target:"Promise",stat:!0},{try:function(e){var t=Ls.f(this),n=Fs(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var ji=z,Us=n,js=vt,Vs=de,qs=B,Bs=l.exports,$s="No one promise resolved";ji({target:"Promise",stat:!0},{any:function(e){var c=this,t=Vs.f(c),l=t.resolve,u=t.reject,n=qs(function(){var r=Us(c.resolve),i=[],s=0,o=1,a=!1;Bs(e,function(e){var t=s++,n=!1;i.push(void 0),o++,r.call(c,e).then(function(e){n||a||(a=!0,l(e))},function(e){n||a||(n=!0,i[t]=e,--o||u(new(js("AggregateError"))(i,$s)))})}),--o||u(new(js("AggregateError"))(i,$s))});return n.error&&u(n.value),t.promise}});function Ks(e){throw e}var Ws=Me,wi=Array.isArray||function(e){return"Array"==Ws(e)},zs=c,Hs=wi,Gs=Y("species"),fe=function(e,t){var n;return new(void 0===(n=Hs(e)&&("function"==typeof(n=e.constructor)&&(n===Array||Hs(n.prototype))||zs(n)&&null===(n=n[Gs]))?void 0:n)?Array:n)(0===t?0:t)},Qs=Te,Ys=ot,Js=K,Xs=Et,Zs=fe,eo=[].push,Be=function(f){var p=1==f,g=2==f,m=3==f,v=4==f,y=6==f,_=5==f||y;return function(e,t,n,r){for(var i,s,o=Js(e),a=Ys(o),c=Qs(t,n,3),l=Xs(a.length),u=0,h=r||Zs,d=p?h(e,l):g?h(e,0):void 0;u<l;u++)if((_||u in a)&&(s=c(i=a[u],u,o),f))if(p)d[u]=s;else if(s)switch(f){case 3:return!0;case 5:return i;case 6:return u;case 2:eo.call(d,i)}else if(v)return!1;return y?-1:m||v?v:d}},Ze={forEach:Be(0),map:Be(1),filter:Be(2),some:Be(3),every:Be(4),find:Be(5),findIndex:Be(6)},to=o,no=e,ro=D,io=Object.defineProperty,so={},d=function(e,t){if(ro(so,e))return so[e];var n=[][e],r=!!ro(t=t||{},"ACCESSORS")&&t.ACCESSORS,i=ro(t,0)?t[0]:Ks,s=ro(t,1)?t[1]:void 0;return so[e]=!!n&&!no(function(){if(r&&!to)return!0;var e={length:-1};r?io(e,1,{enumerable:!0,get:Ks}):e[1]=1,n.call(e,i,s)})},de=z,oo=Ze.find,B=J,ji="find",ao=!0,Be=d(ji);ji in[]&&Array(1)[ji](function(){ao=!1}),de({target:"Array",proto:!0,forced:ao||!Be},{find:function(e){return oo(this,e,1<arguments.length?arguments[1]:void 0)}}),B(ji);var co=i,lo=Te,uo=Function.call,de=function(e,t,n){return lo(uo,co[e].prototype[t],n)};de("Array","find");var Be=z,ho=Ze.findIndex,B=J,ji="findIndex",fo=!0,J=d(ji);ji in[]&&Array(1)[ji](function(){fo=!1}),Be({target:"Array",proto:!0,forced:fo||!J},{findIndex:function(e){return ho(this,e,1<arguments.length?arguments[1]:void 0)}}),B(ji),de("Array","findIndex");var po=v,go=a,mo=I,J=function(e,t,n){var r=po(t);r in e?go.f(e,r,mo(0,n)):e[r]=n},vo=Te,yo=K,_o=Ye,wo=X,bo=Et,Io=J,To=p,B=function(e){var t,n,r,i,s,o,a=yo(e),c="function"==typeof this?this:Array,l=arguments.length,u=1<l?arguments[1]:void 0,h=void 0!==u,d=To(a),f=0;if(h&&(u=vo(u,2<l?arguments[2]:void 0,2)),null==d||c==Array&&wo(d))for(n=new c(t=bo(a.length));f<t;f++)o=h?u(a[f],f):a[f],Io(n,f,o);else for(s=(i=d.call(a)).next,n=new c;!(r=s.call(i)).done;f++)o=h?_o(i,u,[r.value,f],!0):r.value,Io(n,f,o);return n.length=f,n};z({target:"Array",stat:!0,forced:!r(function(e){Array.from(e)})},{from:B}),yt.Array.from;var Eo=e,ji=z,So=Ze.some,Ye=d,X=function(e,t){var n=[][e];return!!n&&Eo(function(){n.call(null,t||function(){throw 1},1)})}("some"),B=Ye("some");ji({target:"Array",proto:!0,forced:!X||!B},{some:function(e){return So(this,e,1<arguments.length?arguments[1]:void 0)}}),de("Array","some");function ko(e){return Ro(e)&&xo($o,Po(e))}var Co,d="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ao=o,No=i,Ro=c,xo=D,Po=Ve,Do=S,Oo=Z.exports,Ye=a.f,ji=ee,Mo=rt,X=Y,B=O,Lo=No.Int8Array,Fo=Lo&&Lo.prototype,Ve=No.Uint8ClampedArray,ee=Ve&&Ve.prototype,Uo=Lo&&ji(Lo),jo=Fo&&ji(Fo),Ve=Object.prototype,Vo=Ve.isPrototypeOf,X=X("toStringTag"),qo=B("TYPED_ARRAY_TAG"),Bo=d&&!!Mo&&"Opera"!==Po(No.opera),d=!1,$o={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(Co in $o)No[Co]||(Bo=!1);if((!Bo||"function"!=typeof Uo||Uo===Function.prototype)&&(Uo=function(){throw TypeError("Incorrect invocation")},Bo))for(Co in $o)No[Co]&&Mo(No[Co],Uo);if((!Bo||!jo||jo===Ve)&&(jo=Uo.prototype,Bo))for(Co in $o)No[Co]&&Mo(No[Co].prototype,jo);if(Bo&&ji(ee)!==jo&&Mo(ee,jo),Ao&&!xo(jo,X))for(Co in d=!0,Ye(jo,X,{get:function(){return Ro(this)?this[qo]:void 0}}),$o)No[Co]&&Do(No[Co],qo,Co);var Ye=i,X={NATIVE_ARRAY_BUFFER_VIEWS:Bo,TYPED_ARRAY_TAG:d&&qo,aTypedArray:function(e){if(ko(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(Mo){if(Vo.call(Uo,e))return e}else for(var t in $o)if(xo($o,Co)){t=No[t];if(t&&(e===t||Vo.call(t,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(Ao){if(n)for(var r in $o){r=No[r];r&&xo(r.prototype,e)&&delete r.prototype[e]}jo[e]&&!n||Oo(jo,e,!n&&Bo&&Fo[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(Ao){if(Mo){if(n)for(r in $o)(i=No[r])&&xo(i,e)&&delete i[e];if(Uo[e]&&!n)return;try{return Oo(Uo,e,!n&&Bo&&Lo[e]||t)}catch(e){}}for(r in $o)!(i=No[r])||i[e]&&!n||Oo(i,e,t)}},isView:function(e){var t=Po(e);return"DataView"===t||xo($o,t)},isTypedArray:ko,TypedArray:Uo,TypedArrayPrototype:jo},d=pe,pe=Y("iterator"),Ye=Ye.Uint8Array,Ko=d.values,Wo=d.keys,zo=d.entries,Ho=X.aTypedArray,d=X.exportTypedArrayMethod,X=Ye&&Ye.prototype[pe],Ye=!!X&&("values"==X.name||null==X.name),X=function(){return Ko.call(Ho(this))};d("entries",function(){return zo.call(Ho(this))}),d("keys",function(){return Wo.call(Ho(this))}),d("values",X,!Ye),d(pe,X,!Ye);var Go=o,X=e,Qo=Ie,Yo=N,Jo=Xe,Xo=K,Zo=ot,ea=Object.assign,ta=Object.defineProperty,Ye=!ea||X(function(){if(Go&&1!==ea({b:1},ea(ta({},"a",{enumerable:!0,get:function(){ta(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=ea({},e)[n]||Qo(ea({},t)).join("")!=r})?function(e,t){for(var n=Xo(e),r=arguments.length,i=1,s=Yo.f,o=Jo.f;i<r;)for(var a,c=Zo(arguments[i++]),l=s?Qo(c).concat(s(c)):Qo(c),u=l.length,h=0;h<u;)a=l[h++],Go&&!o.call(c,a)||(n[a]=c[a]);return n}:ea;z({target:"Object",stat:!0,forced:Object.assign!==Ye},{assign:Ye}),yt.Object.assign;var na=o,ra=Ie,ia=nt,sa=Xe.f,ot=function(a){return function(e){for(var t,n=ia(e),r=ra(n),i=r.length,s=0,o=[];s<i;)t=r[s++],na&&!sa.call(n,t)||o.push(a?[t,n[t]]:n[t]);return o}},X={entries:ot(!0),values:ot(!1)},Ye=z,oa=X.entries;Ye({target:"Object",stat:!0},{entries:function(e){return oa(e)}}),yt.Object.entries;var ot=z,aa=X.values;ot({target:"Object",stat:!0},{values:function(e){return aa(e)}}),yt.Object.values;var ca=c,la=Me,ua=Y("match"),ha=function(e){var t;return ca(e)&&(void 0!==(t=e[ua])?!!t:"RegExp"==la(e))},Ye=function(e){if(ha(e))throw TypeError("The method doesn't accept regular expressions");return e},da=Y("match"),X=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[da]=!1,"/./"[t](n)}catch(e){}}return!1},fa=Ye,pa=ze;z({target:"String",proto:!0,forced:!X("includes")},{includes:function(e){return!!~String(pa(this)).indexOf(fa(e),1<arguments.length?arguments[1]:void 0)}}),de("String","includes");var ot=z,Me=Je.f,ga=Et,ma=Ye,va=ze,X=X,ya="".startsWith,_a=Math.min,X=X("startsWith");ot({target:"String",proto:!0,forced:!!(X||(!(Me=Me(String.prototype,"startsWith"))||Me.writable))&&!X},{startsWith:function(e){var t=String(va(this));ma(e);var n=ga(_a(1<arguments.length?arguments[1]:void 0,t.length)),r=String(e);return ya?ya.call(t,r,n):t.slice(n,n+r.length)===r}}),de("String","startsWith");var wa=We,ba=ze;z({target:"String",proto:!0},{repeat:"".repeat||function(e){var t=String(ba(this)),n="",r=wa(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}}),de("String","repeat");var Ia=e,Ta=he,Ea=Y("species"),We=z,ze=e,Sa=wi,ka=c,Ca=K,Aa=Et,Na=J,Ra=fe,de=function(t){return 51<=Ta||!Ia(function(){var e=[];return(e.constructor={})[Ea]=function(){return{foo:1}},1!==e[t](Boolean).foo})},Et=he,xa=Y("isConcatSpreadable"),Pa=9007199254740991,Da="Maximum allowed index exceeded",J=51<=Et||!ze(function(){var e=[];return e[xa]=!1,e.concat()[0]!==e}),fe=de("concat");We({target:"Array",proto:!0,forced:!J||!fe},{concat:function(e){for(var t,n,r,i=Ca(this),s=Ra(i,0),o=0,a=-1,c=arguments.length;a<c;a++)if(function(e){if(!ka(e))return!1;var t=e[xa];return void 0!==t?!!t:Sa(e)}(r=-1===a?i:arguments[a])){if(n=Aa(r.length),Pa<o+n)throw TypeError(Da);for(t=0;t<n;t++,o++)t in r&&Na(s,o,r[t])}else{if(Pa<=o)throw TypeError(Da);Na(s,o++,r)}return s.length=o,s}});var he={},Oa=nt,Ma=bt.f,La={}.toString,Fa="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];he.f=function(e){return Fa&&"[object Window]"==La.call(e)?function(e){try{return Ma(e)}catch(e){return Fa.slice()}}(e):Ma(Oa(e))};Et={};Et.f=Y;function Ua(e,t){var n=_c[e]=Za(fc[lc]);return uc(n,{type:cc,tag:e,description:t}),Ka||(n.description=t),n}function ja(t,e){Ga(t);var n=Ya(e),r=ec(n).concat(Ac(n));return oc(r,function(e){Ka&&!Cc.call(n,e)||kc(t,e,n[e])}),t}var Va=yt,qa=D,Ba=Et,$a=a.f,ze=function(e){var t=Va.Symbol||(Va.Symbol={});qa(t,e)||$a(t,e,{value:Ba.f(e)})},de=z,We=i,J=vt,Ka=o,fe=j,j=V,V=e,Wa=D,za=wi,Ha=c,Ga=t,Qa=K,Ya=nt,Ja=v,Xa=I,Za=Qe,ec=Ie,v=bt,I=he,tc=N,Ie=Je,bt=a,he=Xe,N=S,Je=Z.exports,Xe=s.exports,S=ve,nc=ye,rc=O,ic=Y,s=Et,sc=ze,ve=tt,Y=Se,oc=Ze.forEach,ac=S("hidden"),cc="Symbol",lc="prototype",S=ic("toPrimitive"),uc=Y.set,hc=Y.getterFor(cc),dc=Object[lc],fc=We.Symbol,pc=J("JSON","stringify"),gc=Ie.f,mc=bt.f,vc=I.f,yc=he.f,_c=Xe("symbols"),wc=Xe("op-symbols"),bc=Xe("string-to-symbol-registry"),Ic=Xe("symbol-to-string-registry"),Xe=Xe("wks"),We=We.QObject,Tc=!We||!We[lc]||!We[lc].findChild,Ec=Ka&&V(function(){return 7!=Za(mc({},"a",{get:function(){return mc(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=gc(dc,t);r&&delete dc[t],mc(e,t,n),r&&e!==dc&&mc(dc,t,r)}:mc,Sc=j?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof fc},kc=function(e,t,n){e===dc&&kc(wc,t,n),Ga(e);var r=Ja(t,!0);return Ga(n),Wa(_c,r)?(n.enumerable?(Wa(e,ac)&&e[ac][r]&&(e[ac][r]=!1),n=Za(n,{enumerable:Xa(0,!1)})):(Wa(e,ac)||mc(e,ac,Xa(1,{})),e[ac][r]=!0),Ec(e,r,n)):mc(e,r,n)},Cc=function(e){var t=Ja(e,!0),n=yc.call(this,t);return!(this===dc&&Wa(_c,t)&&!Wa(wc,t))&&(!(n||!Wa(this,t)||!Wa(_c,t)||Wa(this,ac)&&this[ac][t])||n)},We=function(e,t){var n=Ya(e),r=Ja(t,!0);if(n!==dc||!Wa(_c,r)||Wa(wc,r)){var i=gc(n,r);return!i||!Wa(_c,r)||Wa(n,ac)&&n[ac][r]||(i.enumerable=!0),i}},j=function(e){var t=vc(Ya(e)),n=[];return oc(t,function(e){Wa(_c,e)||Wa(nc,e)||n.push(e)}),n},Ac=function(e){var t=e===dc,n=vc(t?wc:Ya(e)),r=[];return oc(n,function(e){!Wa(_c,e)||t&&!Wa(dc,e)||r.push(_c[e])}),r};fe||(Je((fc=function(){if(this instanceof fc)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=rc(e),n=function(e){this===dc&&n.call(wc,e),Wa(this,ac)&&Wa(this[ac],t)&&(this[ac][t]=!1),Ec(this,t,Xa(1,e))};return Ka&&Tc&&Ec(dc,t,{configurable:!0,set:n}),Ua(t,e)})[lc],"toString",function(){return hc(this).tag}),Je(fc,"withoutSetter",function(e){return Ua(rc(e),e)}),he.f=Cc,bt.f=kc,Ie.f=We,v.f=I.f=j,tc.f=Ac,s.f=function(e){return Ua(ic(e),e)},Ka&&(mc(fc[lc],"description",{configurable:!0,get:function(){return hc(this).description}}),Je(dc,"propertyIsEnumerable",Cc,{unsafe:!0}))),de({global:!0,wrap:!0,forced:!fe,sham:!fe},{Symbol:fc}),oc(ec(Xe),function(e){sc(e)}),de({target:cc,stat:!0,forced:!fe},{for:function(e){var t=String(e);if(Wa(bc,t))return bc[t];var n=fc(t);return bc[t]=n,Ic[n]=t,n},keyFor:function(e){if(!Sc(e))throw TypeError(e+" is not a symbol");if(Wa(Ic,e))return Ic[e]},useSetter:function(){Tc=!0},useSimple:function(){Tc=!1}}),de({target:"Object",stat:!0,forced:!fe,sham:!Ka},{create:function(e,t){return void 0===t?Za(e):ja(Za(e),t)},defineProperty:kc,defineProperties:ja,getOwnPropertyDescriptor:We}),de({target:"Object",stat:!0,forced:!fe},{getOwnPropertyNames:j,getOwnPropertySymbols:Ac}),de({target:"Object",stat:!0,forced:V(function(){tc.f(1)})},{getOwnPropertySymbols:function(e){return tc.f(Qa(e))}}),pc&&de({target:"JSON",stat:!0,forced:!fe||V(function(){var e=fc();return"[null]"!=pc([e])||"{}"!=pc({a:e})||"{}"!=pc(Object(e))})},{stringify:function(e,t,n){for(var r,i=[e],s=1;s<arguments.length;)i.push(arguments[s++]);if((Ha(r=t)||void 0!==e)&&!Sc(e))return za(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Sc(t))return t}),i[1]=t,pc.apply(null,i)}}),fc[lc][S]||N(fc[lc],S,fc[lc].valueOf),ve(fc,cc),nc[ac]=!0,ze("asyncIterator");var Nc,Rc,xc,Pc,Dc,S=z,Oc=D,Mc=c,ve=a.f,U=U,Lc=i.Symbol;!o||"function"!=typeof Lc||"description"in Lc.prototype&&void 0===Lc().description||(Nc={},U(Rc=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Rc?new Lc(e):void 0===e?Lc():Lc(e);return""===e&&(Nc[t]=!0),t},Lc),(U=Rc.prototype=Lc.prototype).constructor=Rc,xc=U.toString,Pc="Symbol(test)"==String(Lc("test")),Dc=/^Symbol\((.*)\)[^)]+$/,ve(U,"description",{configurable:!0,get:function(){var e=Mc(this)?this.valueOf():this,t=xc.call(e);if(Oc(Nc,e))return"";t=Pc?t.slice(7,-1):t.replace(Dc,"$1");return""===t?void 0:t}}),S({global:!0,forced:!0},{Symbol:Rc})),ze("hasInstance"),ze("isConcatSpreadable"),ze("iterator"),ze("match"),ze("matchAll"),ze("replace"),ze("search"),ze("species"),ze("split"),ze("toPrimitive"),ze("toStringTag"),ze("unscopables"),tt(Math,"Math",!0),tt(i.JSON,"JSON",!0),yt.Symbol,ze("asyncDispose"),ze("dispose"),ze("observable"),ze("patternMatch"),ze("replaceAll"),Et.f("iterator");function Fc(e){Vc(e,Bc,{value:{objectID:"O"+ ++$c,weakData:{}}})}var ze={exports:{}},Et=!e(function(){return Object.isExtensible(Object.preventExtensions({}))}),ye=ye,Uc=c,jc=D,Vc=a.f,qc=Et,Bc=O("meta"),$c=0,Kc=Object.isExtensible||function(){return!0},Wc=ze.exports={REQUIRED:!1,fastKey:function(e,t){if(!Uc(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!jc(e,Bc)){if(!Kc(e))return"F";if(!t)return"E";Fc(e)}return e[Bc].objectID},getWeakData:function(e,t){if(!jc(e,Bc)){if(!Kc(e))return!0;if(!t)return!1;Fc(e)}return e[Bc].weakData},onFreeze:function(e){return qc&&Wc.REQUIRED&&Kc(e)&&!jc(e,Bc)&&Fc(e),e}};ye[Bc]=!0;var zc=c,Hc=rt,Gc=z,Qc=i,Yc=q,Jc=Z.exports,Xc=ze.exports,Zc=l.exports,el=Le,tl=c,nl=e,rl=r,il=tt,sl=function(e,t,n){var r,i;return Hc&&"function"==typeof(r=t.constructor)&&r!==n&&zc(i=r.prototype)&&i!==n.prototype&&Hc(e,i),e},tt=function(r,e,t){function n(e){var n=f[e];Jc(f,e,"add"==e?function(e){return n.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(u&&!tl(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return u&&!tl(e)?void 0:n.call(this,0===e?0:e)}:"has"==e?function(e){return!(u&&!tl(e))&&n.call(this,0===e?0:e)}:function(e,t){return n.call(this,0===e?0:e,t),this})}var i,s,o,a,c,l=-1!==r.indexOf("Map"),u=-1!==r.indexOf("Weak"),h=l?"set":"add",d=Qc[r],f=d&&d.prototype,p=d,g={};return Yc(r,"function"!=typeof d||!(u||f.forEach&&!nl(function(){(new d).entries().next()})))?(p=t.getConstructor(e,r,l,h),Xc.REQUIRED=!0):Yc(r,!0)&&(s=(i=new p)[h](u?{}:-0,1)!=i,o=nl(function(){i.has(1)}),a=rl(function(e){new d(e)}),c=!u&&nl(function(){for(var e=new d,t=5;t--;)e[h](t,t);return!e.has(-0)}),a||(((p=e(function(e,t){el(e,p,r);var n=sl(new d,e,p);return null!=t&&Zc(t,n[h],n,l),n})).prototype=f).constructor=p),(o||c)&&(n("delete"),n("has"),l&&n("get")),(c||s)&&n(h),u&&f.clear&&delete f.clear),g[r]=p,Gc({global:!0,forced:p!=d},g),il(p,r),u||t.setStrong(p,r,l),p},ol=a.f,al=Qe,cl=Er,ll=Te,ul=Le,hl=l.exports,dl=xt,fl=Ee,pl=o,gl=ze.exports.fastKey,ml=Se.set,vl=Se.getterFor,xt={getConstructor:function(e,n,r,i){function s(e,t,n){var r,i,s=c(e),o=a(e,t);return o?o.value=n:(s.last=o={index:i=gl(t,!0),key:t,value:n,previous:r=s.last,next:void 0,removed:!1},s.first||(s.first=o),r&&(r.next=o),pl?s.size++:e.size++,"F"!==i&&(s.index[i]=o)),e}function a(e,t){var n,r=c(e),i=gl(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n}var o=e(function(e,t){ul(e,o,n),ml(e,{type:n,index:al(null),first:void 0,last:void 0,size:0}),pl||(e.size=0),null!=t&&hl(t,e[i],e,r)}),c=vl(n);return cl(o.prototype,{clear:function(){for(var e=c(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,pl?e.size=0:this.size=0},delete:function(e){var t,n,r=c(this),i=a(this,e);return i&&(t=i.next,n=i.previous,delete r.index[i.index],i.removed=!0,n&&(n.next=t),t&&(t.previous=n),r.first==i&&(r.first=t),r.last==i&&(r.last=n),pl?r.size--:this.size--),!!i},forEach:function(e){for(var t,n=c(this),r=ll(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!a(this,e)}}),cl(o.prototype,r?{get:function(e){var t=a(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),pl&&ol(o.prototype,"size",{get:function(){return c(this).size}}),o},setStrong:function(e,t,n){var r=t+" Iterator",i=vl(t),s=vl(r);dl(e,t,function(e,t){ml(this,{type:r,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=s(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),fl(t)}};tt("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},xt),yt.Map;var yl=n,_l=Te,wl=l.exports,Ee=function(e){var t,n,r,i,s=arguments.length,o=1<s?arguments[1]:void 0;return yl(this),(t=void 0!==o)&&yl(o),null==e?new this:(n=[],t?(r=0,i=_l(o,2<s?arguments[2]:void 0,2),wl(e,function(e){n.push(i(e,r++))})):wl(e,n.push,n),new this(n))};z({target:"Map",stat:!0},{from:Ee});o=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)};z({target:"Map",stat:!0},{of:o});var bl=t,Il=n,ze=function(){for(var e,t=bl(this),n=Il(t.delete),r=!0,i=0,s=arguments.length;i<s;i++)e=n.call(t,arguments[i]),r=r&&e;return!!r},Tl=ze;z({target:"Map",proto:!0,real:!0,forced:!1},{deleteAll:function(){return Tl.apply(this,arguments)}});var El=t,Sl=p,Se=function(e){return Map.prototype.entries.call(e)},p=z,kl=t,Cl=Te,Al=Se,Nl=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{every:function(e){var n=kl(this),t=Al(n),r=Cl(e,1<arguments.length?arguments[1]:void 0,3);return!Nl(t,function(e,t){if(!r(t,e,n))return Nl.stop()},void 0,!0,!0).stopped}});var p=z,Rl=vt,xl=t,Pl=n,Dl=Te,Ol=R,Ml=Se,Ll=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{filter:function(e){var n=xl(this),t=Ml(n),r=Dl(e,1<arguments.length?arguments[1]:void 0,3),i=new(Ol(n,Rl("Map"))),s=Pl(i.set);return Ll(t,function(e,t){r(t,e,n)&&s.call(i,e,t)},void 0,!0,!0),i}});var p=z,Fl=t,Ul=Te,jl=Se,Vl=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{find:function(e){var n=Fl(this),t=jl(n),r=Ul(e,1<arguments.length?arguments[1]:void 0,3);return Vl(t,function(e,t){if(r(t,e,n))return Vl.stop(t)},void 0,!0,!0).result}});var p=z,ql=t,Bl=Te,$l=Se,Kl=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{findKey:function(e){var n=ql(this),t=$l(n),r=Bl(e,1<arguments.length?arguments[1]:void 0,3);return Kl(t,function(e,t){if(r(t,e,n))return Kl.stop(e)},void 0,!0,!0).result}});var p=z,Wl=l.exports,zl=n;p({target:"Map",stat:!0},{groupBy:function(e,n){var r=new this;zl(n);var i=zl(r.has),s=zl(r.get),o=zl(r.set);return Wl(e,function(e){var t=n(e);i.call(r,t)?s.call(r,t).push(e):o.call(r,t,[e])}),r}});var p=z,Hl=t,Gl=Se,Ql=function(e,t){return e===t||e!=e&&t!=t},Yl=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{includes:function(n){return Yl(Gl(Hl(this)),function(e,t){if(Ql(t,n))return Yl.stop()},void 0,!0,!0).stopped}});var p=z,Jl=l.exports,Xl=n;p({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;Xl(t);var r=Xl(n.set);return Jl(e,function(e){r.call(n,t(e),e)}),n}});var p=z,Zl=t,eu=Se,tu=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{keyOf:function(n){return tu(eu(Zl(this)),function(e,t){if(t===n)return tu.stop(e)},void 0,!0,!0).result}});var p=z,nu=vt,ru=t,iu=n,su=Te,ou=R,au=Se,cu=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{mapKeys:function(e){var n=ru(this),t=au(n),r=su(e,1<arguments.length?arguments[1]:void 0,3),i=new(ou(n,nu("Map"))),s=iu(i.set);return cu(t,function(e,t){s.call(i,r(t,e,n),t)},void 0,!0,!0),i}});var p=z,lu=vt,uu=t,hu=n,du=Te,fu=R,pu=Se,gu=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{mapValues:function(e){var n=uu(this),t=pu(n),r=du(e,1<arguments.length?arguments[1]:void 0,3),i=new(fu(n,lu("Map"))),s=hu(i.set);return gu(t,function(e,t){s.call(i,e,r(t,e,n))},void 0,!0,!0),i}});var p=z,mu=t,vu=n,yu=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{merge:function(e){for(var t=mu(this),n=vu(t.set),r=0;r<arguments.length;)yu(arguments[r++],n,t,!0);return t}});var p=z,_u=t,wu=n,bu=Se,Iu=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{reduce:function(n){var r=_u(this),e=bu(r),i=arguments.length<2,s=i?void 0:arguments[1];if(wu(n),Iu(e,function(e,t){s=i?(i=!1,t):n(s,t,e,r)},void 0,!0,!0),i)throw TypeError("Reduce of empty map with no initial value");return s}});var p=z,Tu=t,Eu=Te,Su=Se,ku=l.exports;p({target:"Map",proto:!0,real:!0,forced:!1},{some:function(e){var n=Tu(this),t=Su(n),r=Eu(e,1<arguments.length?arguments[1]:void 0,3);return ku(t,function(e,t){if(r(t,e,n))return ku.stop()},void 0,!0,!0).stopped}});var Cu=t,Au=n;z({target:"Map",proto:!0,real:!0,forced:!1},{update:function(e,t){var n=Cu(this),r=arguments.length;Au(t);var i=n.has(e);if(!i&&r<3)throw TypeError("Updating absent value");r=i?n.get(e):Au(2<r?arguments[2]:void 0)(e,n);return n.set(e,t(r,e,n)),n}});var Nu=t,p=function(e,t){var n,r=Nu(this),i=2<arguments.length?arguments[2]:void 0;if("function"!=typeof t&&"function"!=typeof i)throw TypeError("At least one callback required");return r.has(e)?(n=r.get(e),"function"==typeof t&&(n=t(n),r.set(e,n))):"function"==typeof i&&(n=i(),r.set(e,n)),n};z({target:"Map",proto:!0,real:!0,forced:!1},{upsert:p});z({target:"Map",proto:!0,real:!0,forced:!1},{updateOrInsert:p}),tt("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},xt),yt.Set,z({target:"Set",stat:!0},{from:Ee}),z({target:"Set",stat:!0},{of:o});var Ru=t,xu=n,Pu=function(){for(var e=Ru(this),t=xu(e.add),n=0,r=arguments.length;n<r;n++)t.call(e,arguments[n]);return e};z({target:"Set",proto:!0,real:!0,forced:!1},{addAll:function(){return Pu.apply(this,arguments)}});var Du=ze;z({target:"Set",proto:!0,real:!0,forced:!1},{deleteAll:function(){return Du.apply(this,arguments)}});var o=function(e){return Set.prototype.values.call(e)},ze=z,Ou=t,Mu=Te,Lu=o,Fu=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{every:function(e){var t=Ou(this),n=Lu(t),r=Mu(e,1<arguments.length?arguments[1]:void 0,3);return!Fu(n,function(e){if(!r(e,e,t))return Fu.stop()},void 0,!1,!0).stopped}});var ze=z,Uu=vt,ju=t,Vu=n,qu=R,Bu=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{difference:function(e){var t=ju(this),n=new(qu(t,Uu("Set")))(t),r=Vu(n.delete);return Bu(e,function(e){r.call(n,e)}),n}});var ze=z,$u=vt,Ku=t,Wu=n,zu=Te,Hu=R,Gu=o,Qu=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{filter:function(e){var t=Ku(this),n=Gu(t),r=zu(e,1<arguments.length?arguments[1]:void 0,3),i=new(Hu(t,$u("Set"))),s=Wu(i.add);return Qu(n,function(e){r(e,e,t)&&s.call(i,e)},void 0,!1,!0),i}});var ze=z,Yu=t,Ju=Te,Xu=o,Zu=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{find:function(e){var t=Yu(this),n=Xu(t),r=Ju(e,1<arguments.length?arguments[1]:void 0,3);return Zu(n,function(e){if(r(e,e,t))return Zu.stop(e)},void 0,!1,!0).result}});var ze=z,eh=vt,th=t,nh=n,rh=R,ih=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{intersection:function(e){var t=th(this),n=new(rh(t,eh("Set"))),r=nh(t.has),i=nh(n.add);return ih(e,function(e){r.call(t,e)&&i.call(n,e)}),n}});var ze=z,sh=t,oh=n,ah=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{isDisjointFrom:function(e){var t=sh(this),n=oh(t.has);return!ah(e,function(e){if(!0===n.call(t,e))return ah.stop()}).stopped}});var ze=z,ch=vt,lh=t,uh=n,hh=function(e){var t=Sl(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return El(t.call(e))},dh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{isSubsetOf:function(e){var t=hh(this),n=lh(e),r=n.has;return"function"!=typeof r&&(n=new(ch("Set"))(e),r=uh(n.has)),!dh(t,function(e){if(!1===r.call(n,e))return dh.stop()},void 0,!1,!0).stopped}});var ze=z,fh=t,ph=n,gh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{isSupersetOf:function(e){var t=fh(this),n=ph(t.has);return!gh(e,function(e){if(!1===n.call(t,e))return gh.stop()}).stopped}});var ze=z,mh=t,vh=o,yh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{join:function(e){var t=mh(this),n=vh(t),r=void 0===e?",":String(e),t=[];return yh(n,t.push,t,!1,!0),t.join(r)}});var ze=z,_h=vt,wh=t,bh=n,Ih=Te,Th=R,Eh=o,Sh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{map:function(e){var t=wh(this),n=Eh(t),r=Ih(e,1<arguments.length?arguments[1]:void 0,3),i=new(Th(t,_h("Set"))),s=bh(i.add);return Sh(n,function(e){s.call(i,r(e,e,t))},void 0,!1,!0),i}});var ze=z,kh=t,Ch=n,Ah=o,Nh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{reduce:function(t){var n=kh(this),e=Ah(n),r=arguments.length<2,i=r?void 0:arguments[1];if(Ch(t),Nh(e,function(e){i=r?(r=!1,e):t(i,e,e,n)},void 0,!1,!0),r)throw TypeError("Reduce of empty set with no initial value");return i}});var ze=z,Rh=t,xh=Te,Ph=o,Dh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{some:function(e){var t=Rh(this),n=Ph(t),r=xh(e,1<arguments.length?arguments[1]:void 0,3);return Dh(n,function(e){if(r(e,e,t))return Dh.stop()},void 0,!1,!0).stopped}});var ze=z,Oh=vt,Mh=t,Lh=n,Fh=R,Uh=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{symmetricDifference:function(e){var t=Mh(this),n=new(Fh(t,Oh("Set")))(t),r=Lh(n.delete),i=Lh(n.add);return Uh(e,function(e){r.call(n,e)||i.call(n,e)}),n}});var ze=z,jh=vt,Vh=t,qh=n,Bh=R,$h=l.exports;ze({target:"Set",proto:!0,real:!0,forced:!1},{union:function(e){var t=Vh(this),t=new(Bh(t,jh("Set")))(t);return $h(e,qh(t.add),t),t}});var Kh,Wh,zh=c,Hh=Math.floor;z({target:"Number",stat:!0},{isInteger:function(e){return!zh(e)&&isFinite(e)&&Hh(e)===e}}),yt.Number.isInteger;function Gh(t){const n=[];let r=0;for(let i=0;i<t.length;i++){let e=t.charCodeAt(i);e<128?n[r++]=e:(e<2048?n[r++]=e>>6|192:(55296==(64512&e)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(e=65536+((1023&e)<<10)+(1023&t.charCodeAt(++i)),n[r++]=e>>18|240,n[r++]=e>>12&63|128):n[r++]=e>>12|224,n[r++]=e>>6&63|128),n[r++]=63&e|128)}return n}const Qh={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Yh=function(e,t){if(!e)throw Jh(t)},Jh=function(e){return new Error("Firebase Database ("+Qh.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},Xh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();var r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_;const i=[];for(let u=0;u<n.length;u+=3){var s=n[u],o=u+1<n.length,a=o?n[u+1]:0,c=u+2<n.length,l=c?n[u+2]:0;let e=(15&a)<<2|l>>6,t=63&l;c||(t=64,o||(e=64)),i.push(r[s>>2],r[(3&s)<<4|a>>4],r[e],r[t])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Gh(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){var i,s,o=e[n++];o<128?t[r++]=String.fromCharCode(o):191<o&&o<224?(i=e[n++],t[r++]=String.fromCharCode((31&o)<<6|63&i)):239<o&&o<365?(s=((7&o)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))):(i=e[n++],s=e[n++],t[r++]=String.fromCharCode((15&o)<<12|(63&i)<<6|63&s))}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();var n=t?this.charToByteMapWebSafe_:this.charToByteMap_;const r=[];for(let c=0;c<e.length;){var i=n[e.charAt(c++)],s=c<e.length?n[e.charAt(c)]:0;++c;var o=c<e.length?n[e.charAt(c)]:64;++c;var a=c<e.length?n[e.charAt(c)]:64;if(++c,null==i||null==s||null==o||null==a)throw Error();r.push(i<<2|s>>4),64!==o&&(r.push(s<<4&240|o>>2),64!==a&&r.push(o<<6&192|a))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Zh=function(e){var t=Gh(e);return Xh.encodeByteArray(t,!0)},ed=function(e){return Zh(e).replace(/\./g,"")},td=function(e){try{return Xh.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function nd(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const r in t)t.hasOwnProperty(r)&&"__proto__"!==r&&(e[r]=nd(e[r],t[r]));return e}class rd{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(n){return(e,t)=>{e?this.reject(e):this.resolve(t),"function"==typeof n&&(this.promise.catch(()=>{}),1===n.length?n(e):n(e,t))}}}function id(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ed(JSON.stringify({alg:"none",type:"JWT"})),ed(JSON.stringify(i)),""].join(".")}function sd(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function od(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sd())}function ad(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function cd(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function ld(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ud(){const e=sd();return 0<=e.indexOf("MSIE ")||0<=e.indexOf("Trident/")}function hd(){return!0===Qh.NODE_ADMIN}function dd(){return"object"==typeof indexedDB}function fd(){return new Promise((t,n)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var e;n((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){n(e)}})}function pd(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class gd extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,gd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,md.prototype.create)}}class md{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){var r,n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],s=s?(r=n,s.replace(vd,(e,t)=>{var n=r[t];return null!=n?String(n):`<${t}?>`})):"Error",s=`${this.serviceName}: ${s} (${i}).`;return new gd(i,s,n)}}const vd=/\{\$([^}]+)}/g;function yd(e){return JSON.parse(e)}function _d(e){return JSON.stringify(e)}function wd(e){let t={},n={},r={},i="";try{var s=e.split(".");t=yd(td(s[0])||""),n=yd(td(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}}function bd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Id(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function Td(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Ed(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Sd(e,t){if(e===t)return 1;const n=Object.keys(e),r=Object.keys(t);for(const o of n){if(!r.includes(o))return;var i=e[o],s=t[o];if(kd(i)&&kd(s)){if(!Sd(i,s))return}else if(i!==s)return}for(const a of r)if(!n.includes(a))return;return 1}function kd(e){return null!==e&&"object"==typeof e}function Cd(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Ad(e){const r={},t=e.replace(/^\?/,"").split("&");return t.forEach(e=>{var t,n;e&&([t,n]=e.split("="),r[decodeURIComponent(t)]=decodeURIComponent(n))}),r}function Nd(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,0<n?n:void 0)}class Rd{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(n,r){r=r||0;const i=this.W_;if("string"==typeof n)for(let e=0;e<16;e++)i[e]=n.charCodeAt(r)<<24|n.charCodeAt(r+1)<<16|n.charCodeAt(r+2)<<8|n.charCodeAt(r+3),r+=4;else for(let t=0;t<16;t++)i[t]=n[r]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3],r+=4;for(let d=16;d<80;d++){var e=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=4294967295&(e<<1|e>>>31)}let t=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let f=0;f<80;f++){u=f<40?f<20?(l=a^s&(o^a),1518500249):(l=s^o^a,1859775393):f<60?(l=s&o|a&(s|o),2400959708):(l=s^o^a,3395469782);var h=(t<<5|t>>>27)+l+c+u+i[f]&4294967295;c=a,a=o,o=4294967295&(s<<30|s>>>2),s=t,t=h}this.chain_[0]=this.chain_[0]+t&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(n,r){if(null!=n){var i=(r=void 0===r?n.length:r)-this.blockSize;let e=0;const s=this.buf_;let t=this.inbuf_;for(;e<r;){if(0===t)for(;e<=i;)this.compress_(n,e),e+=this.blockSize;if("string"==typeof n){for(;e<r;)if(s[t]=n.charCodeAt(e),++t,++e,t===this.blockSize){this.compress_(s),t=0;break}}else for(;e<r;)if(s[t]=n[e],++t,++e,t===this.blockSize){this.compress_(s),t=0;break}}this.inbuf_=t,this.total_+=r}}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;56<=r;r--)this.buf_[r]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let e=24;0<=e;e-=8)t[n]=this.chain_[i]>>e&255,++n;return t}}function xd(e,t){const n=new Pd(e,t);return n.subscribe.bind(n)}class Pd{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Dd),void 0===r.error&&(r.error=Dd),void 0===r.complete&&(r.complete=Dd);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],--this.observerCount,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dd(){}function Od(e,t,n,r){let i;if(r<t?i="at least "+t:n<r&&(i=0===n?"none":"no more than "+n),i){var s=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}}function Md(e,t){return`${e} failed: ${t} argument `}function Ld(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(Md(e,t)+"must be a valid function.")}function Fd(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(Md(e,t)+"must be a valid context object.")}const Ud=function(e){let t=0;for(let r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t++:n<2048?t+=2:55296<=n&&n<=56319?(t+=4,r++):t+=3}return t},jd=1e3,Vd=2,qd=144e5,Bd=.5;function $d(e,t=jd,n=Vd){var r=t*Math.pow(n,e),i=Math.round(Bd*r*(Math.random()-.5)*2);return Math.min(qd,r+i)}function Kd(e){return e&&e._delegate?e._delegate:e}class Wd{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const zd="[DEFAULT]";class Hd{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new rd;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{var n=this.getOrInitializeService({instanceIdentifier:t});n&&r.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),n=null!==(n=null==e?void 0:e.optional)&&void 0!==n&&n;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:zd})}catch(e){}for(var[t,n]of this.instancesDeferred.entries()){t=this.normalizeInstanceIdentifier(t);try{var r=this.getOrInitializeService({instanceIdentifier:t});n.resolve(r)}catch(e){}}}}clearInstance(e=zd){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=zd){return this.instances.has(e)}getOptions(e=zd){return this.instancesOptions.get(e)||{}}initialize(e={}){var{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);var r,i,s=this.getOrInitializeService({instanceIdentifier:n,options:t});for([r,i]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(r)&&i.resolve(s);return s}onInit(e,t){var n=this.normalizeInstanceIdentifier(t);const r=null!==(i=this.onInitCallbacks.get(n))&&void 0!==i?i:new Set;r.add(e),this.onInitCallbacks.set(n,r);var i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){var n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===zd?void 0:r,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=zd){return!this.component||this.component.multipleInstances?e:zd}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Gd{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){const t=this.getProvider(e.name);t.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);var t=new Hd(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Qd=[];(Wh=Kh=Kh||{})[Wh.DEBUG=0]="DEBUG",Wh[Wh.VERBOSE=1]="VERBOSE",Wh[Wh.INFO=2]="INFO",Wh[Wh.WARN=3]="WARN",Wh[Wh.ERROR=4]="ERROR",Wh[Wh.SILENT=5]="SILENT";const Yd={debug:Kh.DEBUG,verbose:Kh.VERBOSE,info:Kh.INFO,warn:Kh.WARN,error:Kh.ERROR,silent:Kh.SILENT},Jd=Kh.INFO,Xd={[Kh.DEBUG]:"log",[Kh.VERBOSE]:"log",[Kh.INFO]:"info",[Kh.WARN]:"warn",[Kh.ERROR]:"error"},Zd=(e,t,...n)=>{if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=Xd[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)}};class ef{constructor(e){this.name=e,this._logLevel=Jd,this._logHandler=Zd,this._userLogHandler=null,Qd.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Kh))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Yd[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Kh.DEBUG,...e),this._logHandler(this,Kh.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Kh.VERBOSE,...e),this._logHandler(this,Kh.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Kh.INFO,...e),this._logHandler(this,Kh.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Kh.WARN,...e),this._logHandler(this,Kh.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Kh.ERROR,...e),this._logHandler(this,Kh.ERROR,...e)}}function tf(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function nf(n,r,i){var s,e=new Promise(function(e,t){tf(s=n[r].apply(n,i)).then(e,t)});return e.request=s,e}function rf(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function sf(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return nf(this[n],e,arguments)})})}function of(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function af(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=nf(e,n,arguments)).then(function(e){if(e)return new lf(e,t.request)});var e,t})})}function cf(e){this._index=e}function lf(e,t){this._cursor=e,this._request=t}function uf(e){this._store=e}function hf(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function df(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new hf(n)}function ff(e){this._db=e}function pf(e,t,n){var r=nf(indexedDB,"open",[e,t]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new df(i.result,e.oldVersion,i.transaction))}),r.then(function(e){return new ff(e)})}function gf(e){return nf(indexedDB,"deleteDatabase",[e])}rf(cf,"_index",["name","keyPath","multiEntry","unique"]),sf(cf,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),af(cf,"_index",IDBIndex,["openCursor","openKeyCursor"]),rf(lf,"_cursor",["direction","key","primaryKey","value"]),sf(lf,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(lf.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),tf(t._request).then(function(e){if(e)return new lf(e,t._request)})})})}),uf.prototype.createIndex=function(){return new cf(this._store.createIndex.apply(this._store,arguments))},uf.prototype.index=function(){return new cf(this._store.index.apply(this._store,arguments))},rf(uf,"_store",["name","keyPath","indexNames","autoIncrement"]),sf(uf,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),af(uf,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),of(uf,"_store",IDBObjectStore,["deleteIndex"]),hf.prototype.objectStore=function(){return new uf(this._tx.objectStore.apply(this._tx,arguments))},rf(hf,"_tx",["objectStoreNames","mode"]),of(hf,"_tx",IDBTransaction,["abort"]),df.prototype.createObjectStore=function(){return new uf(this._db.createObjectStore.apply(this._db,arguments))},rf(df,"_db",["name","version","objectStoreNames"]),of(df,"_db",IDBDatabase,["deleteObjectStore","close"]),ff.prototype.transaction=function(){return new hf(this._db.transaction.apply(this._db,arguments))},rf(ff,"_db",["name","version","objectStoreNames"]),of(ff,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(s){[uf,cf].forEach(function(e){s in e.prototype&&(e.prototype[s.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,i=r[s].apply(r,t.slice(0,-1));i.onsuccess=function(){n(i.result)}})})}),[cf,uf].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,i=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(i.push(e.value),void 0===n||i.length!=n?e.continue():t(i)):t(i)})})})});class mf{constructor(e){this.container=e}getPlatformInfoString(){const e=this.container.getProviders();return e.map(e=>{if("VERSION"!==(null==(t=e.getComponent())?void 0:t.type))return null;var t,t=e.getImmediate();return`${t.library}/${t.version}`}).filter(e=>e).join(" ")}}const vf="@firebase/app",yf=new ef("@firebase/app");var _f;const wf="[DEFAULT]",bf={"@firebase/app":"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},If=new Map,Tf=new Map;function Ef(t,n){try{t.container.addComponent(n)}catch(e){yf.debug(`Component ${n.name} failed to register with FirebaseApp ${t.name}`,e)}}function Sf(e,t){e.container.addOrOverwriteComponent(t)}function kf(e){var t=e.name;if(Tf.has(t))return yf.debug(`There were multiple attempts to register component ${t}.`),!1;Tf.set(t,e);for(const n of If.values())Ef(n,e);return!0}function Cf(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Af=new md("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class Nf{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Wd("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Af.create("app-deleted",{appName:this._name})}}const Rf="9.6.8";function xf(e,t={}){if("object"!=typeof t){const r=t;t={name:r}}var n=Object.assign({name:wf,automaticDataCollectionEnabled:!1},t);const r=n.name;if("string"!=typeof r||!r)throw Af.create("bad-app-name",{appName:String(r)});var i=If.get(r);if(i){if(Sd(e,i.options)&&Sd(n,i.config))return i;throw Af.create("duplicate-app",{appName:r})}const s=new Gd(r);for(const o of Tf.values())s.addComponent(o);n=new Nf(e,n,s);return If.set(r,n),n}function Pf(e=wf){var t=If.get(e);if(!t)throw Af.create("no-app",{appName:e});return t}async function Df(e){var t=e.name;If.has(t)&&(If.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function Of(e,t,n){let r=null!==(s=bf[e])&&void 0!==s?s:e;n&&(r+=`-${n}`);var i=r.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${t}":`];return i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void yf.warn(o.join(" "))}kf(new Wd(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}function Mf(e,t){if(null!==e&&"function"!=typeof e)throw Af.create("invalid-log-argument");!function(s,e){for(const t of Qd){let i=null;e&&e.level&&(i=Yd[e.level]),t.userLogHandler=null===s?null:(e,t,...n)=>{var r=n.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");t>=(null!==i&&void 0!==i?i:e.logLevel)&&s({level:Kh[t].toLowerCase(),message:r,args:n,type:e.name})}}}(e,t)}function Lf(e){var t;t=e,Qd.forEach(e=>{e.setLogLevel(t)})}const Ff="firebase-heartbeat-database",Uf=1,jf="firebase-heartbeat-store";let Vf=null;function qf(){return Vf=Vf||pf(Ff,Uf,e=>{0===e.oldVersion&&e.createObjectStore(jf)}).catch(e=>{throw Af.create("storage-open",{originalErrorMessage:e.message})}),Vf}async function Bf(e,t){try{const n=await qf(),r=n.transaction(jf,"readwrite"),i=r.objectStore(jf);return await i.put(t,$f(e)),r.complete}catch(e){throw Af.create("storage-set",{originalErrorMessage:e.message})}}function $f(e){return`${e.name}!${e.options.appId}`}class Kf{constructor(e){this.container=e,this._heartbeatsCache=null;var t=this.container.getProvider("app").getImmediate();this._storage=new Wf(t),this._heartbeatsCachePromise=this._storage.read().then(e=>this._heartbeatsCache=e)}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate();var t=e.getPlatformInfoString();const n=function(){const e=new Date;return e.toISOString().substring(0,10)}();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!this._heartbeatsCache.some(e=>e.date===n))return this._heartbeatsCache.push({date:n,userAgent:t}),this._heartbeatsCache=this._heartbeatsCache.filter(e=>{var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache)return"";var{heartbeatsToSend:e,unsentEntries:t}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const s=n.find(e=>e.userAgent===i.userAgent);if(s){if(s.dates.push(i.date),zf(n)>t){s.dates.pop();break}}else if(n.push({userAgent:i.userAgent,dates:[i.date]}),zf(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache),e=Zh(JSON.stringify({version:2,heartbeats:e}));return 0<t.length?(this._heartbeatsCache=t,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache=null,this._storage.deleteAll()),e}}class Wf{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!dd()&&fd().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){var e=await async function(e){try{const t=await qf();return t.transaction(jf).objectStore(jf).get($f(e))}catch(e){throw Af.create("storage-get",{originalErrorMessage:e.message})}}(this.app);return(null==e?void 0:e.heartbeats)||[]}return[]}async overwrite(e){if(await this._canUseIndexedDBPromise)return Bf(this.app,{heartbeats:e})}async add(e){if(await this._canUseIndexedDBPromise){var t=await this.read();return Bf(this.app,{heartbeats:[...t,...e]})}}async delete(t){if(await this._canUseIndexedDBPromise){const e=await this.read();return Bf(this.app,{heartbeats:e.filter(e=>!t.includes(e))})}}async deleteAll(){if(await this._canUseIndexedDBPromise)return async function(e){try{const t=await qf(),n=t.transaction(jf,"readwrite");return await n.objectStore(jf).delete($f(e)),n.complete}catch(e){throw Af.create("storage-delete",{originalErrorMessage:e.message})}}(this.app)}}function zf(e){return Zh(JSON.stringify({version:2,heartbeats:e})).length}_f="",kf(new Wd("platform-logger",e=>new mf(e),"PRIVATE")),kf(new Wd("heartbeat",e=>new Kf(e),"PRIVATE")),Of(vf,"0.7.18",_f),Of(vf,"0.7.18","esm2017"),Of("fire-js","");var Hf=Object.freeze({__proto__:null,SDK_VERSION:Rf,_DEFAULT_ENTRY_NAME:wf,_addComponent:Ef,_addOrOverwriteComponent:Sf,_apps:If,_clearComponents:function(){Tf.clear()},_components:Tf,_getProvider:Cf,_registerComponent:kf,_removeServiceInstance:function(e,t,n=wf){Cf(e,t).clearInstance(n)},deleteApp:Df,getApp:Pf,getApps:function(){return Array.from(If.values())},initializeApp:xf,onLog:Mf,registerVersion:Of,setLogLevel:Lf,FirebaseError:gd});class Gf{constructor(e,t){this._delegate=e,this.firebase=t,Ef(e,new Wd("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Df(this._delegate)))}_getService(e,t=wf){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=wf){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ef(this._delegate,e)}_addOrOverwriteComponent(e){Sf(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Qf=new md("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});function Yf(i){const s={},o={__esModule:!0,initializeApp:function(e,t={}){var n=xf(e,t);if(bd(s,n.name))return s[n.name];var r=new i(n,o);return s[n.name]=r},app:a,registerVersion:Of,setLogLevel:Lf,onLog:Mf,apps:null,SDK_VERSION:Rf,INTERNAL:{registerComponent:function(n){const r=n.name,t=r.replace("-compat","");{var e;kf(n)&&"PUBLIC"===n.type&&(e=(e=a())=>{if("function"!=typeof e[t])throw Qf.create("invalid-app-argument",{appName:r});return e[t]()},void 0!==n.serviceProps&&nd(e,n.serviceProps),o[t]=e,i.prototype[t]=function(...e){const t=this._getService.bind(this,r);return t.apply(this,n.multipleInstances?e:[])})}return"PUBLIC"===n.type?o[t]:null},removeApp:function(e){delete s[e]},useAsService:function(e,t){if("serverAuth"===t)return null;var n=t;return n},modularAPIs:Hf}};function a(e){if(e=e||wf,!bd(s,e))throw Qf.create("no-app",{appName:e});return s[e]}return o.default=o,Object.defineProperty(o,"apps",{get:function(){return Object.keys(s).map(e=>s[e])}}),a.App=i,o}l=function e(){const t=Yf(Gf);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){nd(t,e)},createSubscribe:xd,ErrorFactory:md,deepExtend:nd}),t}();const Jf=new ef("@firebase/app-compat");if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Jf.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const V$=self.firebase.SDK_VERSION;V$&&0<=V$.indexOf("LITE")&&Jf.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Xf=l;Of("@firebase/app-compat","0.1.19",void 0);Xf.registerVersion("firebase","9.6.8","app-compat");ze="@firebase/installations",c="0.5.5";const Zf=1e4,ep="w:0.5.5",tp="FIS_v2",np="https://firebaseinstallations.googleapis.com/v1",rp=36e5;const ip=new md("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function sp(e){return e instanceof gd&&e.code.includes("request-failed")}function op({projectId:e}){return`${np}/projects/${e}/installations`}function ap(e){return{token:e.token,requestStatus:2,expiresIn:(e=e.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()}}async function cp(e,t){var n=(await t.json()).error;return ip.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function lp({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function up(e,{refreshToken:t}){const n=lp(e);return n.append("Authorization",(t=t,`${tp} ${t}`)),n}async function hp(e){var t=await e();return 500<=t.status&&t.status<600?e():t}function dp(t){return new Promise(e=>{setTimeout(e,t)})}const fp=/^[cdef][\w-]{21}$/,pp="";function gp(){try{const t=new Uint8Array(17),n=self.crypto||self.msCrypto;n.getRandomValues(t),t[0]=112+t[0]%16;var e=function(e){const t=function(e){const t=btoa(String.fromCharCode(...e));return t.replace(/\+/g,"-").replace(/\//g,"_")}(e);return t.substr(0,22)}(t);return fp.test(e)?e:pp}catch(e){return pp}}function mp(e){return`${e.appName}!${e.appId}`}const vp=new Map;function yp(e,t){var n=mp(e);_p(n,t),function(e,t){const n=function(){!wp&&"BroadcastChannel"in self&&(wp=new BroadcastChannel("[Firebase] FID Change"),wp.onmessage=e=>{_p(e.data.key,e.data.fid)});return wp}();n&&n.postMessage({key:e,fid:t});0===vp.size&&wp&&(wp.close(),wp=null)}(n,t)}function _p(e,t){var n=vp.get(e);if(n)for(const r of n)r(t)}let wp=null;const bp="firebase-installations-store";let Ip=null;function Tp(){return Ip=Ip||pf("firebase-installations-database",1,e=>{0===e.oldVersion&&e.createObjectStore(bp)}),Ip}async function Ep(e,t){var n=mp(e);const r=await Tp(),i=r.transaction(bp,"readwrite"),s=i.objectStore(bp);var o=await s.get(n);return await s.put(t,n),await i.complete,o&&o.fid===t.fid||yp(e,t.fid),t}async function Sp(e){var t=mp(e);const n=await Tp(),r=n.transaction(bp,"readwrite");await r.objectStore(bp).delete(t),await r.complete}async function kp(e,t){var n=mp(e);const r=await Tp(),i=r.transaction(bp,"readwrite"),s=i.objectStore(bp);var o=await s.get(n),a=t(o);return void 0===a?await s.delete(n):await s.put(a,n),await i.complete,!a||o&&o.fid===a.fid||yp(e,a.fid),a}async function Cp(n){let r;var e=await kp(n,e=>{var t=Np(e||{fid:gp(),registrationStatus:0}),t=function(e,t){{if(0!==t.registrationStatus)return 1===t.registrationStatus?{installationEntry:t,registrationPromise:async function(e){let t=await Ap(e);for(;1===t.registrationStatus;)await dp(100),t=await Ap(e);if(0!==t.registrationStatus)return t;{var{installationEntry:n,registrationPromise:r}=await Cp(e);return r||n}}(e)}:{installationEntry:t};if(!navigator.onLine){var n=Promise.reject(ip.create("app-offline"));return{installationEntry:t,registrationPromise:n}}var r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},n=async function(t,n){try{var e=await async function(e,{fid:t}){const n=op(e);var r=lp(e),i={fid:t,authVersion:tp,appId:e.appId,sdkVersion:ep};const s={method:"POST",headers:r,body:JSON.stringify(i)},o=await hp(()=>fetch(n,s));if(o.ok){i=await o.json();return{fid:i.fid||t,registrationStatus:2,refreshToken:i.refreshToken,authToken:ap(i.authToken)}}throw await cp("Create Installation",o)}(t,n);return Ep(t,e)}catch(e){throw sp(e)&&409===e.customData.serverCode?await Sp(t):await Ep(t,{fid:n.fid,registrationStatus:0}),e}}(e,r);return{installationEntry:r,registrationPromise:n}}}(n,t);return r=t.registrationPromise,t.installationEntry});return e.fid===pp?{installationEntry:await r}:{installationEntry:e,registrationPromise:r}}function Ap(e){return kp(e,e=>{if(!e)throw ip.create("installation-not-found");return Np(e)})}function Np(e){return 1===(t=e).registrationStatus&&t.registrationTime+Zf<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Rp({appConfig:e,platformLoggerProvider:t},n){const r=([i,s]=[e,n["fid"]],`${op(i)}/${s}/authTokens:generate`);var i,s;const o=up(e,n),a=t.getImmediate({optional:!0});a&&o.append("x-firebase-client",a.getPlatformInfoString());var c={installation:{sdkVersion:ep}};const l={method:"POST",headers:o,body:JSON.stringify(c)},u=await hp(()=>fetch(r,l));if(u.ok)return ap(await u.json());throw await cp("Generate Auth Token",u)}async function xp(r,i=!1){let s;var e=await kp(r.appConfig,e=>{if(!Dp(e))throw ip.create("not-registered");var t,n=e.authToken;if(i||2!==(t=n).requestStatus||function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+rp}(t)){if(1===n.requestStatus)return s=async function(e,t){let n=await Pp(e.appConfig);for(;1===n.authToken.requestStatus;)await dp(100),n=await Pp(e.appConfig);var r=n.authToken;return 0===r.requestStatus?xp(e,t):r}(r,i),e;if(!navigator.onLine)throw ip.create("app-offline");n=(t=e,n={requestStatus:1,requestTime:Date.now()},Object.assign(Object.assign({},t),{authToken:n}));return s=async function(t,n){try{var r=await Rp(t,n),e=Object.assign(Object.assign({},n),{authToken:r});return await Ep(t.appConfig,e),r}catch(e){throw!sp(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode?(r=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),await Ep(t.appConfig,r)):await Sp(t.appConfig),e}}(r,n),n}return e});return s?await s:e.authToken}function Pp(e){return kp(e,e=>{if(!Dp(e))throw ip.create("not-registered");var t,n=e.authToken;return 1===(t=n).requestStatus&&t.requestTime+Zf<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function Dp(e){return void 0!==e&&2===e.registrationStatus}async function Op(e,t=!1){var n,r=e;return e=r.appConfig,await((n=(await Cp(e)).registrationPromise)&&await n),(await xp(r,t)).token}function Mp(e){return ip.create("missing-app-config-values",{valueName:e})}const Lp="installations",Fp=e=>{var t=e.getProvider("app").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw Mp("App Configuration");if(!e.name)throw Mp("App Name");for(const t of["projectId","apiKey","appId"])if(!e.options[t])throw Mp(t);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:Cf(t,"platform-logger"),_delete:()=>Promise.resolve()}},Up=e=>{const t=Cf(e.getProvider("app").getImmediate(),Lp).getImmediate();return{getId:()=>async function(e){var t=e;const{installationEntry:n,registrationPromise:r}=await Cp(t.appConfig);return(r||xp(t)).catch(console.error),n.fid}(t),getToken:e=>Op(t,e)}};kf(new Wd(Lp,Fp,"PUBLIC")),kf(new Wd("installations-internal",Up,"PRIVATE")),Of(ze,c),Of(ze,c,"esm2017");const jp="analytics",Vp="firebase_id",qp="origin",Bp="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",$p="https://www.googletagmanager.com/gtag/js",Kp=new ef("@firebase/analytics");function Wp(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function zp(r,i,s,o){return async function(e,t,n){try{"event"===e?await async function(e,n,r,i,s){try{let t=[];if(s&&s.send_to){let e=s.send_to;Array.isArray(e)||(e=[e]);const c=await Wp(r);for(const l of e){var o=c.find(e=>e.measurementId===l),a=o&&n[o.appId];if(!a){t=[];break}t.push(a)}}0===t.length&&(t=Object.values(n)),await Promise.all(t),e("event",i,s||{})}catch(e){Kp.error(e)}}(r,i,s,t,n):"config"===e?await async function(e,t,n,r,i,s){var o=r[i];try{if(o)await t[o];else{const c=await Wp(n);var a=c.find(e=>e.measurementId===i);a&&await t[a.appId]}}catch(e){Kp.error(e)}e("config",i,s)}(r,i,s,o,t,n):r("set",t)}catch(e){Kp.error(e)}}}const Hp=new md("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Gp=30;const Qp=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};async function Yp(e){var t,{appId:n,apiKey:r}=e,r={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":r})},n=Bp.replace("{app-id}",n);const i=await fetch(n,r);if(200===i.status||304===i.status)return i.json();{let e="";try{var s=await i.json();null!==(t=s.error)&&void 0!==t&&t.message&&(e=s.error.message)}catch(e){}throw Hp.create("config-fetch-failed",{httpStatus:i.status,responseMessage:e})}}async function Jp(e,t=Qp,n){var{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw Hp.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Hp.create("no-api-key")}var o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()};const a=new eg;return setTimeout(async()=>{a.abort()},void 0!==n?n:6e4),async function t(n,{throttleEndTimeMillis:e,backoffCount:r},i,s=Qp){const{appId:o,measurementId:a}=n;try{await Xp(i,e)}catch(e){if(a)return Kp.warn("Timed out fetching this Firebase app's measurement ID from the server."+` Falling back to the measurement ID ${a}`+` provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:o,measurementId:a};throw e}try{const c=await Yp(n);return s.deleteThrottleMetadata(o),c}catch(e){if(!Zp(e)){if(s.deleteThrottleMetadata(o),a)return Kp.warn("Failed to fetch this Firebase app's measurement ID from the server."+` Falling back to the measurement ID ${a}`+` provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:o,measurementId:a};throw e}const l=503===Number(e.customData.httpStatus)?$d(r,s.intervalMillis,Gp):$d(r,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:r+1};return s.setThrottleMetadata(o,u),Kp.debug(`Calling attemptFetch again in ${l} millis`),t(n,u,i,s)}}({appId:r,apiKey:i,measurementId:s},o,a,t)}function Xp(i,s){return new Promise((e,t)=>{var n=Math.max(s-Date.now(),0);const r=setTimeout(e,n);i.addEventListener(()=>{clearTimeout(r),t(Hp.create("fetch-throttle",{throttleEndTimeMillis:s}))})})}function Zp(e){if(!(e instanceof gd&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}class eg{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function tg(t,e,n,r,i,s,o){const a=Jp(t);a.then(e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Kp.warn(`The measurement ID in the local Firebase config (${t.options.measurementId})`+` does not match the measurement ID fetched from the server (${e.measurementId}).`+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>Kp.error(e)),e.push(a);var c=async function(){if(!dd())return Kp.warn(Hp.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await fd()}catch(e){return Kp.warn(Hp.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then(e=>{if(e)return r.getId()}),[l,u]=await Promise.all([a,c]);!function(){var e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes($p))return t}()&&function(e,t){const n=document.createElement("script");n.src=`${$p}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,l.measurementId),i("js",new Date);const h=null!==(c=null==o?void 0:o.config)&&void 0!==c?c:{};return h[qp]="firebase",h.update=!0,null!=u&&(h[Vp]=u),i("config",l.measurementId,h),l.measurementId}class ng{constructor(e){this.app=e}_delete(){return delete rg[this.app.options.appId],Promise.resolve()}}let rg={},ig=[];const sg={};let og="dataLayer",ag="gtag",cg,lg,ug=!1;function hg(e){if(ug)throw Hp.create("already-initialized");e.dataLayerName&&(og=e.dataLayerName),e.gtagName&&(ag=e.gtagName)}function dg(e,t,n){!function(){const e=[];var t;cd()&&e.push("This is a browser extension environment."),pd()||e.push("Cookies are not available."),0<e.length&&(t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),t=Hp.create("invalid-analytics-context",{errorInfo:t}),Kp.warn(t.message))}();var r,i,s=e.options.appId;if(!s)throw Hp.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Hp.create("no-api-key");Kp.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+` measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId}`+' provided in the "measurementId" field in the local Firebase config.')}if(null!=rg[s])throw Hp.create("already-exists",{id:s});return ug||(function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t,t}(og),{wrappedGtag:r,gtagCore:i}=function(e,t,n,r,i){let s=function(){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=zp(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(rg,ig,sg,og,ag),lg=r,cg=i,ug=!0),rg[s]=tg(e,ig,sg,t,cg,og,n),new ng(e)}async function fg(){if(cd())return!1;if(!pd())return!1;if(!dd())return!1;try{return await fd()}catch(e){return!1}}function pg(e,t,n){e=Kd(e),async function(e,t,n,r){if(r&&r.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}(lg,rg[e.app.options.appId],t,n).catch(e=>Kp.error(e))}function gg(e,t,n){e=Kd(e),async function(e,t,n,r){if(r&&r.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}(lg,rg[e.app.options.appId],t,n).catch(e=>Kp.error(e))}function mg(e,t,n){e=Kd(e),async function(e,t,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return e("set",i),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(lg,rg[e.app.options.appId],t,n).catch(e=>Kp.error(e))}function vg(e,t){e=Kd(e),async function(e,t){var n=await e;window[`ga-disable-${n}`]=!t}(rg[e.app.options.appId],t).catch(e=>Kp.error(e))}function yg(e,t,n,r){e=Kd(e),async function(e,t,n,r,i){var s;i&&i.global?e("event",n,r):(s=await t,e("event",n,Object.assign(Object.assign({},r),{send_to:s})))}(lg,rg[e.app.options.appId],t,n,r).catch(e=>Kp.error(e))}const _g="@firebase/analytics";kf(new Wd(jp,(e,{options:t})=>{return dg(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)},"PUBLIC")),kf(new Wd("analytics-internal",function(e){try{const r=e.getProvider(jp).getImmediate();return{logEvent:(e,t,n)=>yg(r,e,t,n)}}catch(e){throw Hp.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),Of(_g,"0.7.5"),Of(_g,"0.7.5","esm2017");var wg,bg;class Ig{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,n){yg(this._delegate,e,t,n)}setCurrentScreen(e,t){pg(this._delegate,e,t)}setUserId(e,t){gg(this._delegate,e,t)}setUserProperties(e,t){mg(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){vg(this._delegate,e)}}(z=wg=wg||{}).ADD_SHIPPING_INFO="add_shipping_info",z.ADD_PAYMENT_INFO="add_payment_info",z.ADD_TO_CART="add_to_cart",z.ADD_TO_WISHLIST="add_to_wishlist",z.BEGIN_CHECKOUT="begin_checkout",z.CHECKOUT_PROGRESS="checkout_progress",z.EXCEPTION="exception",z.GENERATE_LEAD="generate_lead",z.LOGIN="login",z.PAGE_VIEW="page_view",z.PURCHASE="purchase",z.REFUND="refund",z.REMOVE_FROM_CART="remove_from_cart",z.SCREEN_VIEW="screen_view",z.SEARCH="search",z.SELECT_CONTENT="select_content",z.SELECT_ITEM="select_item",z.SELECT_PROMOTION="select_promotion",z.SET_CHECKOUT_OPTION="set_checkout_option",z.SHARE="share",z.SIGN_UP="sign_up",z.TIMING_COMPLETE="timing_complete",z.VIEW_CART="view_cart",z.VIEW_ITEM="view_item",z.VIEW_ITEM_LIST="view_item_list",z.VIEW_PROMOTION="view_promotion",z.VIEW_SEARCH_RESULTS="view_search_results";const Tg=e=>{var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("analytics").getImmediate();return new Ig(t,n)};bg={Analytics:Ig,settings:hg,isSupported:fg,EventName:wg},Xf.INTERNAL.registerComponent(new Wd("analytics-compat",Tg,"PUBLIC").setServiceProps(bg).setMultipleInstances(!0)),Xf.registerVersion("@firebase/analytics-compat","0.1.6");const Eg=new Map,Sg={activated:!1,tokenObservers:[]},kg={initialized:!1,enabled:!1};function Cg(e){return Eg.get(e)||Sg}function Ag(e,t){Eg.set(e,t)}const Ng="https://content-firebaseappcheck.googleapis.com/v1beta",Rg="exchangeDebugToken",xg={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class Pg{constructor(e,t,n,r,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,i<(this.nextErrorWaitInterval=r))throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new rd,t=this.getNextRun(e),await new Promise(e=>{setTimeout(e,t)}),this.pending.resolve(),await this.pending.promise,this.pending=new rd,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(e){this.retryPolicy(e)?this.process(!1).catch(()=>{}):this.stop()}var t}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}const Dg=new md("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Og(e=!1){var t;return e?null===(t=self.grecaptcha)||void 0===t?void 0:t.enterprise:self.grecaptcha}function Mg(e){if(!Cg(e).activated)throw Dg.create("use-before-activation",{appName:e.name})}function Lg(e){var t=Math.round(e/1e3),n=Math.floor(t/86400),r=Math.floor((t-3600*n*24)/3600),i=Math.floor((t-3600*n*24-3600*r)/60),t=t-3600*n*24-3600*r-60*i;let s="";return n&&(s+=Fg(n)+"d:"),r&&(s+=Fg(r)+"h:"),s+=Fg(i)+"m:"+Fg(t)+"s",s}function Fg(e){return 0===e?"00":10<=e?e.toString():"0"+e}async function Ug({url:e,body:t},n){const r={"Content-Type":"application/json"},i=n.getImmediate({optional:!0});i&&(r["X-Firebase-Client"]=i.getPlatformInfoString());var s={method:"POST",body:JSON.stringify(t),headers:r};let o;try{o=await fetch(e,s)}catch(e){throw Dg.create("fetch-network-error",{originalErrorMessage:e.message})}if(200!==o.status)throw Dg.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(e){throw Dg.create("fetch-parse-error",{originalErrorMessage:e.message})}var c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw Dg.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration "+`format: ${a.ttl}`});s=1e3*Number(c[1]),c=Date.now();return{token:a.attestationToken,expireTimeMillis:c+s,issuedAtTimeMillis:c}}const jg="firebase-app-check-database",Vg=1,qg="firebase-app-check-store",Bg="debug-token";let $g=null;function Kg(){return $g||($g=new Promise((t,n)=>{try{const e=indexedDB.open(jg,Vg);e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{var t;n(Dg.create("storage-open",{originalErrorMessage:null===(t=e.target.error)||void 0===t?void 0:t.message}))},e.onupgradeneeded=e=>{const t=e.target.result;0===e.oldVersion&&t.createObjectStore(qg,{keyPath:"compositeKey"})}}catch(e){n(Dg.create("storage-open",{originalErrorMessage:e.message}))}}),$g)}async function Wg(e,t){const n=await Kg(),r=n.transaction(qg,"readwrite"),i=r.objectStore(qg),s=i.put({compositeKey:e,value:t});return new Promise((t,n)=>{s.onsuccess=e=>{t()},r.onerror=e=>{var t;n(Dg.create("storage-set",{originalErrorMessage:null===(t=e.target.error)||void 0===t?void 0:t.message}))}})}async function zg(e){const t=await Kg(),i=t.transaction(qg,"readonly"),n=i.objectStore(qg),s=n.get(e);return new Promise((n,r)=>{s.onsuccess=e=>{var t=e.target.result;n(t?t.value:void 0)},i.onerror=e=>{var t;r(Dg.create("storage-get",{originalErrorMessage:null===(t=e.target.error)||void 0===t?void 0:t.message}))}})}function Hg(e){return`${e.options.appId}-${e.name}`}const Gg=new ef("@firebase/app-check");async function Qg(t){if(dd()){let e=void 0;try{e=await zg(Hg(t))}catch(e){Gg.warn(`Failed to read token from IndexedDB. Error: ${e}`)}return e}}function Yg(e,t){return dd()?Wg(Hg(e),t).catch(e=>{Gg.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}async function Jg(){let e=void 0;try{e=await zg(Bg)}catch(e){}if(e)return e;var t,n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)});return t=n,Wg(Bg,t).catch(e=>Gg.warn(`Failed to persist debug token to IndexedDB. Error: ${e}`)),n}function Xg(){return kg.enabled}async function Zg(){var e=kg;if(e.enabled&&e.token)return e.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function em(){var e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}();const t=kg;if(t.initialized=!0,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===e.FIREBASE_APPCHECK_DEBUG_TOKEN){t.enabled=!0;const n=new rd;t.token=n,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(e.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(Jg())}}const tm={error:"UNKNOWN_ERROR"};async function nm(e,t=!1){var n=e.app;Mg(n);const r=Cg(n);let i=r.token,s=void 0;if(i||(a=await r.cachedTokenPromise)&&am(a)&&(i=a),!t&&i&&am(i))return{token:i.token};let o=!1;if(Xg()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Ug(function(e,t){var{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${Ng}/projects/${n}/apps/${r}:${Rg}?key=${i}`,body:{debug_token:t}}}(n,await Zg()),e.platformLoggerProvider).then(e=>(r.exchangeTokenPromise=void 0,e)),o=!0);var a=await r.exchangeTokenPromise;return await Yg(n,a),Ag(n,Object.assign(Object.assign({},r),{token:a})),{token:a.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(e=>(r.exchangeTokenPromise=void 0,e)),o=!0),i=await r.exchangeTokenPromise}catch(e){"appCheck/throttled"===e.code?Gg.warn(e.message):Gg.error(e),s=e}let c;return i?(c={token:i.token},Ag(n,Object.assign(Object.assign({},r),{token:i})),await Yg(n,i)):c=(e=s,{token:function(e){return Xh.encodeString(JSON.stringify(e),!1)}(tm),error:e}),o&&om(n,c),c}function rm(e,t,n,r){var i=e["app"];const s=Cg(i);var o={next:n,error:r,type:t};if(Ag(i,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]})),s.token&&am(s.token)){const a=s.token;Promise.resolve().then(()=>{n({token:a.token}),sm(e)}).catch(()=>{})}s.cachedTokenPromise.then(()=>sm(e))}function im(e,t){const n=Cg(e);var r=n.tokenObservers.filter(e=>e.next!==t);0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),Ag(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function sm(e){var t=e["app"],n=Cg(t);let r=n.tokenRefresher;r||(r=function(n){const r=n["app"];return new Pg(async()=>{var e=Cg(r);let t;if(t=e.token?await nm(n,!0):await nm(n),t.error)throw t.error},()=>!0,()=>{var e=Cg(r);if(e.token){var t=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,e=e.token.expireTimeMillis-3e5,t=Math.min(t,e);return Math.max(0,t-Date.now())}return 0},xg.RETRIAL_MIN_WAIT,xg.RETRIAL_MAX_WAIT)}(e),Ag(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function om(e,t){for(const n of Cg(e).tokenObservers)try{"EXTERNAL"===n.type&&null!=t.error?n.error(t.error):n.next(t)}catch(e){}}function am(e){return 0<e.expireTimeMillis-Date.now()}class cm{constructor(e,t){this.app=e,this.platformLoggerProvider=t}_delete(){var e=Cg(this.app)["tokenObservers"];for(const t of e)im(this.app,t.next);return Promise.resolve()}}const lm="https://www.google.com/recaptcha/api.js",um="https://www.google.com/recaptcha/enterprise.js";function hm(t,n){var e=Cg(t);const r=new rd;Ag(t,Object.assign(Object.assign({},e),{reCAPTCHAState:{initialized:r}}));const i=pm(t);e=Og(!1);return e?fm(t,n,e,i,r):function(e){const t=document.createElement("script");t.src=lm,t.onload=e,document.head.appendChild(t)}(()=>{var e=Og(!1);if(!e)throw new Error("no recaptcha");fm(t,n,e,i,r)}),r.promise}function dm(t,n){var e=Cg(t);const r=new rd;Ag(t,Object.assign(Object.assign({},e),{reCAPTCHAState:{initialized:r}}));const i=pm(t);e=Og(!0);return e?fm(t,n,e,i,r):function(e){const t=document.createElement("script");t.src=um,t.onload=e,document.head.appendChild(t)}(()=>{var e=Og(!0);if(!e)throw new Error("no recaptcha");fm(t,n,e,i,r)}),r.promise}function fm(r,i,s,o,a){s.ready(()=>{var e,t,n;e=r,t=s.render(o,{sitekey:i,size:"invisible"}),n=Cg(e),Ag(e,Object.assign(Object.assign({},n),{reCAPTCHAState:Object.assign(Object.assign({},n.reCAPTCHAState),{widgetId:t})})),a.resolve(s)})}function pm(e){var t=`fire_app_check_${e.name}`;const n=document.createElement("div");return n.id=t,n.style.display="none",document.body.appendChild(n),t}async function gm(r){Mg(r);const i=await Cg(r).reCAPTCHAState.initialized.promise;return new Promise((e,t)=>{const n=Cg(r).reCAPTCHAState;i.ready(()=>{e(i.execute(n.widgetId,{action:"fire_app_check"}))})})}class mm{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){wm(this._throttleData);var t=await gm(this._app).catch(e=>{throw Dg.create("recaptcha-error")});let e;try{e=await Ug(function(e,t){var{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${Ng}/projects/${n}/apps/${r}:exchangeRecaptchaToken?key=${i}`,body:{recaptcha_token:t}}}(this._app,t),this._platformLoggerProvider)}catch(e){throw"fetch-status-error"===e.code?(this._throttleData=_m(Number(null===(t=e.customData)||void 0===t?void 0:t.httpStatus),this._throttleData),Dg.create("throttled",{time:Lg(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):e}return this._throttleData=null,e}initialize(e){this._app=e,this._platformLoggerProvider=Cf(e,"platform-logger"),hm(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof mm&&this._siteKey===e._siteKey}}class vm{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){wm(this._throttleData);var t=await gm(this._app).catch(e=>{throw Dg.create("recaptcha-error")});let e;try{e=await Ug(function(e,t){var{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${Ng}/projects/${n}/apps/${r}:exchangeRecaptchaEnterpriseToken?key=${i}`,body:{recaptcha_enterprise_token:t}}}(this._app,t),this._platformLoggerProvider)}catch(e){throw"fetch-status-error"===e.code?(this._throttleData=_m(Number(null===(t=e.customData)||void 0===t?void 0:t.httpStatus),this._throttleData),Dg.create("throttled",{time:Lg(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):e}return this._throttleData=null,e}initialize(e){this._app=e,this._platformLoggerProvider=Cf(e,"platform-logger"),dm(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof vm&&this._siteKey===e._siteKey}}class ym{constructor(e){this._customProviderOptions=e}async getToken(){var e=await this._customProviderOptions.getToken(),t=function(e){const t=wd(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null}(e.token),t=null!==t&&t<Date.now()&&0<t?1e3*t:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:t})}initialize(e){this._app=e}isEqual(e){return e instanceof ym&&this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString()}}function _m(e,t){if(404===e||403===e)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:e};var n=t?t.backoffCount:0,r=$d(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:e}}function wm(e){if(e&&Date.now()-e.allowRequestsAfter<=0)throw Dg.create("throttled",{time:Lg(e.allowRequestsAfter-Date.now()),httpStatus:e.httpStatus})}function bm(e=Pf(),t){const n=Cf(e=Kd(e),"app-check");if(kg.initialized||em(),Xg()&&Zg().then(e=>console.log(`App Check debug token: ${e}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){var r=n.getImmediate();const i=n.getOptions();if(i.isTokenAutoRefreshEnabled===t.isTokenAutoRefreshEnabled&&i.provider.isEqual(t.provider))return r;throw Dg.create("already-initialized",{appName:e.name})}r=n.initialize({options:t});return function(t,e,n){const r=Cg(t),i=Object.assign(Object.assign({},r),{activated:!0});i.provider=e,i.cachedTokenPromise=Qg(t).then(e=>(e&&am(e)&&(Ag(t,Object.assign(Object.assign({},Cg(t)),{token:e})),om(t,{token:e.token})),e)),i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,Ag(t,i),i.provider.initialize(t)}(e,t.provider,t.isTokenAutoRefreshEnabled),Cg(e).isTokenAutoRefreshEnabled&&rm(r,"INTERNAL",()=>{}),r}const Im="app-check-internal";kf(new Wd("app-check",e=>{var t,n=e.getProvider("app").getImmediate(),r=e.getProvider("platform-logger");return t=n,e=r,new cm(t,e)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider(Im).initialize()})),kf(new Wd(Im,e=>{var t,n=e.getProvider("app-check").getImmediate();return t=n,{getToken:e=>nm(t,e),addTokenListener:e=>rm(t,"INTERNAL",e),removeTokenListener:e=>im(t.app,e)}},"PUBLIC").setInstantiationMode("EXPLICIT")),Of("@firebase/app-check","0.5.3");const Tm=new md("appCheck","AppCheck",{"use-before-activation":"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."});class Em{constructor(e){this.app=e}activate(e,t){let n;n="string"==typeof e?new mm(e):e instanceof vm||e instanceof mm||e instanceof ym?e:new ym({getToken:e.getToken}),this._delegate=bm(this.app,{provider:n,isTokenAutoRefreshEnabled:t})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Tm.create("use-before-activation",{appName:this.app.name});!function(e,t){var n=e.app;const r=Cg(n);r.tokenRefresher&&(!0===t?r.tokenRefresher.start():r.tokenRefresher.stop()),Ag(n,Object.assign(Object.assign({},r),{isTokenAutoRefreshEnabled:t}))}(this._delegate,e)}getToken(e){if(!this._delegate)throw Tm.create("use-before-activation",{appName:this.app.name});return async function(e,t){var n=await nm(e,t);if(n.error)throw n.error;return{token:n.token}}(this._delegate,e)}onTokenChanged(e,t,n){if(!this._delegate)throw Tm.create("use-before-activation",{appName:this.app.name});return function(e,t,n){let r=()=>{},i=()=>{};return r=null!=t.next?t.next.bind(t):t,null!=t.error?i=t.error.bind(t):n&&(i=n),rm(e,"EXTERNAL",r,i),()=>im(e.app,r)}(this._delegate,e,t)}}const Sm=e=>{var t=e.getProvider("app-compat").getImmediate();return new Em(t)};function km(e,t){var n={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}Xf.INTERNAL.registerComponent(new Wd("appCheck-compat",Sm,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:vm,ReCaptchaV3Provider:mm,CustomProvider:ym})),Xf.registerVersion("@firebase/app-check-compat","0.2.3");const Cm={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Am={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function Nm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}function Rm(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}const xm=Nm,Pm=new md("auth","Firebase",Nm()),Dm=new ef("@firebase/auth");function Om(e,...t){Dm.logLevel<=Kh.ERROR&&Dm.error(`Auth (${Rf}): ${e}`,...t)}function Mm(e,...t){throw jm(e,...t)}function Lm(e,...t){return jm(e,...t)}function Fm(e,t,n){var r=Object.assign(Object.assign({},xm()),{[t]:n});const i=new md("auth","Firebase",r);return i.create(t,{appName:e.name})}function Um(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Mm(e,"argument-error"),Fm(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.`+"Did you pass a reference from a different Auth SDK?")}function jm(e,...t){if("string"==typeof e)return Pm.create(e,...t);{var n=t[0];const r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}}function Vm(e,t,...n){if(!e)throw jm(t,...n)}function qm(e){var t="INTERNAL ASSERTION FAILED: "+e;throw Om(t),new Error(t)}function Bm(e,t){e||qm(t)}const $m=new Map;function Km(e){Bm(e instanceof Function,"Expected a class definition");let t=$m.get(e);return t?Bm(t instanceof e,"Instance stored in cache mismatched with class"):(t=new e,$m.set(e,t)),t}function Wm(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function zm(){return"http:"===Hm()||"https:"===Hm()}function Hm(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Gm{constructor(e,t){Bm((this.shortDelay=e)<(this.longDelay=t),"Short delay should be less than long delay!"),this.isMobile=od()||ld()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(zm()||cd()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Qm(e,t){Bm(e.emulator,"Emulator should always be set here");var n=e.emulator["url"];return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Ym{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl||("undefined"!=typeof self&&"fetch"in self?self.fetch:void qm("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill"))}static headers(){return this.headersImpl||("undefined"!=typeof self&&"Headers"in self?self.Headers:void qm("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill"))}static response(){return this.responseImpl||("undefined"!=typeof self&&"Response"in self?self.Response:void qm("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill"))}}const Jm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Xm=new Gm(3e4,6e4);function Zm(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ev(i,s,o,a,e={}){return tv(i,e,async()=>{let e={},t={};a&&("GET"===s?t=a:e={body:JSON.stringify(a)});var n=Cd(Object.assign({key:i.config.apiKey},t)).slice(1);const r=await i._getAdditionalHeaders();return r["Content-Type"]="application/json",i.languageCode&&(r["X-Firebase-Locale"]=i.languageCode),Ym.fetch()(rv(i,i.config.apiHost,o,n),Object.assign({method:s,headers:r,referrerPolicy:"no-referrer"},e))})}async function tv(t,e,n){t._canInitEmulator=!1;var r=Object.assign(Object.assign({},Jm),e);try{const o=new iv(t),a=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();var i=await a.json();if("needConfirmation"in i)throw sv(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const c=a.ok?i.errorMessage:i.error.message,[l,u]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===l)throw sv(t,"credential-already-in-use",i);if("EMAIL_EXISTS"===l)throw sv(t,"email-already-in-use",i);var s=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Fm(t,s,u);Mm(t,s)}}catch(e){if(e instanceof gd)throw e;Mm(t,"network-request-failed")}}async function nv(e,t,n,r,i={}){var s=await ev(e,t,n,r,i);return"mfaPendingCredential"in s&&Mm(e,"multi-factor-auth-required",{_serverResponse:s}),s}function rv(e,t,n,r){var i=`${t}${n}?${r}`;return e.config.emulator?Qm(e.config,i):`${e.config.apiScheme}://${i}`}class iv{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Lm(this.auth,"network-request-failed")),Xm.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function sv(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Lm(e,t,r);return i.customData._tokenResponse=n,i}function ov(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function av(e){return 1e3*Number(e)}function cv(e){var[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Om("JWT malformed, contained fewer than 3 sections"),null;try{var i=td(n);return i?JSON.parse(i):(Om("Failed to decode base64 JWT payload"),null)}catch(e){return Om("Caught error parsing JWT payload as JSON",e),null}}async function lv(t,n,e=!1){if(e)return n;try{return n}catch(e){throw e instanceof gd&&(n=[e["code"]][0],"auth/user-disabled"===n||"auth/user-token-expired"===n)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class uv{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){var t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}this.errorBackoff=3e4;t=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,t)}schedule(e=!1){var t;this.isRunning&&(t=this.getInterval(e),this.timerId=setTimeout(async()=>{await this.iteration()},t))}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class hv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ov(this.lastLoginAt),this.creationTime=ov(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function dv(e){var t=e.auth,n=await e.getIdToken(),r=await lv(e,async function(e,t){return ev(e,"POST","/v1/accounts:lookup",t)}(t,{idToken:n}));Vm(null==r?void 0:r.users.length,t,"internal-error");var i=r.users[0];e._notifyReloadListener(i);var s,o,t=null!==(n=i.providerUserInfo)&&void 0!==n&&n.length?i.providerUserInfo.map(e=>{var t=e["providerId"],n=km(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[],r=(s=e.providerData,o=t,[...s.filter(t=>!o.some(e=>e.providerId===t.providerId)),...o]),n=e.isAnonymous,t=!(e.email&&i.passwordHash||null!==r&&r.length),t=!!n&&t,t={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new hv(i.createdAt,i.lastLoginAt),isAnonymous:t};Object.assign(e,t)}class fv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Vm(e.idToken,"internal-error"),Vm(void 0!==e.idToken,"internal-error"),Vm(void 0!==e.refreshToken,"internal-error");var t,n,n="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):(t=e.idToken,Vm(n=cv(t),"internal-error"),Vm(void 0!==n.exp,"internal-error"),Vm(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,t=!1){return Vm(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){var i,s,{accessToken:n,refreshToken:r,expiresIn:o}=(s=t,await{accessToken:(o=await tv(i=e,{},async()=>{var e=Cd({grant_type:"refresh_token",refresh_token:s}).slice(1),{tokenApiHost:t,apiKey:n}=i.config,n=rv(i,t,"/v1/token",`key=${n}`);const r=await i._getAdditionalHeaders();return r["Content-Type"]="application/x-www-form-urlencoded",Ym.fetch()(n,{method:"POST",headers:r,body:e})})).access_token,expiresIn:o.expires_in,refreshToken:o.refresh_token});this.updateTokensAndExpiration(n,r,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){var{refreshToken:n,accessToken:r,expirationTime:i}=t;const s=new fv;return n&&(Vm("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Vm("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Vm("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fv,this.toJSON())}_performRefresh(){return qm("not implemented")}}function pv(e,t){Vm("string"==typeof e||void 0===e,"internal-error",{appName:t})}class gv{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=km(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){var t=await lv(this,this.stsTokenManager.getToken(this.auth,e));return Vm(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Kd(e);var r=await n.getIdToken(t),i=cv(r);Vm(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");var s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ov(av(i.auth_time)),issuedAtTime:ov(av(i.iat)),expirationTime:ov(av(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Kd(e);await dv(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Vm(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new gv(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){Vm(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await dv(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){var e=await this.getIdToken();return await lv(this,async function(e,t){return ev(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n=null!==(o=t.displayName)&&void 0!==o?o:void 0,r=null!==(g=t.email)&&void 0!==g?g:void 0,i=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,s=null!==(l=t.photoURL)&&void 0!==l?l:void 0,o=null!==(c=t.tenantId)&&void 0!==c?c:void 0,a=null!==(g=t._redirectEventId)&&void 0!==g?g:void 0,c=null!==(l=t.createdAt)&&void 0!==l?l:void 0,l=null!==(g=t.lastLoginAt)&&void 0!==g?g:void 0;const{uid:u,emailVerified:h,isAnonymous:d,providerData:f,stsTokenManager:p}=t;Vm(u&&p,e,"internal-error");var g=fv.fromJSON(this.name,p);Vm("string"==typeof u,e,"internal-error"),pv(n,e.name),pv(r,e.name),Vm("boolean"==typeof h,e,"internal-error"),Vm("boolean"==typeof d,e,"internal-error"),pv(i,e.name),pv(s,e.name),pv(o,e.name),pv(a,e.name),pv(c,e.name),pv(l,e.name);const m=new gv({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:o,stsTokenManager:g,createdAt:c,lastLoginAt:l});return f&&Array.isArray(f)&&(m.providerData=f.map(e=>Object.assign({},e))),a&&(m._redirectEventId=a),m}static async _fromIdTokenResponse(e,t,n=!1){const r=new fv;r.updateFromServerResponse(t);var i=new gv({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await dv(i),i}}class mv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){var t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mv.type="NONE";const vv=mv;function yv(e,t,n){return`firebase:${e}:${t}:${n}`}class _v{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;var{config:r,name:i}=this.auth;this.fullUserKey=yv(this.userKey,r.apiKey,i),this.fullPersistenceKey=yv("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){var e=await this.persistence._get(this.fullUserKey);return e?gv._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence!==e){var t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new _v(Km(vv),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||Km(vv);const s=yv(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{var a=await u._get(s);if(a){var c=gv._fromJSON(e,a);u!==i&&(o=c),i=u;break}}catch(e){}var l=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&l.length&&(i=l[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new _v(i,e,n)}}function wv(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ev(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(bv(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(kv(t))return"Blackberry";if(Cv(t))return"Webos";if(Iv(t))return"Safari";if((t.includes("chrome/")||Tv(t))&&!t.includes("edge/"))return"Chrome";if(Sv(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function bv(e=sd()){return/firefox\//i.test(e)}function Iv(e=sd()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Tv(e=sd()){return/crios\//i.test(e)}function Ev(e=sd()){return/iemobile/i.test(e)}function Sv(e=sd()){return/android/i.test(e)}function kv(e=sd()){return/blackberry/i.test(e)}function Cv(e=sd()){return/webos/i.test(e)}function Av(e=sd()){return/iphone|ipad|ipod/i.test(e)}function Nv(e=sd()){return Av(e)||Sv(e)||Cv(e)||kv(e)||/windows phone/i.test(e)||Ev(e)}function Rv(e,t=[]){let n;switch(e){case"Browser":n=wv(sd());break;case"Worker":n=`${wv(sd())}-${e}`;break;default:n=e}var r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Rf}/${r}`}class xv{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dv(this),this.idTokenSubscription=new Dv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Pm,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(t,n){return n&&(this._popupRedirectResolver=Km(n)),this._initializationPromise=this.queue(async()=>{var e;if(!this._deleted&&(this.persistenceManager=await _v.create(this,t),!this._deleted)){if(null!==(e=this._popupRedirectResolver)&&void 0!==e&&e._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(n),this.lastNotifiedUid=(null===(e=this.currentUser)||void 0===e?void 0:e.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(!this._deleted){var e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e)return this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e)}}async initializeCurrentUser(e){var t,n,r;let i=await this.assertedPersistence.getCurrentUser();return e&&this.config.authDomain&&(await this.getOrInitRedirectPersistenceManager(),t=null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId,n=null===i||void 0===i?void 0:i._redirectEventId,r=await this.tryRedirectSignIn(e),t&&t!==n||null==r||!r.user||(i=r.user)),i?i._redirectEventId?(Vm(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)):this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await dv(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Kd(e):null;return t&&Vm(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&Vm(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Km(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new md("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){var t;return this.redirectPersistenceManager||(Vm(t=e&&Km(e)||this._popupRedirectResolver,this,"argument-error"),this.redirectPersistenceManager=await _v.create(this,[Km(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()),this.redirectPersistenceManager}async _redirectUserForId(e){var t;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e;this._isInitialized&&(this.idTokenSubscription.next(this.currentUser),e=null!==(e=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==e?e:null,this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser)))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Vm(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),(this.currentUser=e)?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Vm(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};return this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId),e}}function Pv(e){return Kd(e)}class Dv{constructor(e){this.auth=e,this.observer=null,this.addObserver=xd(e=>this.observer=e)}get next(){return Vm(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ov(e,t,n){const r=Pv(e);Vm(r._canInitEmulator,r,"emulator-config-failed"),Vm(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!(null==n||!n.disableWarnings);const s=Mv(t);var{host:o,port:a}=function(e){const t=Mv(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);{if(i){var s=i[1];return{host:s,port:Lv(r.substr(s.length+1))}}var[o,s]=r.split(":");return{host:o,port:Lv(s)}}}(t);r.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Mv(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Lv(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}class Fv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return qm("not implemented")}_getIdTokenResponse(e){return qm("not implemented")}_linkToIdToken(e,t){return qm("not implemented")}_getReauthenticationResolver(e){return qm("not implemented")}}async function Uv(e,t){return ev(e,"POST","/v1/accounts:resetPassword",Zm(e,t))}async function jv(e,t){return ev(e,"POST","/v1/accounts:update",t)}async function Vv(e,t){return ev(e,"POST","/v1/accounts:sendOobCode",Zm(e,t))}class qv extends Fv{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new qv(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new qv(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){var t="string"==typeof e?JSON.parse(e):e;if(null!=t&&t.email&&null!=t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return nv(e,"POST","/v1/accounts:signInWithPassword",Zm(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return nv(e,"POST","/v1/accounts:signInWithEmailLink",Zm(e,t))}(e,{email:this._email,oobCode:this._password});default:Mm(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return jv(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return nv(e,"POST","/v1/accounts:signInWithEmailLink",Zm(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Mm(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Bv(e,t){return nv(e,"POST","/v1/accounts:signInWithIdp",Zm(e,t))}class $v extends Fv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $v(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mm("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){var t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,t=km(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new $v(n,r);return i.idToken=t.idToken||void 0,i.accessToken=t.accessToken||void 0,i.secret=t.secret,i.nonce=t.nonce,i.pendingToken=t.pendingToken||null,i}_getIdTokenResponse(e){return Bv(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Bv(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bv(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cd(t)}return e}}const Kv={USER_NOT_FOUND:"user-not-found"};class Wv extends Fv{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Wv({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Wv({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return nv(e,"POST","/v1/accounts:signInWithPhoneNumber",Zm(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){var n=await nv(e,"POST","/v1/accounts:signInWithPhoneNumber",Zm(e,t));if(n.temporaryProof)throw sv(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return nv(e,"POST","/v1/accounts:signInWithPhoneNumber",Zm(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Kv)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){var{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){var{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e="string"==typeof e?JSON.parse(e):e;return n||t||r||i?new Wv({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class zv{constructor(e){var t=Ad(Nd(e)),n=null!==(r=t.apiKey)&&void 0!==r?r:null,r=null!==(i=t.oobCode)&&void 0!==i?i:null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=t.mode)&&void 0!==i?i:null);Vm(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=null!==(r=t.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(r=t.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(t=t.tenantId)&&void 0!==t?t:null}static parseLink(e){var t,n,r,t=(t=Ad(Nd(e=e)).link,n=t?Ad(Nd(t)).deep_link_id:null,((r=Ad(Nd(e)).deep_link_id)?Ad(Nd(r)).link:null)||r||n||t||e);try{return new zv(t)}catch(e){return null}}}class Hv{constructor(){this.providerId=Hv.PROVIDER_ID}static credential(e,t){return qv._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){var n=zv.parseLink(t);return Vm(n,"argument-error"),qv._fromEmailAndCode(e,n.code,n.tenantId)}}Hv.PROVIDER_ID="password",Hv.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Hv.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Gv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Qv extends Gv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Yv extends Qv{static credentialFromJSON(e){var t="string"==typeof e?JSON.parse(e):e;return Vm("providerId"in t&&"signInMethod"in t,"argument-error"),$v._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Vm(e.idToken||e.accessToken,"argument-error"),$v._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Yv.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Yv.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new Yv(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:i})}catch(e){return null}}}class Jv extends Qv{constructor(){super("facebook.com")}static credential(e){return $v._fromParams({providerId:Jv.PROVIDER_ID,signInMethod:Jv.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jv.credentialFromTaggedObject(e)}static credentialFromError(e){return Jv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Jv.credential(e.oauthAccessToken)}catch(e){return null}}}Jv.FACEBOOK_SIGN_IN_METHOD="facebook.com",Jv.PROVIDER_ID="facebook.com";class Xv extends Qv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $v._fromParams({providerId:Xv.PROVIDER_ID,signInMethod:Xv.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Xv.credentialFromTaggedObject(e)}static credentialFromError(e){return Xv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Xv.credential(t,n)}catch(e){return null}}}Xv.GOOGLE_SIGN_IN_METHOD="google.com",Xv.PROVIDER_ID="google.com";class Zv extends Qv{constructor(){super("github.com")}static credential(e){return $v._fromParams({providerId:Zv.PROVIDER_ID,signInMethod:Zv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zv.credentialFromTaggedObject(e)}static credentialFromError(e){return Zv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Zv.credential(e.oauthAccessToken)}catch(e){return null}}}Zv.GITHUB_SIGN_IN_METHOD="github.com",Zv.PROVIDER_ID="github.com";class ey extends Fv{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Bv(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Bv(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bv(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){var{providerId:t,signInMethod:n,pendingToken:r}="string"==typeof e?JSON.parse(e):e;return t&&n&&r&&t===n?new ey(t,r):null}static _create(e,t){return new ey(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class ty extends Gv{constructor(e){Vm(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return ty.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return ty.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){var t=ey.fromJSON(e);return Vm(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return ey._create(n,t)}catch(e){return null}}}class ny extends Qv{constructor(){super("twitter.com")}static credential(e,t){return $v._fromParams({providerId:ny.PROVIDER_ID,signInMethod:ny.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ny.credentialFromTaggedObject(e)}static credentialFromError(e){return ny.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ny.credential(t,n)}catch(e){return null}}}async function ry(e,t){return nv(e,"POST","/v1/accounts:signUp",Zm(e,t))}ny.TWITTER_SIGN_IN_METHOD="twitter.com",ny.PROVIDER_ID="twitter.com";class iy{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){var i=await gv._fromIdTokenResponse(e,n,r),s=sy(n);return new iy({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);var r=sy(n);return new iy({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function sy(e){return e.providerId||("phoneNumber"in e?"phone":null)}class oy extends gd{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,oy.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new oy(e,t,n,r)}}function ay(t,n,e,r){const i="reauthenticate"===n?e._getReauthenticationResolver(t):e._getIdTokenResponse(t);return i.catch(e=>{if("auth/multi-factor-auth-required"===e.code)throw oy._fromErrorAndOperation(t,e,n,r);throw e})}function cy(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function ly(e,t){const n=Kd(e);await hy(!0,n,t);var r=(e=n.auth,t={idToken:await n.getIdToken(),deleteProvider:[t]},await ev(e,"POST","/v1/accounts:update",t))["providerUserInfo"];const i=cy(r||[]);return n.providerData=n.providerData.filter(e=>i.has(e.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function uy(e,t,n=!1){var r=await lv(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return iy._forOperation(e,"link",r)}async function hy(e,t,n){await dv(t);const r=cy(t.providerData);var i=!1===e?"provider-already-linked":"no-such-provider";Vm(r.has(n)===e,t.auth,i)}async function dy(e,t,n=!1){var r=e["auth"],i="reauthenticate";try{var s=await lv(e,ay(r,i,t,e),n);Vm(s.idToken,r,"internal-error");var o=cv(s.idToken);Vm(o,r,"internal-error");var a=o["sub"];return Vm(e.uid===a,r,"user-mismatch"),iy._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Mm(r,"user-mismatch"),e}}async function fy(e,t,n=!1){var r=await ay(e,"signIn",t),r=await iy._fromIdTokenResponse(e,"signIn",r);return n||await e._updateCurrentUser(r.user),r}async function py(e,t){return fy(Pv(e),t)}async function gy(e,t){var n=Kd(e);return await hy(!1,n,t.providerId),uy(n,t)}async function my(e,t){return dy(Kd(e),t)}async function vy(e,t){const n=Pv(e);var r=await nv(n,"POST","/v1/accounts:signInWithCustomToken",Zm(n,{token:t,returnSecureToken:!0})),r=await iy._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(r.user),r}class yy{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?_y._fromServerResponse(e,t):Mm(e,"internal-error")}}class _y extends yy{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new _y(t)}}function wy(e,t,n){var r;Vm(0<(null===(r=n.url)||void 0===r?void 0:r.length),e,"invalid-continue-uri"),Vm(void 0===n.dynamicLinkDomain||0<n.dynamicLinkDomain.length,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Vm(0<n.iOS.bundleId.length,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Vm(0<n.android.packageName.length,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function by(e,t,n){var r=Kd(e),i={requestType:"PASSWORD_RESET",email:t};n&&wy(r,i,n),await Vv(r,i)}async function Iy(e,t){await ev(e=Kd(e),"POST","/v1/accounts:update",Zm(e,{oobCode:t}))}async function Ty(e,t){var n=Kd(e),r=await Uv(n,{oobCode:t}),i=r.requestType;switch(Vm(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Vm(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Vm(r.mfaInfo,n,"internal-error");default:Vm(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=yy._fromServerResponse(Pv(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Ey(e,t,n){var r=Kd(e),i={requestType:"EMAIL_SIGNIN",email:t};Vm(n.handleCodeInApp,r,"argument-error"),n&&wy(r,i,n),await Vv(r,i)}async function Sy(e,t){var n=zm()?Wm():"http://localhost",n=(await ev(e=Kd(e),"POST","/v1/accounts:createAuthUri",Zm(e,{identifier:t,continueUri:n})))["signinMethods"];return n||[]}async function ky(e,t){var n=Kd(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&wy(n.auth,r,t);var r=(await Vv(n.auth,r))["email"];r!==e.email&&await e.reload()}async function Cy(e,t,n){var r=Kd(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&wy(r.auth,i,n);var i=(await Vv(r.auth,i))["email"];i!==e.email&&await e.reload()}async function Ay(e,{displayName:t,photoURL:n}){if(void 0!==t||void 0!==n){const i=Kd(e);var r=await i.getIdToken(),r=await lv(i,async function(e,t){return ev(e,"POST","/v1/accounts:update",t)}(i.auth,{idToken:r,displayName:t,photoUrl:n,returnSecureToken:!0}));i.displayName=r.displayName||null,i.photoURL=r.photoUrl||null;const s=i.providerData.find(({providerId:e})=>"password"===e);s&&(s.displayName=i.displayName,s.photoURL=i.photoURL),await i._updateTokensIfNecessary(r)}}async function Ny(e,t,n){var r=e["auth"];const i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);r=await lv(e,jv(r,i));await e._updateTokensIfNecessary(r,!0)}class Ry{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class xy extends Ry{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Py extends Ry{constructor(e,t){super(e,"facebook.com",t)}}class Dy extends xy{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class Oy extends Ry{constructor(e,t){super(e,"google.com",t)}}class My extends xy{constructor(e,t,n){super(e,"twitter.com",t,n)}}function Ly(e){var{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){if(!e)return null;var t=e["providerId"],n=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},r=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!t&&null!=e&&e.idToken){var i=null===(i=null===(i=cv(e.idToken))||void 0===i?void 0:i.firebase)||void 0===i?void 0:i.sign_in_provider;if(i){i="anonymous"!==i&&"custom"!==i?i:null;return new Ry(r,i)}}if(!t)return null;switch(t){case"facebook.com":return new Py(r,n);case"github.com":return new Dy(r,n);case"google.com":return new Oy(r,n);case"twitter.com":return new My(r,n,e.screenName||null);case"custom":case"anonymous":return new Ry(r,null);default:return new Ry(r,t,n)}}(n)}class Fy{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new Fy("enroll",e)}static _fromMfaPendingCredential(e){return new Fy("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t;if(null!=e&&e.multiFactorSession){if(null!==(t=e.multiFactorSession)&&void 0!==t&&t.pendingCredential)return Fy._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null!==(t=e.multiFactorSession)&&void 0!==t&&t.idToken)return Fy._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Uy{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,i){const s=Pv(e),o=i.customData._serverResponse;var t=(o.mfaInfo||[]).map(e=>yy._fromServerResponse(s,e));Vm(o.mfaPendingCredential,s,"internal-error");const a=Fy._fromMfaPendingCredential(o.mfaPendingCredential);return new Uy(a,t,async e=>{var t=await e._process(s,a);delete o.mfaInfo,delete o.mfaPendingCredential;var n=Object.assign(Object.assign({},o),{idToken:t.idToken,refreshToken:t.refreshToken});switch(i.operationType){case"signIn":var r=await iy._fromIdTokenResponse(s,i.operationType,n);return await s._updateCurrentUser(r.user),r;case"reauthenticate":return Vm(i.user,s,"internal-error"),iy._forOperation(i.user,i.operationType,n);default:Mm(s,"internal-error")}})}async resolveSignIn(e){return this.signInResolver(e)}}class jy{constructor(t){this.user=t,this.enrolledFactors=[],t._onReload(e=>{e.mfaInfo&&(this.enrolledFactors=e.mfaInfo.map(e=>yy._fromServerResponse(t.auth,e)))})}static _fromUser(e){return new jy(e)}async getSession(){return Fy._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e;var r=await this.getSession(),r=await lv(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid;var n,r=await this.user.getIdToken(),r=await lv(this.user,(n=this.user.auth,e={idToken:r,mfaEnrollmentId:t},ev(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Zm(n,e))));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(e){if("auth/user-token-expired"!==e.code)throw e}}}const Vy=new WeakMap;const qy="__sak";class By{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qy,"1"),this.storage.removeItem(qy),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class $y extends By{constructor(){var e;super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=(Iv(e=sd())||Av(e))&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Nv(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){var t=this.storage.getItem(r),n=this.localCache[r];t!==n&&e(r,n,t)}}onStorageEvent(e,t=!1){if(e.key){const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}var n=()=>{var e=this.storage.getItem(r);!t&&this.localCache[r]===e||this.notifyListeners(r,e)};const i=this.storage.getItem(r);ud()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,10):n()}else this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)})}notifyListeners(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){var t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}$y.type="LOCAL";const Ky=$y;class Wy extends By{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Wy.type="SESSION";const zy=Wy;class Hy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){var e=this.receivers.find(e=>e.isListeningto(t));if(e)return e;e=new Hy(t);return this.receivers.push(e),e}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data;var s=this.handlersMap[r];null!=s&&s.size&&(t.ports[0].postMessage({status:"ack",eventId:n,eventType:r}),s=Array.from(s).map(async e=>e(t.origin,i)),s=await Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})),t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:s}))}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Gy(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Hy.receivers=[];class Qy{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,o=50){const a="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let c,l;return new Promise((n,r)=>{const i=Gy("",20);a.port1.start();const s=setTimeout(()=>{r(new Error("unsupported_event"))},o);l={messageChannel:a,onMessage(e){var t=e;if(t.data.eventId===i)switch(t.data.status){case"ack":clearTimeout(s),c=setTimeout(()=>{r(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),n(t.data.response);break;default:clearTimeout(s),clearTimeout(c),r(new Error("invalid_response"))}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:i,data:t},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function Yy(){return window}function Jy(){return void 0!==Yy().WorkerGlobalScope&&"function"==typeof Yy().importScripts}const Xy="firebaseLocalStorageDb",Zy="firebaseLocalStorage",e_="fbase_key";class t_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function n_(e,t){return e.transaction([Zy],t?"readwrite":"readonly").objectStore(Zy)}function r_(){const r=indexedDB.open(Xy,1);return new Promise((n,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const e=r.result;try{e.createObjectStore(Zy,{keyPath:e_})}catch(e){t(e)}}),r.addEventListener("success",async()=>{const e=r.result;var t;e.objectStoreNames.contains(Zy)?n(e):(e.close(),t=indexedDB.deleteDatabase(Xy),await new t_(t).toPromise(),n(await r_()))})})}async function i_(e,t,n){var r=n_(e,!0).put({fbase_key:t,value:n});return new t_(r).toPromise()}function s_(e,t){var n=n_(e,!0).delete(t);return new t_(n).toPromise()}class o_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await r_(),this.db)}async _withRetries(e){let t=0;for(;;)try{return e(await this._openDb())}catch(e){if(3<t++)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Jy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hy._getInstance(Jy()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>{const n=await this._poll();return{keyProcessed:n.includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t,n;this.activeServiceWorker=await async function(){if(null===navigator||void 0===navigator||!navigator.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),this.activeServiceWorker&&(this.sender=new Qy(this.activeServiceWorker),(n=await this.sender._send("ping",{},800))&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0))}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;var e=await r_();return await i_(e,qy,"1"),await s_(e,qy),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(t,n){return this._withPendingWrite(async()=>(await this._withRetries(e=>i_(e,t,n)),this.localCache[t]=n,this.notifyServiceWorker(t)))}async _get(t){var e=await this._withRetries(e=>async function(e,t){var n=n_(e,!1).get(t);return void 0===(n=await new t_(n).toPromise())?null:n.value}(e,t));return this.localCache[t]=e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>s_(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){var e,t,n=await this._withRetries(e=>{var t=n_(e,!1).getAll();return new t_(t).toPromise()});if(!n)return[];if(0!==this.pendingWrites)return[];const r=[],i=new Set;for({fbase_key:e,value:t}of n)i.add(e),JSON.stringify(this.localCache[e])!==JSON.stringify(t)&&(this.notifyListeners(e,t),r.push(e));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}o_.type="LOCAL";const a_=o_;function c_(i){return new Promise((e,n)=>{const t=document.createElement("script");var r;t.setAttribute("src",i),t.onload=e,t.onerror=e=>{const t=Lm("internal-error");t.customData=e,n(t)},t.type="text/javascript",t.charset="UTF-8",(null!==(r=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==r?r:document).appendChild(t)})}function l_(e){return`__${e}${Math.floor(1e6*Math.random())}`}class u_{constructor(e){this.auth=e,this.counter=1e12,this._widgets=new Map}render(e,t){var n=this.counter;return this._widgets.set(n,new h_(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t,n=e||1e12;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;return(null===(t=this._widgets.get(e||1e12))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;return null===(t=this._widgets.get(e||1e12))||void 0===t||t.execute(),""}}class h_{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};var r="string"==typeof e?document.getElementById(e):e;Vm(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const d_=l_("rcb"),f_=new Gm(3e4,6e4);class p_{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Yy().grecaptcha}load(s,o=""){var e;return Vm((e=o).length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e),s,"argument-error"),this.shouldResolveImmediately(o)?Promise.resolve(Yy().grecaptcha):new Promise((t,n)=>{const i=Yy().setTimeout(()=>{n(Lm(s,"network-request-failed"))},f_.get());Yy()[d_]=()=>{Yy().clearTimeout(i),delete Yy()[d_];const e=Yy().grecaptcha;if(e){const r=e.render;e.render=(e,t)=>{var n=r(e,t);return this.counter++,n},this.hostLanguage=o,t(e)}else n(Lm(s,"internal-error"))},c_(`https://www.google.com/recaptcha/api.js??${Cd({onload:d_,render:"explicit",hl:o})}`).catch(()=>{clearTimeout(i),n(Lm(s,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Yy().grecaptcha&&(e===this.hostLanguage||0<this.counter||this.librarySeparatelyLoaded)}}class g_{async load(e){return new u_(e)}clearedOneInstance(){}}const m_="recaptcha",v_={theme:"light",type:"image"};class y_{constructor(e,t=Object.assign({},v_),n){this.parameters=t,this.type=m_,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Pv(n),this.isInvisible="invisible"===this.parameters.size,Vm("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");var r="string"==typeof e?document.getElementById(e):e;Vm(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=new(this.auth.settings.appVerificationDisabledForTesting?g_:p_),this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),r=this.getAssertedRecaptcha();var t=r.getResponse(e);return t||new Promise(t=>{const n=e=>{e&&(this.tokenChangeListeners.delete(n),t(e))};this.tokenChangeListeners.add(n),this.isInvisible&&r.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Vm(!this.parameters.sitekey,this.auth,"argument-error"),Vm(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Vm("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(n){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof n)n(t);else if("string"==typeof n){const e=Yy()[n];"function"==typeof e&&e(t)}}}assertNotDestroyed(){Vm(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;var t;this.isInvisible||(t=document.createElement("div"),e.appendChild(t),e=t),this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Vm(zm()&&!Jy(),this.auth,"internal-error"),await function(){let t=null;return new Promise(e=>{"complete"!==document.readyState?(t=()=>e(),window.addEventListener("load",t)):e()}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);var e=await((await ev(this.auth,"GET","/v1/recaptchaParams")).recaptchaSiteKey||"");Vm(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Vm(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class __{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){var t=Wv._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function w_(t,n,r){var i,s,o,a,c,l,u=await r.verify();try{Vm("string"==typeof u,t,"argument-error"),Vm(r.type===m_,t,"argument-error");let e;if(e="string"==typeof n?{phoneNumber:n}:n,"session"in e){var h=e.session;if("phoneNumber"in e)return Vm("enroll"===h.type,t,"internal-error"),(c=t,l={idToken:h.credential,phoneEnrollmentInfo:{phoneNumber:e.phoneNumber,recaptchaToken:u}},await ev(c,"POST","/v2/accounts/mfaEnrollment:start",Zm(c,l))).phoneSessionInfo.sessionInfo;Vm("signin"===h.type,t,"internal-error");var d=(null===(i=e.multiFactorHint)||void 0===i?void 0:i.uid)||e.multiFactorUid;return Vm(d,t,"missing-multi-factor-info"),(a={mfaPendingCredential:h.credential,mfaEnrollmentId:d,phoneSignInInfo:{recaptchaToken:u}},await ev(t,"POST","/v2/accounts/mfaSignIn:start",Zm(t,a))).phoneResponseInfo.sessionInfo}var f=(s=t,o={phoneNumber:e.phoneNumber,recaptchaToken:u},await ev(s,"POST","/v1/accounts:sendVerificationCode",Zm(s,o)))["sessionInfo"];return f}finally{r._reset()}}class b_{constructor(e){this.providerId=b_.PROVIDER_ID,this.auth=Pv(e)}verifyPhoneNumber(e,t){return w_(this.auth,e,Kd(t))}static credential(e,t){return Wv._fromVerification(e,t)}static credentialFromResult(e){var t=e;return b_.credentialFromTaggedObject(t)}static credentialFromError(e){return b_.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{phoneNumber:t,temporaryProof:n}=e;return t&&n?Wv._fromTokenResponse(t,n):null}}function I_(e,t){return t?Km(t):(Vm(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}b_.PROVIDER_ID="phone",b_.PHONE_SIGN_IN_METHOD="phone";class T_ extends Fv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bv(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bv(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bv(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function E_(e){return fy(e.auth,new T_(e),e.bypassAuthState)}function S_(e){var{auth:t,user:n}=e;return Vm(n,t,"internal-error"),dy(n,new T_(e),e.bypassAuthState)}async function k_(e){var{auth:t,user:n}=e;return Vm(n,t,"internal-error"),uy(n,new T_(e),e.bypassAuthState)}class C_{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){var{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)this.reject(s);else{r={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(r))}catch(e){this.reject(e)}}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return E_;case"linkViaPopup":case"linkViaRedirect":return k_;case"reauthViaPopup":case"reauthViaRedirect":return S_;default:Mm(this.auth,"internal-error")}}resolve(e){Bm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const A_=new Gm(2e3,1e4);class N_ extends C_{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,N_.currentPopupAction&&N_.currentPopupAction.cancel(),N_.currentPopupAction=this}async executeNotNull(){var e=await this.execute();return Vm(e,this.auth,"internal-error"),e}async onExecution(){Bm(1===this.filter.length,"Popup operations only handle one event");var e=Gy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Lm(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Lm(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,N_.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e;null!==(e=null===(e=this.authWindow)||void 0===e?void 0:e.window)&&void 0!==e&&e.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Lm(this.auth,"popup-closed-by-user"))},2e3):this.pollId=window.setTimeout(t,A_.get())};t()}}N_.currentPopupAction=null;const R_="pendingRedirect",x_=new Map;class P_ extends C_{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let t=x_.get(this.auth._key());if(!t){try{const e=await async function(e,t){const n=M_(t),r=O_(e);if(!await r._isAvailable())return!1;var i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}x_.set(this.auth._key(),t)}return this.bypassAuthState||x_.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){var t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function D_(e,t){return O_(e)._set(M_(t),"true")}function O_(e){return Km(e._redirectPersistence)}function M_(e){return yv(R_,e.config.apiKey,e.name)}function L_(e,t,n){return async function(e,t,n){var r=Pv(e);Um(e,t,Gv);const i=I_(r,n);return await D_(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function F_(e,t,n){return async function(e,t,n){var r=Kd(e);Um(r.auth,t,Gv);const i=I_(r.auth,n);await D_(i,r.auth);var s=await V_(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function U_(e,t,n){return async function(e,t,n){var r=Kd(e);Um(r.auth,t,Gv);const i=I_(r.auth,n);await hy(!1,r,t.providerId),await D_(i,r.auth);var s=await V_(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function j_(e,t,n=!1){const r=Pv(e);var i=I_(r,t);const s=new P_(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function V_(e){var t=Gy(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class q_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(e=>{this.isEventForConsumer(t,e)&&(n=!0,this.sendToConsumer(t,e),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $_(e);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(e,t){var n;e.error&&!$_(e)?(n=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error",t.onError(Lm(this.auth,n))):t.onAuthEvent(e)}isEventForConsumer(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return 6e5<=Date.now()-this.lastProcessedEventTime&&this.cachedEventUids.clear(),this.cachedEventUids.has(B_(e))}saveEventToCache(e){this.cachedEventUids.add(B_(e)),this.lastProcessedEventTime=Date.now()}}function B_(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function $_({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function K_(e,t={}){return ev(e,"GET","/v1/projects",t)}const W_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,z_=/^https?/;async function H_(e){if(!e.config.emulator){var t=(await K_(e))["authorizedDomains"];for(const n of t)try{if(function(e){const t=Wm(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){var i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!z_.test(n))return!1;if(W_.test(e))return r===e;const s=e.replace(/\./g,"\\."),o=new RegExp("^(.+\\."+s+"|"+s+")$","i");return o.test(r)}(n))return}catch(e){}Mm(e,"unauthorized-domain")}}const G_=new Gm(3e4,6e4);function Q_(){const t=Yy().___jsl;if(null!==t&&void 0!==t&&t.H)for(const n of Object.keys(t.H))if(t.H[n].r=t.H[n].r||[],t.H[n].L=t.H[n].L||[],t.H[n].r=[...t.H[n].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let Y_=null;function J_(e){var i;return Y_=Y_||(i=e,new Promise((e,t)=>{function n(){Q_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Q_(),t(Lm(i,"network-request-failed"))},timeout:G_.get()})}if(null!==(r=null===(r=Yy().gapi)||void 0===r?void 0:r.iframes)&&void 0!==r&&r.Iframe)e(gapi.iframes.getContext());else{if(null===(r=Yy().gapi)||void 0===r||!r.load){var r=l_("iframefcb");return Yy()[r]=()=>{gapi.load?n():t(Lm(i,"network-request-failed"))},c_(`https://apis.google.com/js/api.js?onload=${r}`).catch(e=>t(e))}n()}}).catch(e=>{throw Y_=null,e})),Y_}const X_=new Gm(5e3,15e3),Z_="__/auth/iframe",ew="emulator/auth/iframe",tw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function rw(o){const e=await J_(o);var t=Yy().gapi;return Vm(t,o,"internal-error"),e.open({where:document.body,url:function(e){var t=e.config;Vm(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Qm(t,ew):`https://${e.config.authDomain}/${Z_}`;const r={apiKey:t.apiKey,appName:e.name,v:Rf};(t=nw.get(e.config.apiHost))&&(r.eid=t);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Cd(r).slice(1)}`}(o),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tw,dontclear:!0},s=>new Promise(async(e,t)=>{await s.restyle({setHideOnLeave:!1});const n=Lm(o,"network-request-failed"),r=Yy().setTimeout(()=>{t(n)},X_.get());function i(){Yy().clearTimeout(r),e(s)}s.ping(i).then(i,()=>{t(n)})}))}const iw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class sw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function ow(e,t,n,r=500,i=600){var s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},iw),{width:r.toString(),height:i.toString(),top:s,left:o});s=sd().toLowerCase();n&&(a=Tv(s)?"_blank":n),bv(s)&&(t=t||"http://localhost",c.scrollbars="yes");var l,o=Object.entries(c).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if([n=sd()]=[s],Av(n)&&null!==(l=window.navigator)&&void 0!==l&&l.standalone&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new sw(null);const u=window.open(t||"",a,o);Vm(u,e,"popup-blocked");try{u.focus()}catch(e){}return new sw(u)}const aw="__/auth/handler",cw="emulator/auth/handler";function lw(e,t,n,r,i,s){Vm(e.config.authDomain,e,"auth-domain-config-required"),Vm(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Rf,eventId:i};if(t instanceof Gv){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",Td(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var[a,c]of Object.entries(s||{}))o[a]=c}if(t instanceof Qv){const u=t.getScopes().filter(e=>""!==e);0<u.length&&(o.scopes=u.join(","))}e.tenantId&&(o.tid=e.tenantId);const l=o;for(const h of Object.keys(l))void 0===l[h]&&delete l[h];return`${e=[e["config"]][0],e.emulator?Qm(e,cw):`https://${e.authDomain}/${aw}`}?${Cd(l).slice(1)}`}const uw="webStorageSupport";const hw=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zy,this._completeRedirectFn=j_}async _openPopup(e,t,n,r){var i;return Bm(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),ow(e,lw(e,t,n,Wm(),r),Gy())}async _openRedirect(e,t,n,r){return await this._originValidation(e),r=lw(e,t,n,Wm(),r),Yy().location.href=r,new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:n}=this.eventManagers[t];return r?Promise.resolve(r):(Bm(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(t){const e=await rw(t),n=new q_(t);return e.register("authEvent",e=>{return Vm(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(n,r){const e=this.iframes[n._key()];e.send(uw,{type:uw},e=>{var t=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t[uw];void 0!==t&&r(!!t),Mm(n,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=H_(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Nv()||Iv()||Av()}};class dw extends class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return qm("unexpected MultiFactorSessionType")}}}{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new dw(e)}_finalizeEnroll(e,t,n){return e=e,n={idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()},ev(e,"POST","/v2/accounts/mfaEnrollment:finalize",Zm(e,n))}_finalizeSignIn(e,t){return e=e,t={mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()},ev(e,"POST","/v2/accounts/mfaSignIn:finalize",Zm(e,t))}}class fw{constructor(){}static assertion(e){return dw._fromCredential(e)}}fw.FACTOR_ID="phone";var pw,gw="@firebase/auth";class mw{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(t){var e;this.assertAuthConfigured(),this.internalListeners.has(t)||(e=this.auth.onIdTokenChanged(e=>{t((null===e||void 0===e?void 0:e.stsTokenManager.accessToken)||null)}),this.internalListeners.set(t,e),this.updateProactiveRefresh())}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Vm(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){0<this.internalListeners.size?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function vw(){return window}pw="Browser",kf(new Wd("auth",(e,{options:n})=>{var t=e.getProvider("app").getImmediate();const{apiKey:r,authDomain:i}=t.options;return(e=>{Vm(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),Vm(!(null!==i&&void 0!==i&&i.includes(":")),"argument-error",{appName:e.name});var t={apiKey:r,authDomain:i,clientPlatform:pw,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rv(pw)},t=new xv(e,t);return function(e,t){const n=(null==t?void 0:t.persistence)||[];var r=(Array.isArray(n)?n:[n]).map(Km);null!=t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(t,n),t})(t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{const r=e.getProvider("auth-internal");r.initialize()})),kf(new Wd("auth-internal",e=>{var t=Pv(e.getProvider("auth").getImmediate());return e=t,new mw(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Of(gw,"0.19.9",function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(pw)),Of(gw,"0.19.9","esm2017");async function yw(e,t,n){var r=vw()["BuildInfo"];Bm(t.sessionId,"AuthEvent did not contain a session ID");var i=await async function(e){const t=function(e){if(Bm(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(e),n=await crypto.subtle.digest("SHA-256",t),r=Array.from(new Uint8Array(n));return r.map(e=>e.toString(16).padStart(2,"0")).join("")}(t.sessionId);const s={};return Av()?s.ibi=r.packageName:Sv()?s.apn=r.packageName:Mm(e,"operation-not-supported-in-this-environment"),r.displayName&&(s.appDisplayName=r.displayName),s.sessionId=i,lw(e,n,t.type,void 0,null!==(i=t.eventId)&&void 0!==i?i:void 0,s)}function _w(r){const i=vw()["cordova"];return new Promise(n=>{i.plugins.browsertab.isAvailable(e=>{let t=null;e?i.plugins.browsertab.openUrl(r):t=i.InAppBrowser.open(r,(e=sd(),/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)?"_blank":"_system"),"location=yes"),n(t)})})}const ww=20;class bw extends q_{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(t){return this.resolveInialized(),this.passiveListeners.forEach(e=>e(t)),super.onEvent(t)}async initialized(){await this.initPromise}}function Iw(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:function(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<ww;r++){var n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}(),postBody:null,tenantId:e.tenantId,error:Lm(e,"no-auth-event")}}async function Tw(e){var t=await Sw()._get(kw(e));return t&&await Sw()._remove(kw(e)),t}function Ew(e,t){var n,r,i;const s=(n=Cw(t=t),o=n.link?decodeURIComponent(n.link):void 0,r=Cw(o).link,i=n.deep_link_id?decodeURIComponent(n.deep_link_id):void 0,(n=Cw(i).link)||i||r||o||t);if(s.includes("/__/auth/callback")){var o=Cw(s),o=o.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(o.firebaseError)):null,o=null===(o=null===(o=null==o?void 0:o.code)||void 0===o?void 0:o.split("auth/"))||void 0===o?void 0:o[1],o=o?Lm(o):null;return o?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:o,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:s,postBody:null}}return null}function Sw(){return Km(Ky)}function kw(e){return yv("authEvent",e.config.apiKey,e.name)}function Cw(e){if(null==e||!e.includes("?"))return{};const[,...t]=e.split("?");return Ad(t.join("?"))}const Aw=class{constructor(){this._redirectPersistence=zy,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=j_}async _initialize(e){var t=e._key();let n=this.eventManagers.get(t);return n||(n=new bw(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Mm(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){var i,s;i=e,a=vw(),Vm("function"==typeof(null===(s=null==a?void 0:a.universalLinks)||void 0===s?void 0:s.subscribe),i,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Vm(void 0!==(null===(s=null==a?void 0:a.BuildInfo)||void 0===s?void 0:s.packageName),i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Vm("function"==typeof(null===(s=null===(s=null===(s=null==a?void 0:a.cordova)||void 0===s?void 0:s.plugins)||void 0===s?void 0:s.browsertab)||void 0===s?void 0:s.openUrl),i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Vm("function"==typeof(null===(s=null===(s=null===(s=null==a?void 0:a.cordova)||void 0===s?void 0:s.plugins)||void 0===s?void 0:s.browsertab)||void 0===s?void 0:s.isAvailable),i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Vm("function"==typeof(null===(a=null===(a=null==a?void 0:a.cordova)||void 0===a?void 0:a.InAppBrowser)||void 0===a?void 0:a.open),i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"});const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),x_.clear(),await this._originValidation(e);var a=Iw(e,n,r);n=e,r=a,await Sw()._set(kw(n),r);a=await _w(await yw(e,a,t));return async function(o,a,c){const l=vw()["cordova"];let u=()=>{};try{await new Promise((n,e)=>{let t=null;function r(){var e;n();const t=null===(e=l.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==c?void 0:c.close)&&c.close()}function i(){t=t||window.setTimeout(()=>{e(Lm(o,"redirect-cancelled-by-user"))},2e3)}function s(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&i()}a.addPassiveListener(r),document.addEventListener("resume",i,!1),Sv()&&document.addEventListener("visibilitychange",s,!1),u=()=>{a.removePassiveListener(r),document.removeEventListener("resume",i,!1),document.removeEventListener("visibilitychange",s,!1),t&&window.clearTimeout(t)}})}finally{u()}}(e,o,a)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){var t=vw()["BuildInfo"];const n={};Av()?n.iosBundleId=t.packageName:Sv()?n.androidPackageName=t.packageName:Mm(e,"operation-not-supported-in-this-environment"),await K_(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(r,i){const{universalLinks:e,handleOpenURL:t,BuildInfo:n}=vw(),s=setTimeout(async()=>{await Tw(r),i.onEvent(Nw())},500),o=async e=>{clearTimeout(s);var t=await Tw(r);let n=null;t&&null!=e&&e.url&&(n=Ew(t,e.url)),i.onEvent(n||Nw())};void 0!==e&&"function"==typeof e.subscribe&&e.subscribe(null,o);const a=t,c=`${n.packageName.toLowerCase()}://`;vw().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}};function Nw(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Lm("no-auth-event")}}var Rw;function xw(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Pw(e=sd()){return!("file:"!==xw()&&"ionic:"!==xw()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Dw(e=sd()){return ud()&&11===(null===document||void 0===document?void 0:document.documentMode)||([e=sd()]=[e],/Edge\/\d+/.test(e))}function Ow(){try{const t=self.localStorage;var e=Gy();if(t)return t.setItem(e,"1"),t.removeItem(e),!Dw()||dd()}catch(e){return Mw()&&dd()}return!1}function Mw(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Lw(){return("http:"===xw()||"https:"===xw()||cd()||Pw())&&!(ld()||ad())&&Ow()&&!Mw()}function Fw(){return Pw()&&"undefined"!=typeof document}const Uw={LOCAL:"local",NONE:"none",SESSION:"session"},jw=Vm,Vw="persistence";async function qw(e){await e._initializationPromise;const t=Bw();var n=yv(Vw,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function Bw(){var e;try{return(null===(e="undefined"!=typeof window?window:null)?void 0:e.sessionStorage)||null}catch(e){return null}}const $w=Vm;class Kw{constructor(){this.browserResolver=Km(hw),this.cordovaResolver=Km(Aw),this.underlyingResolver=null,this._redirectPersistence=zy,this._completeRedirectFn=j_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Fw()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return $w(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){var e;this.underlyingResolver||(e=await(!!Fw()&&new Promise(e=>{const t=setTimeout(()=>{e(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(t),e(!0)})})),this.underlyingResolver=e?this.cordovaResolver:this.browserResolver)}}function Ww(e){return e.unwrap()}function zw(e,t){var n,r,i,s=null===(r=t.customData)||void 0===r?void 0:r._tokenResponse;if("auth/multi-factor-auth-required"===t.code){const a=t;a.resolver=new Yw(e,(n=t,i=Kd(e),Vm((o=n).customData.operationType,i,"argument-error"),Vm(null===(r=o.customData._serverResponse)||void 0===r?void 0:r.mfaPendingCredential,i,"argument-error"),Uy._fromError(i,o)))}else if(s){var o=Hw(t);const c=t;o&&(c.credential=o,c.tenantId=s.tenantId||void 0,c.email=s.email||void 0,c.phoneNumber=s.phoneNumber||void 0)}}function Hw(e){var t=(e instanceof gd?e.customData:e)["_tokenResponse"];if(!t)return null;if(!(e instanceof gd)&&"temporaryProof"in t&&"phoneNumber"in t)return b_.credentialFromResult(e);const n=t.providerId;if(!n||n===Cm.PASSWORD)return null;let r;switch(n){case Cm.GOOGLE:r=Xv;break;case Cm.FACEBOOK:r=Jv;break;case Cm.GITHUB:r=Zv;break;case Cm.TWITTER:r=ny;break;default:var{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=t;return s||o||i||a?a?n.startsWith("saml.")?ey._create(n,a):$v._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:s}):new Yv(n).credential({idToken:i,accessToken:s,rawNonce:c}):null}return e instanceof gd?r.credentialFromError(e):r.credentialFromResult(e)}function Gw(t,e){return e.catch(e=>{throw e instanceof gd&&zw(t,e),e}).then(e=>{var t=e.operationType,n=e.user;return{operationType:t,credential:Hw(e),additionalUserInfo:Ly(e),user:Jw.getOrCreate(n)}})}async function Qw(t,e){const n=await e;return{verificationId:n.verificationId,confirm:e=>Gw(t,n.confirm(e))}}class Yw{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Gw(Ww(this.auth),this.resolver.resolveSignIn(e))}}class Jw{constructor(e){var t;this._delegate=e,this.multiFactor=(t=Kd(e),Vy.has(t)||Vy.set(t,jy._fromUser(t)),Vy.get(t))}static getOrCreate(e){return Jw.USER_MAP.has(e)||Jw.USER_MAP.set(e,new Jw(e)),Jw.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Gw(this.auth,gy(this._delegate,e))}async linkWithPhoneNumber(e,t){return Qw(this.auth,async function(e,t,n){const r=Kd(e);await hy(!1,r,"phone");var i=await w_(r.auth,t,Kd(n));return new __(i,e=>gy(r,e))}(this._delegate,e,t))}async linkWithPopup(e){return Gw(this.auth,async function(e,t,n){var r=Kd(e);Um(r.auth,t,Gv);var i=I_(r.auth,n);const s=new N_(r.auth,"linkViaPopup",t,i,r);return s.executeNotNull()}(this._delegate,e,Kw))}async linkWithRedirect(e){return await qw(Pv(this.auth)),U_(this._delegate,e,Kw)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Gw(this.auth,my(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Qw(this.auth,async function(e,t,n){const r=Kd(e);var i=await w_(r.auth,t,Kd(n));return new __(i,e=>my(r,e))}(this._delegate,e,t))}reauthenticateWithPopup(e){return Gw(this.auth,async function(e,t,n){var r=Kd(e);Um(r.auth,t,Gv);var i=I_(r.auth,n);const s=new N_(r.auth,"reauthViaPopup",t,i,r);return s.executeNotNull()}(this._delegate,e,Kw))}async reauthenticateWithRedirect(e){return await qw(Pv(this.auth)),F_(this._delegate,e,Kw)}sendEmailVerification(e){return ky(this._delegate,e)}async unlink(e){return await ly(this._delegate,e),this}updateEmail(e){return Ny(Kd(this._delegate),e,null)}updatePassword(e){return Ny(Kd(this._delegate),null,e)}updatePhoneNumber(e){return async function(e,t){await uy(Kd(e),t)}(this._delegate,e)}updateProfile(e){return Ay(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Cy(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Jw.USER_MAP=new WeakMap;const Xw=Vm;class Zw{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();var n=e.options["apiKey"];Xw(n,"invalid-api-key",{appName:e.name}),Xw(n,"invalid-api-key",{appName:e.name});var r="undefined"!=typeof window?Kw:void 0;this._delegate=t.initialize({options:{persistence:function(e,t){const n=function(e,t){const n=Bw();if(!n)return[];var r=yv(Vw,e,t);switch(n.getItem(r)){case Uw.NONE:return[vv];case Uw.LOCAL:return[a_,zy];case Uw.SESSION:return[zy];default:return[]}}(e,t);"undefined"==typeof self||n.includes(a_)||n.push(a_);if("undefined"!=typeof window)for(const r of[Ky,zy])n.includes(r)||n.push(r);n.includes(vv)||n.push(vv);return n}(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(Rm),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Jw.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){Ov(this._delegate,e,t)}applyActionCode(e){return Iy(this._delegate,e)}checkActionCode(e){return Ty(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await Uv(Kd(e),{oobCode:t,newPassword:n})}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Gw(this._delegate,async function(e,t,n){const r=Pv(e);var i=await ry(r,{returnSecureToken:!0,email:t,password:n}),i=await iy._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(i.user),i}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Sy(this._delegate,e)}isSignInWithEmailLink(e){return this._delegate,e=e,"EMAIL_SIGNIN"===(null==(t=zv.parseLink(e))?void 0:t.operation);var t}async getRedirectResult(){Xw(Lw(),this._delegate,"operation-not-supported-in-this-environment");var e,t,n=(e=this._delegate,t=Kw,await Pv(e)._initializationPromise,await j_(e,t,!1));return n?Gw(this._delegate,Promise.resolve(n)):{credential:null,user:null}}addFrameworkForLogging(e){Pv(this._delegate)._logFramework(e)}onAuthStateChanged(e,t,n){var{next:r,error:i,complete:s}=eb(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){var{next:r,error:i,complete:s}=eb(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return Ey(this._delegate,e,t)}sendPasswordResetEmail(e,t){return by(this._delegate,e,t||void 0)}async setPersistence(e){var t,n;t=this._delegate,n=e,jw(Object.values(Uw).includes(n),t,"invalid-persistence-type"),ld()?jw(n!==Uw.SESSION,t,"unsupported-persistence-type"):ad()?jw(n===Uw.NONE,t,"unsupported-persistence-type"):Mw()?jw(n===Uw.NONE||n===Uw.LOCAL&&dd(),t,"unsupported-persistence-type"):jw(n===Uw.NONE||Ow(),t,"unsupported-persistence-type");let r;switch(e){case Uw.SESSION:r=zy;break;case Uw.LOCAL:var i=await Km(a_)._isAvailable();r=i?a_:Ky;break;case Uw.NONE:r=vv;break;default:return Mm("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Gw(this._delegate,async function(e){const t=Pv(e);if(await t._initializationPromise,null!==(n=t.currentUser)&&void 0!==n&&n.isAnonymous)return new iy({user:t.currentUser,providerId:null,operationType:"signIn"});var n=await ry(t,{returnSecureToken:!0}),n=await iy._fromIdTokenResponse(t,"signIn",n,!0);return await t._updateCurrentUser(n.user),n}(this._delegate))}signInWithCredential(e){return Gw(this._delegate,py(this._delegate,e))}signInWithCustomToken(e){return Gw(this._delegate,vy(this._delegate,e))}signInWithEmailAndPassword(e,t){return Gw(this._delegate,(n=this._delegate,e=e,t=t,py(Kd(n),Hv.credential(e,t))));var n}signInWithEmailLink(e,t){return Gw(this._delegate,async function(e,t,n){var r=Kd(e),i=Hv.credentialWithLink(t,n||Wm());return Vm(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),py(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Qw(this._delegate,async function(e,t,n){const r=Pv(e);var i=await w_(r,t,Kd(n));return new __(i,e=>py(r,e))}(this._delegate,e,t))}async signInWithPopup(e){return Xw(Lw(),this._delegate,"operation-not-supported-in-this-environment"),Gw(this._delegate,async function(e,t,n){var r=Pv(e);Um(e,t,Gv);var i=I_(r,n);const s=new N_(r,"signInViaPopup",t,i);return s.executeNotNull()}(this._delegate,e,Kw))}async signInWithRedirect(e){return Xw(Lw(),this._delegate,"operation-not-supported-in-this-environment"),await qw(this._delegate),L_(this._delegate,e,Kw)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){var n=(await Ty(Kd(e),t))["data"];return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function eb(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&Jw.getOrCreate(e)),error:t,complete:n}}Zw.Persistence=Uw;class tb{constructor(){this.providerId="phone",this._delegate=new b_(Ww(Xf.auth()))}static credential(e,t){return b_.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}tb.PHONE_SIGN_IN_METHOD=b_.PHONE_SIGN_IN_METHOD,tb.PROVIDER_ID=b_.PROVIDER_ID;const nb=Vm;class rb{constructor(e,t,n=Xf.app()){var r;nb(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new y_(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}(Rw=Xf).INTERNAL.registerComponent(new Wd("auth-compat",e=>{var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new Zw(t,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Am.EMAIL_SIGNIN,PASSWORD_RESET:Am.PASSWORD_RESET,RECOVER_EMAIL:Am.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Am.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Am.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Am.VERIFY_EMAIL}},EmailAuthProvider:Hv,FacebookAuthProvider:Jv,GithubAuthProvider:Zv,GoogleAuthProvider:Xv,OAuthProvider:Yv,SAMLAuthProvider:ty,PhoneAuthProvider:tb,PhoneMultiFactorGenerator:fw,RecaptchaVerifier:rb,TwitterAuthProvider:ny,Auth:Zw,AuthCredential:Fv,Error:gd}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Rw.registerVersion("@firebase/auth-compat","0.2.9");const ib="@firebase/database";let sb="";function ob(e){sb=e}class ab{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_d(t))}get(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:yd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class cb{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return bd(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}var lb,ub,hb,db,fb,pb,yt=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new ab(t)}}catch(e){}return new cb};function gb(e){var t=function(t){const n=[];let r=0;for(let o=0;o<t.length;o++){let e=t.charCodeAt(o);var i,s;55296<=e&&e<=56319&&(i=e-55296,o++,Yh(o<t.length,"Surrogate pair missing trail surrogate."),s=t.charCodeAt(o)-56320,e=65536+(i<<10)+s),e<128?n[r++]=e:(e<2048?n[r++]=e>>6|192:(e<65536?n[r++]=e>>12|224:(n[r++]=e>>18|240,n[r++]=e>>12&63|128),n[r++]=e>>6&63|128),n[r++]=63&e|128)}return n}(e);const n=new Rd;return n.update(t),t=n.digest(),Xh.encodeByteArray(t)}const mb=yt("localStorage"),vb=yt("sessionStorage"),yb=new ef("@firebase/database"),_b=function(){let e=1;return function(){return e++}}(),wb=function(...e){let t="";for(let r=0;r<e.length;r++){var n=e[r];Array.isArray(n)||n&&"object"==typeof n&&"number"==typeof n.length?t+=wb.apply(null,n):t+="object"==typeof n?_d(n):n,t+=" "}return t};let bb=null,Ib=!0;function Tb(t){return function(...e){Rb(t,...e)}}function Eb(...e){var t="FIREBASE INTERNAL ERROR: "+wb(...e);yb.error(t)}function Sb(e,t){return e===t?0:e<t?-1:1}function kb(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+_d(t))}function Cb(e){if("object"!=typeof e||null===e)return _d(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=_d(t[i]),n+=":",n+=Cb(e[t[i]]);return n+="}",n}function Ab(e,t){var n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r}const Nb=function(e,t){Yh(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(yb.logLevel=Kh.VERBOSE,bb=yb.log.bind(yb),t&&vb.set("logging_enabled",!0)):"function"==typeof e?bb=e:(bb=null,vb.remove("logging_enabled"))},Rb=function(...e){var t;!0===Ib&&(Ib=!1,null===bb&&!0===vb.get("logging_enabled")&&Nb(!0)),bb&&(t=wb.apply(null,e),bb(t))},xb=function(...e){var t=`FIREBASE FATAL ERROR: ${wb(...e)}`;throw yb.error(t),new Error(t)},Pb=function(...e){var t="FIREBASE WARNING: "+wb(...e);yb.warn(t)},Db=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Pb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ob=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Mb="[MIN_NAME]",Lb="[MAX_NAME]",Fb=function(e,t){if(e===t)return 0;if(e===Mb||t===Lb)return-1;if(t===Mb||e===Lb)return 1;var n=Kb(e),r=Kb(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null===r&&e<t?-1:1};function Ub(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}function jb(e){Yh(!Ob(e),"Invalid JSON number");let t,n,r,i,s;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,e=Math.abs(e),r=e>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(e/Math.pow(2,-1074))));const o=[];for(s=52;s;--s)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;--s)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();const a=o.join("");let c="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()}function Vb(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n}const qb=new RegExp("^-?(0*)\\d{1,10}$"),Bb=-2147483648,$b=2147483647,Kb=function(e){if(qb.test(e)){var t=Number(e);if(t>=Bb&&t<=$b)return t}return null},Wb=function(e){try{e()}catch(t){setTimeout(()=>{var e=t.stack||"";throw Pb("Exception was thrown by user callback.",e),t},Math.floor(0))}};class zb{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null!=t&&t.get().then(e=>this.appCheck=e)}getToken(n){return this.appCheck?this.appCheck.getToken(n):new Promise((e,t)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(e,t):e(null)},0)})}addTokenChangeListener(t){var e;null!==(e=this.appCheckProvider)&&void 0!==e&&e.get().then(e=>e.addTokenListener(t))}notifyForInvalidToken(){Pb(`Provided AppCheck credentials for the app named "${this.appName_}" `+"are invalid. This usually indicates your app was not initialized correctly.")}}class Hb{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(e=>e&&"auth/token-not-initialized"===e.code?(Rb("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,t)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(e,t):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Pb(e)}}class Gb{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Gb.OWNER="owner";const Qb=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Yb="websocket",Jb="long_polling";class Xb{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mb.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&mb.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Zb(e,t,n){Yh("string"==typeof t,"typeof type must == string"),Yh("object"==typeof n,"typeof params must == object");let r;if(t===Yb)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Jb)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}((t=e).host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams)&&(n.ns=e.namespace);const i=[];return Ub(n,(e,t)=>{i.push(e+"="+t)}),r+i.join("&")}class eI{constructor(){this.counters_={}}incrementCounter(e,t=1){bd(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return nd(void 0,this.counters_)}}const tI={},nI={};function rI(e){var t=e.toString();return tI[t]||(tI[t]=new eI),tI[t]}class iI{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<n.length;++e)n[e]&&Wb(()=>{this.onMessage_(n[e])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class sI{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Tb(e),this.stats_=rI(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),Zb(t,Jb,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new iI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(!this.isClosed_){this.scriptTagHolder=new oI((...e)=>{var[t,n,r]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===t)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,()=>{this.onClosed_()})):this.onClosed_()}},(...e)=>{var[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)},()=>{this.onClosed_()},this.urlFn);const t={start:"t"};t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Qb.test(location.hostname)&&(t.r="f");var e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,()=>{})}})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){sI.forceAllow_=!0}static forceDisallow(){sI.forceDisallow_=!0}static isAvailable(){return!!sI.forceAllow_||!(sI.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){var t=_d(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var t=Zh(t),n=Ab(t,1840);for(let r=0;r<n.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){var t=_d(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class oI{constructor(t,n,e,r){this.onDisconnect=e,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=_b(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=oI.createIFrame_();let e="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(i=document.domain,e='<script>document.domain="'+i+'";<\/script>');var i="<html><body>"+e+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){Rb("frame writing exception"),e.stack&&Rb(e.stack),Rb(e)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||Rb("No IE domain setting required")}catch(e){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++;const i={};i.id=this.myID,i.pw=this.myPW,i.ser=this.currentSerial;var n=this.urlFn(i);let e="",t=0;for(;0<this.pendingSegs.length;){if(!(this.pendingSegs[0].d.length+30+e.length<=1870))break;var r=this.pendingSegs.shift();e=e+"&seg"+t+"="+r.seg+"&ts"+t+"="+r.ts+"&d"+t+"="+r.d,t++}return n+=e,this.addLongPollTag_(n,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),n()})}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const t=this.myIFrame.doc.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){var e=t.readyState;e&&"loaded"!==e&&"complete"!==e||(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),n())},t.onerror=()=>{Rb("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(t)}catch(e){}},Math.floor(1))}}let aI=null;"undefined"!=typeof MozWebSocket?aI=MozWebSocket:"undefined"!=typeof WebSocket&&(aI=WebSocket);class cI{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Tb(this.connId),this.stats_=rI(t),this.connURL=cI.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&Qb.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),Zb(e,Yb,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mb.set("previous_websocket_failure",!0);try{hd()||(n={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}},this.mySock=new aI(this.connURL,[],n))}catch(e){this.log_("Error instantiating WebSocket.");var n=e.message||e.data;return n&&this.log_(n),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){cI.forceDisallow_=!0}static isAvailable(){let e=!1;var t;return"undefined"==typeof navigator||!navigator.userAgent||(t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/))&&1<t.length&&parseFloat(t[1])<4.4&&(e=!0),!e&&null!==aI&&!cI.forceDisallow_}static previouslyFailed(){return mb.isInMemoryStorage||!0===mb.get("previous_websocket_failure")}markConnectionHealthy(){mb.remove("previous_websocket_failure")}appendFrame_(e){var t;this.frames.push(e),this.frames.length===this.totalFrames&&(t=this.frames.join(""),this.frames=null,t=yd(t),this.onMessage(t))}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Yh(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){var t;null!==this.mySock&&(t=e.data,this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames?this.appendFrame_(t):null!==(t=this.extractFrameCount_(t))&&this.appendFrame_(t))}send(e){this.resetKeepAlive();var t=_d(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=Ab(t,16384);1<n.length&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}cI.responsesRequiredToBeHealthy=2,cI.healthyTimeout=3e4;class lI{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[sI,cI]}initTransports_(e){var t=cI&&cI.isAvailable();let n=t&&!cI.previouslyFailed();if(e.webSocketOnly&&(t||Pb("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[cI];else{const r=this.transports_=[];for(const i of lI.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i)}}initialTransport(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return 1<this.transports_.length?this.transports_[1]:null}}class uI{constructor(e,t,n,r,i,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Tb("c:"+this.id+":"),this.transportManager_=new lI(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));var r=e.healthyTimeout||0;0<r&&(this.healthyTimeout_=Vb(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&102400<this.conn_.bytesReceived?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&10240<this.conn_.bytesSent?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){var t;"t"in e&&("a"===(t=e.t)?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_()))}onSecondaryMessageReceived_(e){var t=kb("t",e),n=kb("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){var t=kb("t",e),n=kb("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){var t=kb("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Eb("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Eb("Unknown control packet command: "+t)}}onHandshake_(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Pb("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Vb(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vb(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mb.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class hI{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class dI{constructor(e){this.allowedEvents_=e,this.listeners_={},Yh(Array.isArray(e)&&0<e.length,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const r=[...this.listeners_[t]];for(let e=0;e<r.length;e++)r[e].callback.apply(r[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(t){Yh(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class fI extends dI{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||od()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new fI}getInitialEvent(e){return Yh("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class pI{constructor(n,e){if(void 0===e){this.pieces_=n.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)0<this.pieces_[t].length&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=e}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function gI(){return new pI("")}function mI(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function vI(e){return e.pieces_.length-e.pieceNum_}function yI(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new pI(e.pieces_,t)}function _I(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function wI(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function bI(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new pI(t,0)}function II(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof pI)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{var r=t.split("/");for(let e=0;e<r.length;e++)0<r[e].length&&n.push(r[e])}return new pI(n,0)}function TI(e){return e.pieceNum_>=e.pieces_.length}function EI(e,t){var n=mI(e),r=mI(t);if(null===n)return t;if(n===r)return EI(yI(e),yI(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function SI(e,t){var n=wI(e,0),r=wI(t,0);for(let s=0;s<n.length&&s<r.length;s++){var i=Fb(n[s],r[s]);if(0!==i)return i}return n.length===r.length?0:n.length<r.length?-1:1}function kI(e,t){if(vI(e)!==vI(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function CI(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(vI(e)>vI(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class AI{constructor(e,t){this.errorPrefix_=t,this.parts_=wI(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Ud(this.parts_[n]);NI(this)}}function NI(e){if(768<e.byteLength_)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(32<e.parts_.length)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+RI(e))}function RI(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class xI extends dI{constructor(){super(["visible"]);let t,e;"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{var e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))},!1)}static getInstance(){return new xI}getInitialEvent(e){return Yh("visible"===e,"Unknown event type: "+e),[this.visible_]}}class PI extends hI{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=PI.nextPersistentConnectionId_++,this.log_=Tb("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=1e3,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!hd())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");xI.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&fI.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(_d(i)),Yh(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const n=new rd,r={p:e._path.toString(),q:e._queryObject},t={action:"g",request:r,onComplete:e=>{var t=e.d;"ok"===e.s?(this.onDataUpdate_(r.p,t,!1,null),n.resolve(t)):n.reject(t)}};this.outstandingGets_.push(t),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{var e=this.outstandingGets_[i];void 0!==e&&t===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(i),n.promise}listen(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Yh(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Yh(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(t){const n=this.outstandingGets_[t];this.sendRequest("g",n.request,e=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(e)})}sendListen_(r){const i=r.query,s=i._path.toString(),o=i._queryIdentifier;this.log_("Listen on "+s+" for "+o);const e={p:s};r.tag&&(e.q=i._queryObject,e.t=r.tag),e.h=r.hashFn(),this.sendRequest("q",e,e=>{var t=e.d,n=e.s;PI.warnOnListenWarnings_(t,i),(this.listens.get(s)&&this.listens.get(s).get(o))===r&&(this.log_("listen response",e),"ok"!==n&&this.removeListen_(s,o),r.onComplete&&r.onComplete(n,t))})}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&bd(e,"w")){const i=Id(e,"w");var n,r;Array.isArray(i)&&~i.indexOf("no_index")&&(n='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString(),Pb("Using an unspecified index. Your data will be downloaded and "+`filtered on the client. Consider adding ${n} at `+`${r} to your security rules for better performance.`))}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){var t;(e&&40===e.length||(e=e,"object"==typeof(t=wd(e).claims)&&!0===t.admin))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const r=this.authToken_;var e=function(e){const t=wd(e),n=t.claims;return!!n&&"object"==typeof n&&n.hasOwnProperty("iat")}(r)?"auth":"gauth";const t={cred:r};null===this.authOverride_?t.noauth=!0:"object"==typeof this.authOverride_&&(t.authvar=this.authOverride_),this.sendRequest(e,t,e=>{var t=e.s,n=e.d||"error";this.authToken_===r&&("ok"===t?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(t,n))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{var t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Yh(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,e=>{r&&setTimeout(()=>{r(e.s,e.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(t){const n=this.outstandingPuts_[t].action;var e=this.outstandingPuts_[t].request;const r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,e,e=>{this.log_(n+" response",e),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(e.s,e.d)})}reportStats(e){var t;this.connected_&&(this.log_("reportStats",t={c:e}),this.sendRequest("s",t,e=>{var t;"ok"!==e.s&&(t=e.d,this.log_("reportStats","Error sending stats: "+t))}))}onDataMessage_(e){if("r"in e){this.log_("from server: "+_d(e));var t=e.r;const n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Eb("Unrecognized action received from server: "+_d(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Yh(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){var e;this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()&&(this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime()),e=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-e),e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)),this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this);const u=this.onRealtimeDisconnect_.bind(this);var i=this.id+":"+PI.nextConnectionId_++,s=this.lastSessionId;let t=!1,n=null;var o=function(){n?n.close():(t=!0,u())};this.realtime_={close:o,sendRequest:function(e){Yh(n,"sendRequest call when we're not connected not allowed."),n.sendRequest(e)}};var a=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{var[c,l]=await Promise.all([this.authTokenProvider_.getToken(a),this.appCheckTokenProvider_.getToken(a)]);t?Rb("getToken() completed but was canceled"):(Rb("getToken() completed. Creating connection."),this.authToken_=c&&c.accessToken,this.appCheckToken_=l&&l.token,n=new uI(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,r,u,e=>{Pb(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},s))}catch(e){this.log_("Failed to get token: "+e),t||(this.repoInfo_.nodeAdmin&&Pb(e),o())}}}interrupt(e){Rb("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Rb("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Td(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>Cb(e)).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){var n=new pI(e).toString();let r;if(this.listens.has(n)){const i=this.listens.get(n);r=i.get(t),i.delete(t),0===i.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Rb("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Rb("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,3<=this.invalidAppCheckTokenCount_&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const n of t.values())this.sendListen_(n);for(let r=0;r<this.outstandingPuts_.length;r++)this.outstandingPuts_[r]&&this.sendPut_(r);for(;this.onDisconnectRequestQueue_.length;){var e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let i=0;i<this.outstandingGets_.length;i++)this.outstandingGets_[i]&&this.sendGet_(i)}sendConnectStats_(){const e={};e["sdk.js."+sb.replace(/\./g,"-")]=1,od()?e["framework.cordova"]=1:ld()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){var e=fI.getInstance().currentlyOnline();return Td(this.interruptReasons_)&&e}}PI.nextPersistentConnectionId_=0,PI.nextConnectionId_=0;class DI{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new DI(e,t)}}class OI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){var n=new DI(Mb,e),r=new DI(Mb,t);return 0!==this.compare(n,r)}minPost(){return DI.MIN}}let MI;class LI extends OI{static get __EMPTY_NODE(){return MI}static set __EMPTY_NODE(e){MI=e}compare(e,t){return Fb(e.name,t.name)}isDefinedOn(e){throw Jh("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return DI.MIN}maxPost(){return new DI(Lb,MI)}makePost(e,t){return Yh("string"==typeof e,"KeyIndex indexValue must always be a string."),new DI(e,MI)}toString(){return".key"}}const FI=new LI;class UI{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e=this.nodeStack_.pop(),t;if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return 0<this.nodeStack_.length}peek(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class jI{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:jI.RED,this.left=null!=r?r:VI.EMPTY_NODE,this.right=null!=i?i:VI.EMPTY_NODE}copy(e,t,n,r,i){return new jI(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;var i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return VI.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return VI.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){var e=this.copy(null,null,jI.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){var e=this.copy(null,null,jI.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}jI.RED=!0,jI.BLACK=!1;class VI{constructor(e,t=VI.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new VI(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,jI.BLACK,null,null))}remove(e){return new VI(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,jI.BLACK,null,null))}get(e){var t;let n=this.root_;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:0<t&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:0<t&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new UI(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new UI(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new UI(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new UI(this.root_,null,this.comparator_,!0,e)}}function qI(e,t){return Fb(e.name,t.name)}function BI(e,t){return Fb(e,t)}VI.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new jI(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};let $I;function KI(e){return"number"==typeof e?"number:"+jb(e):"string:"+e}function WI(e){var t;e.isLeafNode()?(t=e.val(),Yh("string"==typeof t||"number"==typeof t||"object"==typeof t&&bd(t,".sv"),"Priority must be a string or number.")):Yh(e===$I||e.isEmpty(),"priority of unexpected type."),Yh(e===$I||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}let zI;class HI{constructor(e,t=HI.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Yh(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),WI(this.priorityNode_)}static set __childrenNodeConstructor(e){zI=e}static get __childrenNodeConstructor(){return zI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new HI(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:HI.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return TI(e)?this:".priority"===mI(e)?this.priorityNode_:HI.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:HI.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){var n=mI(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Yh(".priority"!==n||1===vI(e),".priority must be the last token in a path"),this.updateImmediateChild(n,HI.__childrenNodeConstructor.EMPTY_NODE.updateChild(yI(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+KI(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"==t?jb(this.value_):this.value_,this.lazyHash_=gb(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===HI.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof HI.__childrenNodeConstructor?-1:(Yh(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){var t=typeof e.value_,n=typeof this.value_,r=HI.VALUE_TYPE_ORDER.indexOf(t),i=HI.VALUE_TYPE_ORDER.indexOf(n);return Yh(0<=r,"Unknown leaf type: "+t),Yh(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))}}HI.VALUE_TYPE_ORDER=["object","boolean","number","string"];let GI,QI;const YI=new class extends OI{compare(e,t){const n=e.node.getPriority();var r=t.node.getPriority(),r=n.compareTo(r);return 0===r?Fb(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return DI.MIN}maxPost(){return new DI(Lb,new HI("[PRIORITY-POST]",QI))}makePost(e,t){var n=GI(e);return new DI(t,new HI("[PRIORITY-POST]",n))}toString(){return".priority"}},JI=Math.log(2);class XI{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/JI,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}nextBitIsOne(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}function ZI(c,e,l,t){c.sort(e);const u=function(e,t){var n=t-e;let r,i;if(0==n)return null;if(1==n)return r=c[e],i=l?l(r):r,new jI(i,r.node,jI.BLACK,null,null);var s=parseInt(n/2,10)+e,o=u(e,s),n=u(s+1,t);return r=c[s],i=l?l(r):r,new jI(i,r.node,jI.BLACK,o,n)};var n=function(e){let s=null,o=null,a=c.length;function t(e,t){var n=a-e,r=a;a-=e;var i=u(1+n,r),r=c[n],n=l?l(r):r;!function(e){if(s){s.left=e;s=e}else{o=e;s=e}}(new jI(n,r.node,t,null,i))}for(let i=0;i<e.count;++i){var n=e.nextBitIsOne(),r=Math.pow(2,e.count-(i+1));n?t(r,jI.BLACK):(t(r,jI.BLACK),t(r,jI.RED))}return o}(new XI(c.length));return new VI(t||e,n)}let e0;const t0={};class n0{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Yh((t0,YI),"ChildrenNode.ts has not been loaded"),e0=e0||new n0({".priority":t0},{".priority":YI}),e0}get(e){var t=Id(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof VI?t:null}hasIndex(e){return bd(this.indexSet_,e.toString())}addIndex(e,t){Yh(e!==FI,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(DI.Wrap);let s=i.getNext();for(;s;)r=r||e.isDefinedOn(s.node),n.push(s),s=i.getNext();let o;o=r?ZI(n,e.getCompare()):t0;var a=e.toString();const c=Object.assign({},this.indexSet_);c[a]=e;const l=Object.assign({},this.indexes_);return l[a]=o,new n0(l,c)}addToIndexes(o,a){var e=Ed(this.indexes_,(t,e)=>{const n=Id(this.indexSet_,e);if(Yh(n,"Missing index implementation for "+e),t===t0){if(n.isDefinedOn(o.node)){const i=[],s=a.getIterator(DI.Wrap);let e=s.getNext();for(;e;)e.name!==o.name&&i.push(e),e=s.getNext();return i.push(o),ZI(i,n.getCompare())}return t0}{var r=a.get(o.name);let e=t;return r&&(e=e.remove(new DI(o.name,r))),e.insert(o,o.node)}});return new n0(e,this.indexSet_)}removeFromIndexes(n,r){var e=Ed(this.indexes_,e=>{if(e===t0)return e;var t=r.get(n.name);return t?e.remove(new DI(n.name,t)):e});return new n0(e,this.indexSet_)}}let r0;class i0{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&WI(this.priorityNode_),this.children_.isEmpty()&&Yh(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return r0=r0||new i0(new VI(BI),null,n0.Default)}isLeafNode(){return!1}getPriority(){return this.priorityNode_||r0}updatePriority(e){return this.children_.isEmpty()?this:new i0(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?r0:t}getChild(e){var t=mI(e);return null===t?this:this.getImmediateChild(t).getChild(yI(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(n,r){if(Yh(r,"We should always be passing snapshot nodes"),".priority"===n)return this.updatePriority(r);{var i=new DI(n,r);let e,t;t=r.isEmpty()?(e=this.children_.remove(n),this.indexMap_.removeFromIndexes(i,this.children_)):(e=this.children_.insert(n,r),this.indexMap_.addToIndexes(i,this.children_));i=e.isEmpty()?r0:this.priorityNode_;return new i0(e,i,t)}}updateChild(e,t){var n=mI(e);if(null===n)return t;Yh(".priority"!==mI(e)||1===vI(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(yI(e),t);return this.updateImmediateChild(n,r)}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(YI,(e,t)=>{r[e]=t.val(n),i++,o&&i0.INTEGER_REGEXP_.test(e)?s=Math.max(s,Number(e)):o=!1}),!n&&o&&s<2*i){const e=[];for(const t in r)e[t]=r[t];return e}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let r="";this.getPriority().isEmpty()||(r+="priority:"+KI(this.getPriority().val())+":"),this.forEachChild(YI,(e,t)=>{var n=t.hash();""!==n&&(r+=":"+e+":"+n)}),this.lazyHash_=""===r?"":gb(r)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new DI(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}getFirstChild(e){var t=this.getFirstChildName(e);return t?new DI(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}getLastChild(e){var t=this.getLastChildName(e);return t?new DI(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(t,n){const e=this.resolveIndex_(n);if(e)return e.getIteratorFrom(t,e=>e);{const r=this.children_.getIteratorFrom(t.name,DI.Wrap);let e=r.peek();for(;null!=e&&n.compare(e,t)<0;)r.getNext(),e=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(t,n){const e=this.resolveIndex_(n);if(e)return e.getReverseIteratorFrom(t,e=>e);{const r=this.children_.getReverseIteratorFrom(t.name,DI.Wrap);let e=r.peek();for(;null!=e&&0<n.compare(e,t);)r.getNext(),e=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===o0?-1:0}withIndex(e){if(e===FI||this.indexMap_.hasIndex(e))return this;var t=this.indexMap_.addIndex(e,this.children_);return new i0(this.children_,this.priorityNode_,t)}isIndexed(e){return e===FI||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority())){if(this.children_.count()!==n.children_.count())return!1;{const r=this.getIterator(YI),i=n.getIterator(YI);let e=r.getNext(),t=i.getNext();for(;e&&t;){if(e.name!==t.name||!e.node.equals(t.node))return!1;e=r.getNext(),t=i.getNext()}return null===e&&null===t}}return!1}}resolveIndex_(e){return e===FI?null:this.indexMap_.get(e.toString())}}i0.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class s0 extends i0{constructor(){super(new VI(BI),i0.EMPTY_NODE,n0.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return i0.EMPTY_NODE}isEmpty(){return!1}}const o0=new s0;Object.defineProperties(DI,{MIN:{value:new DI(Mb,i0.EMPTY_NODE)},MAX:{value:new DI(Lb,o0)}}),LI.__EMPTY_NODE=i0.EMPTY_NODE,HI.__childrenNodeConstructor=i0,lb=o0,$I=lb,ub=o0,QI=ub;const a0=!0;function c0(i,e=null){if(null===i)return i0.EMPTY_NODE;if("object"==typeof i&&".priority"in i&&(e=i[".priority"]),Yh(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"!=typeof(i="object"==typeof i&&".value"in i&&null!==i[".value"]?i[".value"]:i)||".sv"in i){var t=i;return new HI(t,c0(e))}if(i instanceof Array||!a0){let r=i0.EMPTY_NODE;return Ub(i,(e,t)=>{if(bd(i,e)&&"."!==e.substring(0,1)){const n=c0(t);!n.isLeafNode()&&n.isEmpty()||(r=r.updateImmediateChild(e,n))}}),r.updatePriority(c0(e))}{const s=[];let r=!1;if(Ub(i,(e,t)=>{if("."!==e.substring(0,1)){const n=c0(t);n.isEmpty()||(r=r||!n.getPriority().isEmpty(),s.push(new DI(e,n)))}}),0===s.length)return i0.EMPTY_NODE;var n=ZI(s,qI,e=>e.name,BI);if(r){t=ZI(s,YI.getCompare());return new i0(n,c0(e),new n0({".priority":t},{".priority":YI}))}return new i0(n,c0(e),n0.Default)}}GI=c0;class l0 extends OI{constructor(e){super(),this.indexPath_=e,Yh(!TI(e)&&".priority"!==mI(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node);var r=this.extractChild(t.node),r=n.compareTo(r);return 0===r?Fb(e.name,t.name):r}makePost(e,t){var n=c0(e),n=i0.EMPTY_NODE.updateChild(this.indexPath_,n);return new DI(t,n)}maxPost(){var e=i0.EMPTY_NODE.updateChild(this.indexPath_,o0);return new DI(Lb,e)}toString(){return wI(this.indexPath_,0).join("/")}}function u0(e){if(e===""+$b)return p0;var t=Kb(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e.charAt(i);if(n.length<m0)return n.push(p0),n.join("");let r=n.length-1;for(;0<=r&&n[r]===g0;)r--;return-1===r?Lb:(t=n[r],t=f0.charAt(f0.indexOf(t)+1),n[r]=t,n.slice(0,r+1).join(""))}function h0(e){if(e===""+Bb)return Mb;var t=Kb(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e.charAt(r);return n[n.length-1]===p0?1===n.length?""+$b:(delete n[n.length-1],n.join("")):(n[n.length-1]=f0.charAt(f0.indexOf(n[n.length-1])-1),n.join("")+g0.repeat(m0-n.length))}const d0=new class extends OI{compare(e,t){var n=e.node.compareTo(t.node);return 0===n?Fb(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return DI.MIN}maxPost(){return DI.MAX}makePost(e,t){var n=c0(e);return new DI(t,n)}toString(){return".value"}},f0="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",p0="-",g0="z",m0=786,v0=function(){let s=0;const o=[];return function(e){var t=e===s;s=e;let n;const r=new Array(8);for(n=7;0<=n;n--)r[n]=f0.charAt(e%64),e=Math.floor(e/64);Yh(0===e,"Cannot push at time == 0");let i=r.join("");if(t){for(n=11;0<=n&&63===o[n];n--)o[n]=0;o[n]++}else for(n=0;n<12;n++)o[n]=Math.floor(64*Math.random());for(n=0;n<12;n++)i+=f0.charAt(o[n]);return Yh(20===i.length,"nextPushId: Length should be 20."),i}}();function y0(e){return{type:"value",snapshotNode:e}}function _0(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function w0(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function b0(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class I0{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){Yh(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(w0(t,o)):Yh(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(_0(t,n)):s.trackChildChange(b0(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(YI,(e,t)=>{n.hasChild(e)||i.trackChildChange(w0(e,t))}),n.isLeafNode()||n.forEachChild(YI,(e,t)=>{if(r.hasChild(e)){const n=r.getImmediateChild(e);n.equals(t)||i.trackChildChange(b0(e,t,n))}else i.trackChildChange(_0(e,t))})),n.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?i0.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class T0{constructor(e){this.indexedFilter_=new I0(e.getIndex()),this.index_=e.getIndex(),this.startPost_=T0.getStartPost_(e),this.endPost_=T0.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,s){return this.matches(new DI(t,n))||(n=i0.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){let r=(t=t.isLeafNode()?i0.EMPTY_NODE:t).withIndex(this.index_);r=r.updatePriority(i0.EMPTY_NODE);const i=this;return t.forEachChild(YI,(e,t)=>{i.matches(new DI(e,t))||(r=r.updateImmediateChild(e,i0.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class E0{constructor(e){this.rangedFilter_=new T0(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new DI(t,n))||(n=i0.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,o,t){let a;if(o.isLeafNode()||o.isEmpty())a=i0.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<o.numChildren()&&o.isIndexed(this.index_)){a=i0.EMPTY_NODE.withIndex(this.index_);let t;t=this.reverse_?o.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;t.hasNext()&&n<this.limit_;){var r=t.getNext();let e;if(e=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),r)<=0:this.index_.compare(r,this.rangedFilter_.getEndPost())<=0,!e)break;a=a.updateImmediateChild(r.name,r.node),n++}}else{a=o.withIndex(this.index_),a=a.updatePriority(i0.EMPTY_NODE);let e,t,n,r;if(this.reverse_){r=a.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),t=this.rangedFilter_.getStartPost();const l=this.index_.getCompare();n=(e,t)=>l(t,e)}else r=a.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),t=this.rangedFilter_.getEndPost(),n=this.index_.getCompare();let i=0,s=!1;for(;r.hasNext();){var c=r.getNext();!s&&n(e,c)<=0&&(s=!0),s&&i<this.limit_&&n(c,t)<=0?i++:a=a.updateImmediateChild(c.name,i0.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,a,t)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const d=this.index_.getCompare();s=(e,t)=>d(t,e)}else s=this.index_.getCompare();const o=e;Yh(o.numChildren()===this.limit_,"");var a=new DI(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),l=this.rangedFilter_.matches(a);if(o.hasChild(t)){var u=o.getImmediateChild(t);let e=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=e&&(e.name===t||o.hasChild(e.name));)e=r.getChildAfterChild(this.index_,e,this.reverse_);var h=null==e?1:s(e,a);if(l&&!n.isEmpty()&&0<=h)return null!=i&&i.trackChildChange(b0(t,n,u)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(w0(t,u));const f=o.updateImmediateChild(t,i0.EMPTY_NODE);return null!=e&&this.rangedFilter_.matches(e)?(null!=i&&i.trackChildChange(_0(e.name,e.node)),f.updateImmediateChild(e.name,e.node)):f}}return!n.isEmpty()&&l&&0<=s(c,a)?(null!=i&&(i.trackChildChange(w0(c.name,c.node)),i.trackChildChange(_0(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,i0.EMPTY_NODE)):e}}class S0{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=YI}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Yh(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Yh(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Mb}hasEnd(){return this.endSet_}getIndexEndValue(){return Yh(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Yh(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Lb}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Yh(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===YI}copy(){const e=new S0;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function k0(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function C0(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function A0(e,t){const n=e.copy();return n.index_=t,n}function N0(e){const t={};if(e.isDefault())return t;let n;return n=e.index_===YI?"$priority":e.index_===d0?"$value":e.index_===FI?"$key":(Yh(e.index_ instanceof l0,"Unrecognized index type!"),e.index_.toString()),t.orderBy=_d(n),e.startSet_&&(t.startAt=_d(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+_d(e.indexStartName_))),e.endSet_&&(t.endAt=_d(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+_d(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function R0(t){const n={};if(t.startSet_&&(n.sp=t.indexStartValue_,t.startNameSet_&&(n.sn=t.indexStartName_)),t.endSet_&&(n.ep=t.indexEndValue_,t.endNameSet_&&(n.en=t.indexEndName_)),t.limitSet_){n.l=t.limit_;let e=t.viewFrom_;""===e&&(e=t.isViewFromLeft()?"l":"r"),n.vf=e}return t.index_!==YI&&(n.i=t.index_.toString()),n}class x0 extends hI{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Tb("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Yh(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=x0.getListenId_(e,r),a={};this.listens_[o]=a;var n=N0(e._queryParams);this.restRequest_(s+".json",n,(t,e)=>{let n=e;if(null===(t=404===t?n=null:t)&&this.onDataUpdate_(s,n,!1,r),Id(this.listens_,o)===a){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",i(e,null)}})}unlisten(e,t){var n=x0.getListenId_(e,t);delete this.listens_[n]}get(e){var t=N0(e._queryParams);const r=e._path.toString(),i=new rd;return this.restRequest_(r+".json",t,(e,t)=>{let n=t;null===(e=404===e?n=null:e)?(this.onDataUpdate_(r,n,!1,null),i.resolve(n)):i.reject(new Error(n))}),i.promise}refreshAuthToken(e){}restRequest_(i,s={},o){return s.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([e,t])=>{e&&e.accessToken&&(s.auth=e.accessToken),t&&t.token&&(s.ac=t.token);const n=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+i+"?ns="+this.repoInfo_.namespace+Cd(s);this.log_("Sending REST request for "+n);const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(o&&4===r.readyState){this.log_("REST Response for "+n+" received. status:",r.status,"response:",r.responseText);let e=null;if(200<=r.status&&r.status<300){try{e=yd(r.responseText)}catch(e){Pb("Failed to parse JSON response for "+n+": "+r.responseText)}o(null,e)}else 401!==r.status&&404!==r.status&&Pb("Got unsuccessful REST response for "+n+" Status: "+r.status),o(r.status);o=null}},r.open("GET",n,!0),r.send()})}}class P0{constructor(){this.rootNode_=i0.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function D0(){return{value:null,children:new Map}}function O0(e,t,n){var r;TI(t)?(e.value=n,e.children.clear()):null!==e.value?e.value=e.value.updateChild(t,n):(r=mI(t),e.children.has(r)||e.children.set(r,D0()),O0(e.children.get(r),t=yI(t),n))}function M0(e,n,r){var i;null!==e.value?r(n,e.value):(i=(e,t)=>{M0(t,new pI(n.toString()+"/"+e),r)},e.children.forEach((e,t)=>{i(t,e)}))}class L0{constructor(e){this.collection_=e,this.last_=null}get(){var e=this.collection_.get();const n=Object.assign({},e);return this.last_&&Ub(this.last_,(e,t)=>{n[e]=n[e]-t}),this.last_=e,n}}class F0{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new L0(e);var n=1e4+2e4*Math.random();Vb(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){var e=this.statsListener_.get();const n={};let r=!1;Ub(e,(e,t)=>{0<t&&bd(this.statsToReport_,e)&&(n[e]=t,r=!0)}),r&&this.server_.reportStats(n),Vb(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}function U0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function j0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function V0(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(z=hb=hb||{})[z.OVERWRITE=0]="OVERWRITE",z[z.MERGE=1]="MERGE",z[z.ACK_USER_WRITE=2]="ACK_USER_WRITE",z[z.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class q0{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=hb.ACK_USER_WRITE,this.source=U0()}operationForChild(e){if(TI(this.path)){if(null!=this.affectedTree.value)return Yh(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var t=this.affectedTree.subtree(new pI(e));return new q0(gI(),t,this.revert)}return Yh(mI(this.path)===e,"operationForChild called for unrelated child."),new q0(yI(this.path),this.affectedTree,this.revert)}}class B0{constructor(e,t){this.source=e,this.path=t,this.type=hb.LISTEN_COMPLETE}operationForChild(e){return TI(this.path)?new B0(this.source,gI()):new B0(this.source,yI(this.path))}}class $0{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=hb.OVERWRITE}operationForChild(e){return TI(this.path)?new $0(this.source,gI(),this.snap.getImmediateChild(e)):new $0(this.source,yI(this.path),this.snap)}}class K0{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=hb.MERGE}operationForChild(e){if(TI(this.path)){const t=this.children.subtree(new pI(e));return t.isEmpty()?null:t.value?new $0(this.source,gI(),t.value):new K0(this.source,gI(),t)}return Yh(mI(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new K0(this.source,yI(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class W0{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(TI(e))return this.isFullyInitialized()&&!this.filtered_;var t=mI(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class z0{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function H0(n,e,t,r){var i=[];const s=[];return e.forEach(e=>{var t;"child_changed"===e.type&&n.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&s.push((t=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:t}))}),G0(n,i,"child_removed",e,r,t),G0(n,i,"child_added",e,r,t),G0(n,i,"child_moved",s,r,t),G0(n,i,"child_changed",e,r,t),G0(n,i,"value",e,r,t),i}function G0(s,o,t,e,a,c){const n=e.filter(e=>e.type===t);n.sort((e,t)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Jh("Should only compare child_ events.");var r=new DI(t.childName,t.snapshotNode),i=new DI(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(s,e,t)),n.forEach(t=>{const n=(e=s,i=c,"value"===(r=t).type||"child_removed"===r.type||(r.prevName=i.getPredecessorChildName(r.childName,r.snapshotNode,e.index_)),r);var e,r,i;a.forEach(e=>{e.respondsTo(t.type)&&o.push(e.createEvent(n,s.query_))})})}function Q0(e,t){return{eventCache:e,serverCache:t}}function Y0(e,t,n,r){return Q0(new W0(t,n,r),e.serverCache)}function J0(e,t,n,r){return Q0(e.eventCache,new W0(t,n,r))}function X0(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Z0(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let eT;class tT{constructor(e,t=(eT=eT||new VI(Sb),eT)){this.value=e,this.children=t}static fromObject(e){let n=new tT(null);return Ub(e,(e,t)=>{n=n.set(new pI(e),t)}),n}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:gI(),value:this.value};if(TI(e))return null;{var n=mI(e);const i=this.children.get(n);if(null===i)return null;var r=i.findRootMostMatchingPathAndValue(yI(e),t);return null==r?null:{path:II(new pI(n),r.path),value:r.value}}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(TI(e))return this;{var t=mI(e);const n=this.children.get(t);return null!==n?n.subtree(yI(e)):new tT(null)}}set(e,t){if(TI(e))return new tT(t,this.children);{var n=mI(e);const i=this.children.get(n)||new tT(null);var r=i.set(yI(e),t),r=this.children.insert(n,r);return new tT(this.value,r)}}remove(t){if(TI(t))return this.children.isEmpty()?new tT(null):new tT(null,this.children);{var n=mI(t);const r=this.children.get(n);if(r){const i=r.remove(yI(t));let e;return e=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&e.isEmpty()?new tT(null):new tT(this.value,e)}return this}}get(e){if(TI(e))return this.value;{var t=mI(e);const n=this.children.get(t);return n?n.get(yI(e)):null}}setTree(t,n){if(TI(t))return n;{var r=mI(t);const i=this.children.get(r)||new tT(null),s=i.setTree(yI(t),n);let e;return e=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new tT(this.value,e)}}fold(e){return this.fold_(gI(),e)}fold_(n,r){const i={};return this.children.inorderTraversal((e,t)=>{i[e]=t.fold_(II(n,e),r)}),r(n,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,gI(),t)}findOnPath_(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(TI(e))return null;{r=mI(e);const i=this.children.get(r);return i?i.findOnPath_(yI(e),II(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,gI(),t)}foreachOnPath_(e,t,n){if(TI(e))return this;{this.value&&n(t,this.value);var r=mI(e);const i=this.children.get(r);return i?i.foreachOnPath_(yI(e),II(t,r),n):new tT(null)}}foreach(e){this.foreach_(gI(),e)}foreach_(n,r){this.children.inorderTraversal((e,t)=>{t.foreach_(II(n,e),r)}),this.value&&r(n,this.value)}foreachChild(n){this.children.inorderTraversal((e,t)=>{t.value&&n(e,t.value)})}}class nT{constructor(e){this.writeTree_=e}static empty(){return new nT(new tT(null))}}function rT(t,n,r){if(TI(n))return new nT(new tT(r));var i=t.writeTree_.findRootMostValueAndPath(n);if(null!=i){var s=i.path;let e=i.value;i=EI(s,n);return e=e.updateChild(i,r),new nT(t.writeTree_.set(s,e))}s=new tT(r),s=t.writeTree_.setTree(n,s);return new nT(s)}function iT(e,n,t){let r=e;return Ub(t,(e,t)=>{r=rT(r,II(n,e),t)}),r}function sT(e,t){if(TI(t))return nT.empty();var n=e.writeTree_.setTree(t,new tT(null));return new nT(n)}function oT(e,t){return null!=aT(e,t)}function aT(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(EI(n.path,t)):null}function cT(e){const n=[],t=e.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(YI,(e,t)=>{n.push(new DI(e,t))}):e.writeTree_.children.inorderTraversal((e,t)=>{null!=t.value&&n.push(new DI(e,t.value))}),n}function lT(e,t){if(TI(t))return e;var n=aT(e,t);return null!=n?new nT(new tT(n)):new nT(e.writeTree_.subtree(t))}function uT(e){return e.writeTree_.isEmpty()}function hT(e,t){return function r(i,e,s){{if(null!=e.value)return s.updateChild(i,e.value);{let n=null;return e.children.inorderTraversal((e,t)=>{".priority"===e?(Yh(null!==t.value,"Priority writes must always be leaf nodes"),n=t.value):s=r(II(i,e),t,s)}),s=!s.getChild(i).isEmpty()&&null!==n?s.updateChild(II(i,".priority"),n):s}}}(gI(),e.writeTree_,t)}function dT(e,t){return ET(t,e)}function fT(t,n){var e,r=t.allWrites.findIndex(e=>e.writeId===n);Yh(0<=r,"removeWrite called with nonexistent writeId.");const i=t.allWrites[r];t.allWrites.splice(r,1);let s=i.visible,o=!1,a=t.allWrites.length-1;for(;s&&0<=a;){var c=t.allWrites[a];c.visible&&(a>=r&&function(e,t){{if(e.snap)return CI(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&CI(II(e.path,n),t))return!0;return!1}}(c,i.path)?s=!1:CI(i.path,c.path)&&(o=!0)),a--}return!!s&&(o?((e=t).visibleWrites=gT(e.allWrites,pT,gI()),0<e.allWrites.length?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1):i.snap?t.visibleWrites=sT(t.visibleWrites,i.path):Ub(i.children,e=>{t.visibleWrites=sT(t.visibleWrites,II(i.path,e))}),!0)}function pT(e){return e.visible}function gT(e,t,n){let r=nT.empty();for(let s=0;s<e.length;++s){const o=e[s];if(t(o)){var i=o.path;let e;if(o.snap)CI(n,i)?(e=EI(n,i),r=rT(r,e,o.snap)):CI(i,n)&&(e=EI(i,n),r=rT(r,gI(),o.snap.getChild(e)));else{if(!o.children)throw Jh("WriteRecord should have .snap or .children");if(CI(n,i))e=EI(n,i),r=iT(r,e,o.children);else if(CI(i,n))if(e=EI(i,n),TI(e))r=iT(r,gI(),o.children);else{const a=Id(o.children,mI(e));a&&(i=a.getChild(yI(e)),r=rT(r,gI(),i))}}}}return r}function mT(e,t,n,r,i){if(r||i){var s=lT(e.visibleWrites,t);if(!i&&uT(s))return n;if(i||null!=n||oT(s,gI()))return hT(gT(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(CI(e.path,t)||CI(t,e.path))},t),n||i0.EMPTY_NODE);return null}s=aT(e.visibleWrites,t);if(null!=s)return s;s=lT(e.visibleWrites,t);return uT(s)?n:null!=n||oT(s,gI())?hT(s,n||i0.EMPTY_NODE):null}function vT(e,t,n,r){return mT(e.writeTree,e.treePath,t,n,r)}function yT(e,t){return function(e,t,n){let r=i0.EMPTY_NODE;const i=aT(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(YI,(e,t)=>{r=r.updateImmediateChild(e,t)}),r;if(n){const s=lT(e.visibleWrites,t);return n.forEachChild(YI,(e,t)=>{var n=hT(lT(s,new pI(e)),t);r=r.updateImmediateChild(e,n)}),cT(s).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}return cT(lT(e.visibleWrites,t)).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function _T(e,t,n,r){return function(e,t,n,r,i){Yh(r||i,"Either existingEventSnap or existingServerSnap must exist");var s=II(t,n);return oT(e.visibleWrites,s)?null:uT(s=lT(e.visibleWrites,s))?i.getChild(n):hT(s,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function wT(e,t){return n=e.writeTree,t=II(e.treePath,t),aT(n.visibleWrites,t);var n}function bT(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;var c=lT(e.visibleWrites,t),l=aT(c,gI());if(null!=l)a=l;else{if(null==n)return[];a=hT(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let e=d.getNext();for(;e&&u.length<i;)0!==h(e,r)&&u.push(e),e=d.getNext();return u}}(e.writeTree,e.treePath,t,n,r,i,s)}function IT(e,t,n){return r=e.writeTree,e=e.treePath,n=n,i=II(e,t=t),null!=(s=aT(r.visibleWrites,i))?s:n.isCompleteForChild(t)?hT(lT(r.visibleWrites,i),n.getNode().getImmediateChild(t)):null;var r,i,s}function TT(e,t){return ET(II(e.treePath,t),e.writeTree)}function ET(e,t){return{treePath:e,writeTree:t}}class ST{constructor(){this.changeMap=new Map}trackChildChange(e){var t=e.type,n=e.childName;Yh("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Yh(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,b0(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,w0(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,_0(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Jh("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,b0(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const kT=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class CT{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new W0(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return IT(this.writes_,e,n)}getChildAfterChild(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Z0(this.viewCache_),r=bT(this.writes_,r,t,1,n,e);return 0===r.length?null:r[0]}}function AT(e,t,n,r,i){const s=new ST;let o,a;if(n.type===hb.OVERWRITE){var c=n;o=c.source.fromUser?xT(e,t,c.path,c.snap,r,i,s):(Yh(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!TI(c.path),RT(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===hb.MERGE){c=n;o=c.source.fromUser?function(r,i,s,e,o,a,c){let l=i;return e.foreach((e,t)=>{var n=II(s,e);PT(i,mI(n))&&(l=xT(r,l,n,t,o,a,c))}),e.foreach((e,t)=>{var n=II(s,e);PT(i,mI(n))||(l=xT(r,l,n,t,o,a,c))}),l}(e,t,c.path,c.children,r,i,s):(Yh(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),OT(e,t,c.path,c.children,r,i,a,s))}else if(n.type===hb.ACK_USER_WRITE){var l=n;o=l.revert?function(n,r,i,s,e,o){let a;{if(null!=wT(s,i))return r;{var c=new CT(s,r,e);const u=r.eventCache.getNode();let t;if(TI(i)||".priority"===mI(i)){let e;e=r.serverCache.isFullyInitialized()?vT(s,Z0(r)):(l=r.serverCache.getNode(),Yh(l instanceof i0,"serverChildren would be complete if leaf node"),yT(s,l)),e=e,t=n.filter.updateFullNode(u,e,o)}else{var l=mI(i);let e=IT(s,l,r.serverCache);null==e&&r.serverCache.isCompleteForChild(l)&&(e=u.getImmediateChild(l)),t=null!=e?n.filter.updateChild(u,l,e,yI(i),c,o):r.eventCache.getNode().hasChild(l)?n.filter.updateChild(u,l,i0.EMPTY_NODE,yI(i),c,o):u,t.isEmpty()&&r.serverCache.isFullyInitialized()&&(a=vT(s,Z0(r)),a.isLeafNode()&&(t=n.filter.updateFullNode(t,a,o)))}return a=r.serverCache.isFullyInitialized()||null!=wT(s,gI()),Y0(r,t,a,n.filter.filtersNodes())}}}(e,t,l.path,r,i,s):function(e,t,i,n,s,o,a){if(null!=wT(s,i))return t;const c=t.serverCache.isFiltered(),l=t.serverCache;{if(null!=n.value){if(TI(i)&&l.isFullyInitialized()||l.isCompleteForPath(i))return RT(e,t,i,l.getNode().getChild(i),s,o,c,a);if(TI(i)){let n=new tT(null);return l.getNode().forEachChild(FI,(e,t)=>{n=n.set(new pI(e),t)}),OT(e,t,i,n,s,o,c,a)}return t}{let r=new tT(null);return n.foreach((e,t)=>{var n=II(i,e);l.isCompleteForPath(n)&&(r=r.set(e,l.getNode().getChild(n)))}),OT(e,t,i,r,s,o,c,a)}}}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==hb.LISTEN_COMPLETE)throw Jh("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=J0(t,s.getNode(),s.isFullyInitialized()||TI(n),s.isFiltered());return NT(e,o,n,r,kT,i)}(e,t,n.path,r,s)}l=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty();const s=X0(e);(0<n.length||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(y0(X0(t)))}}(t,o,l),{viewCache:o,changes:l}}function NT(r,i,s,o,a,c){const l=i.eventCache;if(null!=wT(o,s))return i;{let t,n;if(TI(s)){var e;Yh(i.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t=i.serverCache.isFiltered()?(e=yT(o,(e=Z0(i))instanceof i0?e:i0.EMPTY_NODE),r.filter.updateFullNode(i.eventCache.getNode(),e,c)):(u=vT(o,Z0(i)),r.filter.updateFullNode(i.eventCache.getNode(),u,c))}else{var u=mI(s);if(".priority"===u){Yh(1===vI(s),"Can't have a priority with additional path components");var h=l.getNode();n=i.serverCache.getNode();var d=_T(o,s,h,n);t=null!=d?r.filter.updatePriority(h,d):l.getNode()}else{h=yI(s);let e;e=l.isCompleteForChild(u)?(n=i.serverCache.getNode(),null!=(d=_T(o,s,l.getNode(),n))?l.getNode().getImmediateChild(u).updateChild(h,d):l.getNode().getImmediateChild(u)):IT(o,u,i.serverCache),t=null!=e?r.filter.updateChild(l.getNode(),u,e,h,a,c):l.getNode()}}return Y0(i,t,l.isFullyInitialized()||TI(s),r.filter.filtersNodes())}}function RT(e,t,n,r,i,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(TI(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),h,null)}else{var d=mI(n);if(!c.isCompleteForPath(n)&&1<vI(n))return t;var f=yI(n);const p=c.getNode().getImmediateChild(d);h=p.updateChild(f,r);l=".priority"===d?u.updatePriority(c.getNode(),h):u.updateChild(c.getNode(),d,h,f,kT,null)}f=J0(t,l,c.isFullyInitialized()||TI(n),u.filtersNodes());return NT(e,f,n,i,new CT(i,f,s),a)}function xT(t,n,r,i,e,s,o){const a=n.eventCache;let c,l;const u=new CT(e,n,s);if(TI(r))l=t.filter.updateFullNode(n.eventCache.getNode(),i,o),c=Y0(n,l,!0,t.filter.filtersNodes());else{var h=mI(r);if(".priority"===h)l=t.filter.updatePriority(n.eventCache.getNode(),i),c=Y0(n,l,a.isFullyInitialized(),a.isFiltered());else{var d=yI(r);const f=a.getNode().getImmediateChild(h);let e;if(TI(d))e=i;else{const p=u.getCompleteChild(h);e=null!=p?".priority"===_I(d)&&p.getChild(bI(d)).isEmpty()?p:p.updateChild(d,i):i0.EMPTY_NODE}c=f.equals(e)?n:Y0(n,t.filter.updateChild(a.getNode(),h,e,d,u,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return c}function PT(e,t){return e.eventCache.isCompleteForChild(t)}function DT(e,n,t){return t.foreach((e,t)=>{n=n.updateChild(e,t)}),n}function OT(r,i,e,t,s,o,a,c){if(i.serverCache.getNode().isEmpty()&&!i.serverCache.isFullyInitialized())return i;let l=i,n;n=TI(e)?t:new tT(null).setTree(e,t);const u=i.serverCache.getNode();return n.children.inorderTraversal((e,t)=>{var n;u.hasChild(e)&&(n=DT(0,i.serverCache.getNode().getImmediateChild(e),t),l=RT(r,l,new pI(e),n,s,o,a,c))}),n.children.inorderTraversal((e,t)=>{var n=!i.serverCache.isCompleteForChild(e)&&void 0===t.value;u.hasChild(e)||n||(n=DT(0,i.serverCache.getNode().getImmediateChild(e),t),l=RT(r,l,new pI(e),n,s,o,a,c))}),l}class MT{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new I0(n.getIndex()),i=(e=n).loadsAllData()?new I0(e.getIndex()):new(e.hasLimit()?E0:T0)(e);this.processor_={filter:i};const s=t.serverCache,o=t.eventCache;var a=r.updateFullNode(i0.EMPTY_NODE,s.getNode(),null),c=i.updateFullNode(i0.EMPTY_NODE,o.getNode(),null),a=new W0(a,s.isFullyInitialized(),r.filtersNodes()),c=new W0(c,o.isFullyInitialized(),i.filtersNodes());this.viewCache_=Q0(c,a),this.eventGenerator_=new z0(this.query_)}get query(){return this.query_}}function LT(e){return 0===e.eventRegistrations_.length}function FT(n,r,i){const s=[];if(i){Yh(null==r,"A cancel should cancel all event registrations.");const o=n.query._path;n.eventRegistrations_.forEach(e=>{var t=e.createCancelEvent(i,o);t&&s.push(t)})}if(r){let e=[];for(let t=0;t<n.eventRegistrations_.length;++t){const a=n.eventRegistrations_[t];if(a.matches(r)){if(r.hasAnyCallback()){e=e.concat(n.eventRegistrations_.slice(t+1));break}}else e.push(a)}n.eventRegistrations_=e}else n.eventRegistrations_=[];return s}function UT(e,t,n,r){t.type===hb.MERGE&&null!==t.source.queryId&&(Yh(Z0(e.viewCache_),"We should always have a full cache before handling merges"),Yh(X0(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=AT(e.processor_,i,t,n,r);return n=e.processor_,r=s.viewCache,Yh(r.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Yh(r.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed"),Yh(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,jT(e,s.changes,s.viewCache.eventCache.getNode(),null)}function jT(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return H0(e.eventGenerator_,t,n,i)}let VT;class qT{constructor(){this.views=new Map}}function BT(t,n,r,i){var e=n.source.queryId;if(null!==e){e=t.views.get(e);return Yh(null!=e,"SyncTree gave us an op for an invalid query."),UT(e,n,r,i)}{let e=[];for(const s of t.views.values())e=e.concat(UT(s,n,r,i));return e}}function $T(e,n,r,i,s){var o=n._queryIdentifier,o=e.views.get(o);if(o)return o;{let e=vT(r,s?i:null),t=!1;t=!!e||(e=i instanceof i0?yT(r,i):i0.EMPTY_NODE,!1);o=Q0(new W0(e,t,!1),new W0(i,s,!1));return new MT(n,o)}}function KT(e,t,n,r,i,s){var o=$T(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),o.eventRegistrations_.push(n),function(e,t){const n=e.viewCache_.eventCache,r=[];if(!n.getNode().isLeafNode()){const i=n.getNode();i.forEachChild(YI,(e,t)=>{r.push(_0(e,t))})}return n.isFullyInitialized()&&r.push(y0(n.getNode())),jT(e,r,n.getNode(),t)}(o,n)}function WT(e,t,n,r){var i=t._queryIdentifier;const s=[];let o=[];var a=YT(e);if("default"===i)for(var[c,l]of e.views.entries())o=o.concat(FT(l,n,r)),LT(l)&&(e.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{const u=e.views.get(i);u&&(o=o.concat(FT(u,n,r)),LT(u)&&(e.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!YT(e)&&s.push((Yh(VT,"Reference.ts has not been loaded"),new VT(t._repo,t._path))),{removed:s,events:o}}function zT(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function HT(e,t){let n=null;for(const r of e.views.values())n=n||function(e,t){const n=Z0(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!TI(t)&&!n.getImmediateChild(mI(t)).isEmpty())?n.getChild(t):null}(r,t);return n}function GT(e,t){const n=t._queryParams;if(n.loadsAllData())return JT(e);var r=t._queryIdentifier;return e.views.get(r)}function QT(e,t){return null!=GT(e,t)}function YT(e){return null!=JT(e)}function JT(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let XT;let ZT=1;class eE{constructor(e){this.listenProvider_=e,this.syncPointTree_=new tT(null),this.pendingWriteTree_={visibleWrites:nT.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function tE(e,t,n,r,i){var s,o,a,c;return s=e.pendingWriteTree_,o=t,a=n,c=r,r=i,Yh(c>s.lastWriteId,"Stacking an older write on top of newer ones"),s.allWrites.push({path:o,snap:a,writeId:c,visible:r=void 0===r?!0:r}),r&&(s.visibleWrites=rT(s.visibleWrites,o,a)),s.lastWriteId=c,i?lE(e,new $0(U0(),t,n)):[]}function nE(e,t,n,r){var i,s,o;i=e.pendingWriteTree_,s=t,o=n,r=r,Yh(r>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:s,children:o,writeId:r,visible:!0}),i.visibleWrites=iT(i.visibleWrites,s,o),i.lastWriteId=r;var a=tT.fromObject(n);return lE(e,new K0(U0(),t,a))}function rE(e,t,n=!1){var r=function(e,t){for(let r=0;r<e.allWrites.length;r++){var n=e.allWrites[r];if(n.writeId===t)return n}return null}(e.pendingWriteTree_,t);if(fT(e.pendingWriteTree_,t)){let t=new tT(null);return null!=r.snap?t=t.set(gI(),!0):Ub(r.children,e=>{t=t.set(new pI(e),!0)}),lE(e,new q0(r.path,t,n))}return[]}function iE(e,t,n){return lE(e,new $0(j0(),t,n))}function sE(n,e,t,r){var i=e._path,s=n.syncPointTree_.get(i);let o=[];if(s&&("default"===e._queryIdentifier||QT(s,e))){var a=WT(s,e,t,r);0===s.views.size&&(n.syncPointTree_=n.syncPointTree_.remove(i));const h=a.removed;o=a.events;s=-1!==h.findIndex(e=>e._queryParams.loadsAllData()),a=n.syncPointTree_.findOnPath(i,(e,t)=>YT(t));if(s&&!a){const d=n.syncPointTree_.subtree(i);if(!d.isEmpty()){var c=d.fold((e,t,r)=>{if(t&&YT(t))return[JT(t)];{let n=[];return t&&(n=zT(t)),Ub(r,(e,t)=>{n=n.concat(t)}),n}});for(let e=0;e<c.length;++e){var l=c[e],u=l.query,l=hE(n,l);n.listenProvider_.startListening(vE(u),dE(n,u),l.hashFn,l.onComplete)}}}!a&&0<h.length&&!r&&(s?n.listenProvider_.stopListening(vE(e),null):h.forEach(e=>{var t=n.queryToTagMap.get(fE(e));n.listenProvider_.stopListening(vE(e),t)})),function(e,t){for(let i=0;i<t.length;++i){const s=t[i];var n,r;s._queryParams.loadsAllData()||(n=fE(s),r=e.queryToTagMap.get(n),e.queryToTagMap.delete(n),e.tagToQueryMap.delete(r))}}(n,h)}return o}function oE(e,t,n){const r=t._path;let i=null,s=!1;e.syncPointTree_.foreachOnPath(r,(e,t)=>{var n=EI(e,r);i=i||HT(t,n),s=s||YT(t)});let o=e.syncPointTree_.get(r);o?(s=s||YT(o),i=i||HT(o,gI())):(o=new qT,e.syncPointTree_=e.syncPointTree_.set(r,o));let a;if(null!=i)a=!0;else{a=!1,i=i0.EMPTY_NODE;const d=e.syncPointTree_.subtree(r);d.foreachChild((e,t)=>{var n=HT(t,gI());n&&(i=i.updateImmediateChild(e,n))})}var c,l=QT(o,t);l||t._queryParams.loadsAllData()||(u=fE(t),Yh(!e.queryToTagMap.has(u),"View does not exist, but we have a tag"),c=ZT++,e.queryToTagMap.set(u,c),e.tagToQueryMap.set(c,u));var u=dT(e.pendingWriteTree_,r);let h=KT(o,t,n,u,i,a);return l||s||(l=GT(o,t),h=h.concat(function(t,e,n){const r=e._path,i=dE(t,e),s=hE(t,n),o=t.listenProvider_.startListening(vE(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)Yh(!YT(a.value),"If we're adding a query, it shouldn't be shadowed");else{var c=a.fold((e,t,r)=>{if(!TI(e)&&t&&YT(t))return[JT(t).query];{let n=[];return t&&(n=n.concat(zT(t).map(e=>e.query))),Ub(r,(e,t)=>{n=n.concat(t)}),n}});for(let e=0;e<c.length;++e){var l=c[e];t.listenProvider_.stopListening(vE(l),dE(t,l))}}return o}(e,t,l))),h}function aE(e,r,t){var n=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(r,(e,t)=>{var n=HT(t,EI(e,r));if(n)return n});return mT(n,r,i,t,!0)}function cE(e,t){const r=t._path;let i=null;e.syncPointTree_.foreachOnPath(r,(e,t)=>{var n=EI(e,r);i=i||HT(t,n)});let n=e.syncPointTree_.get(r);n?i=i||HT(n,gI()):(n=new qT,e.syncPointTree_=e.syncPointTree_.set(r,n));var s=null!=i;const o=s?new W0(i,!0,!1):null;var a=dT(e.pendingWriteTree_,t._path);return X0($T(n,t,a,s?o.getNode():i0.EMPTY_NODE,s).viewCache_)}function lE(e,t){return function t(n,r,i,s){{if(TI(n.path))return uE(n,r,i,s);{const o=r.get(gI());null==i&&null!=o&&(i=HT(o,gI()));let e=[];const a=mI(n.path),c=n.operationForChild(a),l=r.children.get(a);if(l&&c){const u=i?i.getImmediateChild(a):null,h=TT(s,a);e=e.concat(t(c,l,u,h))}return o&&(e=e.concat(BT(o,n,s,i))),e}}}(t,e.syncPointTree_,null,dT(e.pendingWriteTree_,gI()))}function uE(s,e,o,a){var t=e.get(gI());null==o&&null!=t&&(o=HT(t,gI()));let c=[];return e.children.inorderTraversal((e,t)=>{var n=o?o.getImmediateChild(e):null,r=TT(a,e),i=s.operationForChild(e);i&&(c=c.concat(uE(i,t,n,r)))}),t&&(c=c.concat(BT(t,s,a,o))),c}function hE(i,t){const s=t.query,o=dE(i,s);return{hashFn:()=>{const e=t.viewCache_.serverCache.getNode()||i0.EMPTY_NODE;return e.hash()},onComplete:e=>{if("ok"===e)return o?function(e,t,n){if(s=pE(e,n)){var r=gE(s),i=r.path,s=r.queryId,r=EI(i,t);return mE(e,i,new B0(V0(s),r))}return[]}(i,s._path,o):(t=i,n=s._path,lE(t,new B0(j0(),n)));var t,n,r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(e,s);return sE(i,s,null,r)}}}function dE(e,t){var n=fE(t);return e.queryToTagMap.get(n)}function fE(e){return e._path.toString()+"$"+e._queryIdentifier}function pE(e,t){return e.tagToQueryMap.get(t)}function gE(e){var t=e.indexOf("$");return Yh(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new pI(e.substr(0,t))}}function mE(e,t,n){var r=e.syncPointTree_.get(t);return Yh(r,"Missing sync point for query tag that we're tracking"),BT(r,n,dT(e.pendingWriteTree_,t),null)}function vE(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?(Yh(XT,"Reference.ts has not been loaded"),new XT(e._repo,e._path)):e}class yE{constructor(e){this.node_=e}getImmediateChild(e){var t=this.node_.getImmediateChild(e);return new yE(t)}node(){return this.node_}}class _E{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){var t=II(this.path_,e);return new _E(this.syncTree_,t)}node(){return aE(this.syncTree_,this.path_)}}function wE(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}function bE(e,t,n){return e&&"object"==typeof e?(Yh(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?IE(e[".sv"],t,n):"object"==typeof e[".sv"]?TE(e[".sv"],t):void Yh(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e}const IE=function(e,t,n){if("timestamp"===e)return n.timestamp;Yh(!1,"Unexpected server value: "+e)},TE=function(e,t,n){e.hasOwnProperty("increment")||Yh(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&Yh(!1,"Unexpected increment value: "+r);const i=t.node();if(Yh(null!==i&&void 0!==i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i;var o=s.getValue();return"number"!=typeof o?r:o+r},EE=function(e,t,n,r){return kE(t,new _E(n,e),r)},SE=function(e,t,n){return kE(e,new yE(t),n)};function kE(e,r,i){var t=e.getPriority().val(),n=bE(t,r.getImmediateChild(".priority"),i);let s;if(e.isLeafNode()){const o=e;t=bE(o.getValue(),r,i);return t!==o.getValue()||n!==o.getPriority().val()?new HI(t,c0(n)):e}{const a=e;return s=a,n!==a.getPriority().val()&&(s=s.updatePriority(new HI(n))),a.forEachChild(YI,(e,t)=>{var n=kE(t,r.getImmediateChild(e),i);n!==t&&(s=s.updateImmediateChild(e,n))}),s}}class CE{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function AE(e,t){let n=t instanceof pI?t:new pI(t),r=e,i=mI(n);for(;null!==i;){var s=Id(r.node.children,i)||{children:{},childCount:0};r=new CE(i,r,s),n=yI(n),i=mI(n)}return r}function NE(e){return e.node.value}function RE(e,t){e.node.value=t,OE(e)}function xE(e){return 0<e.node.childCount}function PE(n,r){Ub(n.node.children,(e,t)=>{r(new CE(e,n,t))})}function DE(e){return new pI(null===e.parent?e.name:DE(e.parent)+"/"+e.name)}function OE(e){var t,n,r,i;null!==e.parent&&(t=e.parent,n=e.name,r=function(e){return void 0===NE(e)&&!xE(e)}(e=e),i=bd(t.node.children,n),r&&i?(delete t.node.children[n],t.node.childCount--,OE(t)):r||i||(t.node.children[n]=e.node,t.node.childCount++,OE(t)))}function ME(e,t,n,r){r&&void 0===t||GE(Md(e,"value"),t,n)}function LE(e,t,r,n){if(!n||void 0!==t){const i=Md(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Ub(t,(e,t)=>{const n=new pI(e);if(GE(i,t,II(r,n)),".priority"===_I(n)&&!HE(t))throw new Error(i+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)}),function(t,n){let r,i;for(r=0;r<n.length;r++){i=n[r];var s=wI(i);for(let e=0;e<s.length;e++)if((".priority"!==s[e]||e!==s.length-1)&&!KE(s[e]))throw new Error(t+"contains an invalid key ("+s[e]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}n.sort(SI);let e=null;for(r=0;r<n.length;r++){if(i=n[r],null!==e&&CI(e,i))throw new Error(t+"contains a path "+e.toString()+" that is ancestor of another path "+i.toString());e=i}}(i,s)}}function FE(e,t,n){if(!n||void 0!==t){if(Ob(t))throw new Error(Md(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!HE(t))throw new Error(Md(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}}function UE(e,t,n,r){if(!(r&&void 0===n||KE(n)))throw new Error(Md(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function jE(e,t,n,r){n=n&&n.replace(/^\/*\.info(\/|$)/,"/"),QE(e,t,n,r)}function VE(e,t){if(".info"===mI(t))throw new Error(e+" failed = Can't modify data under /.info/")}const qE=/[\[\].#$\/\u0000-\u001F\u007F]/,BE=/[\[\].#$\u0000-\u001F\u007F]/,$E=10485760,KE=function(e){return"string"==typeof e&&0!==e.length&&!qE.test(e)},WE=function(e){return"string"==typeof e&&0!==e.length&&!BE.test(e)},zE=function(e){return e=e&&e.replace(/^\/*\.info(\/|$)/,"/"),WE(e)},HE=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Ob(e)||e&&"object"==typeof e&&bd(e,".sv")},GE=function(o,e,t){const a=t instanceof pI?new AI(t,o):t;if(void 0===e)throw new Error(o+"contains undefined "+RI(a));if("function"==typeof e)throw new Error(o+"contains a function "+RI(a)+" with contents = "+e.toString());if(Ob(e))throw new Error(o+"contains "+e.toString()+" "+RI(a));if("string"==typeof e&&e.length>$E/3&&Ud(e)>$E)throw new Error(o+"contains a string greater than "+$E+" utf8 bytes "+RI(a)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Ub(e,(e,t)=>{if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!KE(e)))throw new Error(o+" contains an invalid key ("+e+") "+RI(a)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var n,r;n=a,e=e,0<n.parts_.length&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ud(e),NI(n),GE(o,t,a),t=a,r=t.parts_.pop(),t.byteLength_-=Ud(r),0<t.parts_.length&&--t.byteLength_}),i&&s)throw new Error(o+' contains ".value" child '+RI(a)+" in addition to actual children.")}},QE=function(e,t,n,r){if(!(r&&void 0===n||WE(n)))throw new Error(Md(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},YE=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!KE(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!zE(n))throw new Error(Md(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class JE{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function XE(e,t){let n=null;for(let i=0;i<t.length;i++){const s=t[i];var r=s.getPath();null===n||kI(r,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:r}),n.events.push(s)}n&&e.eventLists_.push(n)}function ZE(e,t,n){XE(e,n),tS(e,e=>kI(e,t))}function eS(e,t,n){XE(e,n),tS(e,e=>CI(e,t)||CI(t,e))}function tS(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){var r=e.eventLists_[i];r&&(t(r.path)?(function(e){for(let n=0;n<e.events.length;n++){const r=e.events[n];var t;null!==r&&(e.events[n]=null,t=r.getEventRunner(),bb&&Rb("event: "+r.toString()),Wb(t))}}(e.eventLists_[i]),e.eventLists_[i]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}const nS="repo_interrupt",rS=25;class iS{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new JE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=D0(),this.transactionQueueTree_=new CE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function sS(o,e,t){if(o.stats_=rI(o.repoInfo_),o.forceRestClient_||function(){const e="object"==typeof window&&window.navigator&&window.navigator.userAgent||"";return 0<=e.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)}())o.server_=new x0(o.repoInfo_,(e,t,n,r)=>{cS(o,e,t,n,r)},o.authTokenProvider_,o.appCheckProvider_),setTimeout(()=>lS(o,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_d(t)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}o.persistentConnection_=new PI(o.repoInfo_,e,(e,t,n,r)=>{cS(o,e,t,n,r)},e=>{lS(o,e)},e=>{var n;n=o,Ub(e,(e,t)=>{uS(n,e,t)})},o.authTokenProvider_,o.appCheckProvider_,t),o.server_=o.persistentConnection_}var n;o.authTokenProvider_.addTokenChangeListener(e=>{o.server_.refreshAuthToken(e)}),o.appCheckProvider_.addTokenChangeListener(e=>{o.server_.refreshAppCheckToken(e.token)}),o.statsReporter_=(e=o.repoInfo_,t=()=>new F0(o.stats_,o.server_),n=e.toString(),nI[n]||(nI[n]=t()),nI[n]),o.infoData_=new P0,o.infoSyncTree_=new eE({startListening:(e,t,n,r)=>{let i=[];const s=o.infoData_.getNode(e._path);return s.isEmpty()||(i=iE(o.infoSyncTree_,e._path,s),setTimeout(()=>{r("ok")},0)),i},stopListening:()=>{}}),uS(o,"connected",!1),o.serverSyncTree_=new eE({startListening:(r,e,t,i)=>(o.server_.listen(r,t,e,(e,t)=>{var n=i(e,t);eS(o.eventQueue_,r._path,n)}),[]),stopListening:(e,t)=>{o.server_.unlisten(e,t)}})}function oS(e){const t=e.infoData_.getNode(new pI(".info/serverTimeOffset"));var n=t.val()||0;return(new Date).getTime()+n}function aS(e){return wE({timestamp:oS(e)})}function cS(e,t,n,r,i){e.dataUpdateCount++;var s,o,a=new pI(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let c=[];c=i?r?(s=Ed(n,e=>c0(e)),function(e,t,n,r){if(a=pE(e,r)){var i=gE(a),s=i.path,o=i.queryId,a=EI(s,t),i=tT.fromObject(n);return mE(e,s,new K0(V0(o),a,i))}return[]}(e.serverSyncTree_,a,s,i)):(s=c0(n),function(e,t,n,r){if(null==(s=pE(e,r)))return[];var i=(o=gE(s)).path,s=o.queryId,o=EI(i,t);return mE(e,i,new $0(V0(s),o,n))}(e.serverSyncTree_,a,s,i)):r?(o=Ed(n,e=>c0(e)),t=e.serverSyncTree_,i=a,r=o,o=tT.fromObject(r),lE(t,new K0(j0(),i,o))):(o=c0(n),iE(e.serverSyncTree_,a,o));let l=a;0<c.length&&(l=bS(e,a)),eS(e.eventQueue_,l,c)}function lS(e,t){uS(e,"connected",t),!1===t&&function(r){vS(r,"onDisconnectEvents");const i=aS(r),s=D0();M0(r.onDisconnect_,gI(),(e,t)=>{var n=EE(e,t,r.serverSyncTree_,i);O0(s,e,n)});let o=[];M0(s,gI(),(e,t)=>{o=o.concat(iE(r.serverSyncTree_,e,t));var n=SS(r,e);bS(r,n)}),r.onDisconnect_=D0(),eS(r.eventQueue_,gI(),o)}(e)}function uS(e,t,n){var r=new pI("/.info/"+t),i=c0(n);e.infoData_.updateSnapshot(r,i);i=iE(e.infoSyncTree_,r,i);eS(e.eventQueue_,r,i)}function hS(e){return e.nextWriteId_++}function dS(r,i,e,t,s){vS(r,"set",{path:i.toString(),value:e,priority:t});var n=aS(r);const o=c0(e,t);var a=aE(r.serverSyncTree_,i),n=SE(o,a,n);const c=hS(r);n=tE(r.serverSyncTree_,i,n,c,!0);XE(r.eventQueue_,n),r.server_.put(i.toString(),o.val(!0),(e,t)=>{var n="ok"===e;n||Pb("set at "+i+" failed: "+e);n=rE(r.serverSyncTree_,c,!n);eS(r.eventQueue_,i,n),yS(0,s,e,t)});n=SS(r,i);bS(r,n),eS(r.eventQueue_,n,[])}function fS(n,r,i){n.server_.onDisconnectCancel(r.toString(),(e,t)=>{"ok"===e&&!function e(n,t){if(TI(t))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const i=n.value;return n.value=null,i.forEachChild(YI,(e,t)=>{O0(n,new pI(e),t)}),e(n,t)}}if(0<n.children.size){var r=mI(t);return t=yI(t),n.children.has(r)&&e(n.children.get(r),t)&&n.children.delete(r),0===n.children.size}return!0}(n.onDisconnect_,r),yS(0,i,e,t)})}function pS(n,r,e,i){const s=c0(e);n.server_.onDisconnectPut(r.toString(),s.val(!0),(e,t)=>{"ok"===e&&O0(n.onDisconnect_,r,s),yS(0,i,e,t)})}function gS(e,t,n){let r;r=".info"===mI(t._path)?sE(e.infoSyncTree_,t,n):sE(e.serverSyncTree_,t,n),ZE(e.eventQueue_,t._path,r)}function mS(e){e.persistentConnection_&&e.persistentConnection_.interrupt(nS)}function vS(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Rb(n,...t)}function yS(e,r,i,s){r&&Wb(()=>{if("ok"===i)r(null);else{var t=(i||"error").toUpperCase();let e=t;s&&(e+=": "+s);const n=new Error(e);n.code=t,r(n)}})}function _S(e,t,n){return aE(e.serverSyncTree_,t,n)||i0.EMPTY_NODE}function wS(t,e=t.transactionQueueTree_){if(e||ES(t,e),NE(e)){const n=TS(t,e);Yh(0<n.length,"Sending zero length transaction queue"),n.every(e=>0===e.status)&&function(i,s,o){const e=o.map(e=>e.currentWriteId),t=_S(i,s,e);let n=t;var r=t.hash();for(let u=0;u<o.length;u++){const h=o[u];Yh(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;var a=EI(s,h.path);n=n.updateChild(a,h.currentOutputSnapshotRaw)}const c=n.val(!0),l=s;i.server_.put(l.toString(),c,t=>{vS(i,"transaction put response",{path:l.toString(),status:t});let n=[];if("ok"===t){const r=[];for(let e=0;e<o.length;e++)o[e].status=2,n=n.concat(rE(i.serverSyncTree_,o[e].currentWriteId)),o[e].onComplete&&r.push(()=>o[e].onComplete(null,!0,o[e].currentOutputSnapshotResolved)),o[e].unwatcher();ES(i,AE(i.transactionQueueTree_,s)),wS(i,i.transactionQueueTree_),eS(i.eventQueue_,s,n);for(let t=0;t<r.length;t++)Wb(r[t])}else{if("datastale"===t)for(let e=0;e<o.length;e++)3===o[e].status?o[e].status=4:o[e].status=0;else{Pb("transaction at "+l.toString()+" failed: "+t);for(let e=0;e<o.length;e++)o[e].status=4,o[e].abortReason=t}bS(i,s)}},r)}(t,DE(e),n)}else xE(e)&&PE(e,e=>{wS(t,e)})}function bS(e,t){var n=IS(e,t),r=DE(n);return function(i,s,o){if(0!==s.length){const l=[];let n=[];const t=s.filter(e=>0===e.status),u=t.map(e=>e.currentWriteId);for(let r=0;r<s.length;r++){const h=s[r];var a=EI(o,h.path);let e=!1,t;if(Yh(null!==a,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)e=!0,t=h.abortReason,n=n.concat(rE(i.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=rS)e=!0,t="maxretry",n=n.concat(rE(i.serverSyncTree_,h.currentWriteId,!0));else{const d=_S(i,h.path,u);h.currentInputSnapshot=d;var c=s[r].update(d.val());if(void 0!==c){GE("transaction failed: Data returned ",c,h.path);let e=c0(c);"object"==typeof c&&null!=c&&bd(c,".priority")||(e=e.updatePriority(d.getPriority()));a=h.currentWriteId,c=aS(i),c=SE(e,d,c);h.currentOutputSnapshotRaw=e,h.currentOutputSnapshotResolved=c,h.currentWriteId=hS(i),u.splice(u.indexOf(a),1),n=n.concat(tE(i.serverSyncTree_,h.path,c,h.currentWriteId,h.applyLocally)),n=n.concat(rE(i.serverSyncTree_,a,!0))}else e=!0,t="nodata",n=n.concat(rE(i.serverSyncTree_,h.currentWriteId,!0))}eS(i.eventQueue_,o,n),n=[],e&&(s[r].status=2,function(e){setTimeout(e,Math.floor(0))}(s[r].unwatcher),s[r].onComplete&&("nodata"===t?l.push(()=>s[r].onComplete(null,!1,s[r].currentInputSnapshot)):l.push(()=>s[r].onComplete(new Error(t),!1,null))))}ES(i,i.transactionQueueTree_);for(let e=0;e<l.length;e++)Wb(l[e]);wS(i,i.transactionQueueTree_)}}(e,TS(e,n),r),r}function IS(e,t){let n,r=e.transactionQueueTree_;for(n=mI(t);null!==n&&void 0===NE(r);)r=AE(r,n),t=yI(t),n=mI(t);return r}function TS(e,t){const n=[];return function t(n,e,r){const i=NE(e);if(i)for(let e=0;e<i.length;e++)r.push(i[e]);PE(e,e=>{t(n,e,r)})}(e,t,n),n.sort((e,t)=>e.order-t.order),n}function ES(t,n){const r=NE(n);if(r){let e=0;for(let t=0;t<r.length;t++)2!==r[t].status&&(r[e]=r[t],e++);r.length=e,RE(n,0<r.length?r:void 0)}PE(n,e=>{ES(t,e)})}function SS(t,e){var n=DE(IS(t,e)),r=AE(t.transactionQueueTree_,e);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return;r=r.parent}}(r,e=>{kS(t,e)}),kS(t,r),function t(e,n,r,i){r&&!i&&n(e),PE(e,e=>{t(e,n,!0,i)}),r&&i&&n(e)}(r,e=>{kS(t,e)}),n}function kS(i,s){const o=NE(s);if(o){const a=[];let e=[],t=-1;for(let n=0;n<o.length;n++)3===o[n].status||(1===o[n].status?(Yh(t===n-1,"All SENT items should be at beginning of queue."),t=n,o[n].status=3,o[n].abortReason="set"):(Yh(0===o[n].status,"Unexpected transaction status in abort"),o[n].unwatcher(),e=e.concat(rE(i.serverSyncTree_,o[n].currentWriteId,!0)),o[n].onComplete&&a.push(o[n].onComplete.bind(null,new Error("set"),!1,null))));-1===t?RE(s,void 0):o.length=t+1,eS(i.eventQueue_,DE(s),e);for(let r=0;r<a.length;r++)Wb(a[r])}}const CS=function(e,t){var n=AS(e),r=n.namespace;"firebase.com"===n.domain&&xb(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||xb("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Db();var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Xb(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new pI(n.pathString)}},AS=function(r){let i="",s="",o="",a="",c="",l=!0,u="https",h=443;if("string"==typeof r){let e=r.indexOf("//");0<=e&&(u=r.substring(0,e-1),r=r.substring(e+2));let t=r.indexOf("/");-1===t&&(t=r.length);let n=r.indexOf("?");-1===n&&(n=r.length),i=r.substring(0,Math.min(t,n)),t<n&&(a=function(e){let t="";var n=e.split("/");for(let r=0;r<n.length;r++)if(0<n[r].length){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}t+="/"+e}return t}(r.substring(t,n)));var d,f=function(e){const t={};for(const r of(e="?"===e.charAt(0)?e.substring(1):e).split("&")){var n;0!==r.length&&(2===(n=r.split("=")).length?t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):Pb(`Invalid query segment '${r}' in query '${e}'`))}return t}(r.substring(Math.min(r.length,n)));e=i.indexOf(":"),0<=e?(l="https"===u||"wss"===u,h=parseInt(i.substring(e+1),10)):e=i.length;const p=i.slice(0,e);"localhost"===p.toLowerCase()?s="localhost":p.split(".").length<=2?s=p:(d=i.indexOf("."),o=i.substring(0,d).toLowerCase(),s=i.substring(d+1),c=o),"ns"in f&&(c=f.ns)}return{host:i,port:h,domain:s,subdomain:o,secure:l,scheme:u,pathString:a,namespace:c}};class NS{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){var e=this.snapshot.ref;return("value"===this.eventType?e:e.parent)._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_d(this.snapshot.exportVal())}}class RS{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class xS{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Yh(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class PS{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new rd;return fS(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){VE("OnDisconnect.remove",this._path);const e=new rd;return pS(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){VE("OnDisconnect.set",this._path),ME("OnDisconnect.set",e,this._path,!1);const t=new rd;return pS(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){VE("OnDisconnect.setWithPriority",this._path),ME("OnDisconnect.setWithPriority",e,this._path,!1),FE("OnDisconnect.setWithPriority",t,!1);const n=new rd;return function(n,r,e,t,i){const s=c0(e,t);n.server_.onDisconnectPut(r.toString(),s.val(!0),(e,t)=>{"ok"===e&&O0(n.onDisconnect_,r,s),yS(0,i,e,t)})}(this._repo,this._path,e,t,n.wrapCallback(()=>{})),n.promise}update(e){VE("OnDisconnect.update",this._path),LE("OnDisconnect.update",e,this._path,!1);const t=new rd;return function(r,i,n,s){if(Td(n))return Rb("onDisconnect().update() called with empty data.  Don't do anything."),yS(0,s,"ok",void 0);r.server_.onDisconnectMerge(i.toString(),n,(e,t)=>{"ok"===e&&Ub(n,(e,t)=>{var n=c0(t);O0(r.onDisconnect_,II(i,e),n)}),yS(0,s,e,t)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class DS{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return TI(this._path)?null:_I(this._path)}get ref(){return new FS(this._repo,this._path)}get _queryIdentifier(){var e=R0(this._queryParams),e=Cb(e);return"{}"===e?"default":e}get _queryObject(){return R0(this._queryParams)}isEqual(e){if(!((e=Kd(e))instanceof DS))return!1;var t=this._repo===e._repo,n=kI(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function OS(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function MS(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===FI){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Mb)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Lb)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===YI){if(null!=t&&!HE(t)||null!=n&&!HE(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Yh(e.getIndex()instanceof l0||e.getIndex()===d0,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function LS(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class FS extends DS{constructor(e,t){super(e,t,new S0,!1)}get parent(){var e=bI(this._path);return null===e?null:new FS(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class US{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){var t=new pI(e),n=qS(this.ref,e);return new US(this._node.getChild(t),n,YI)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(n){if(this._node.isLeafNode())return!1;const e=this._node;return!!e.forEachChild(this._index,(e,t)=>n(new US(t,qS(this.ref,e),YI)))}hasChild(e){var t=new pI(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function jS(e,t){return(e=Kd(e))._checkNotDeleted("ref"),void 0!==t?qS(e._root,t):e._root}function VS(e,t){(e=Kd(e))._checkNotDeleted("refFromURL");const n=CS(t,e._repo.repoInfo_.nodeAdmin);YE("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||xb("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),jS(e,n.path.toString())}function qS(e,t){return(null===mI((e=Kd(e))._path)?jE:QE)("child","path",t,!1),new FS(e._repo,II(e._path,t))}function BS(e,t){e=Kd(e),VE("set",e._path),ME("set",t,e._path,!1);const n=new rd;return dS(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}function $S(e,t){LE("update",t,e._path,!1);const n=new rd;return function(i,s,e,o){vS(i,"update",{path:s.toString(),value:e});let n=!0;const r=aS(i),a={};if(Ub(e,(e,t)=>{n=!1,a[e]=EE(II(s,e),c0(t),i.serverSyncTree_,r)}),n)Rb("update() called with empty data.  Don't do anything."),yS(0,o,"ok",void 0);else{const c=hS(i);var t=nE(i.serverSyncTree_,s,a,c);XE(i.eventQueue_,t),i.server_.merge(s.toString(),e,(e,t)=>{var n="ok"===e;n||Pb("update at "+s+" failed: "+e);var r=rE(i.serverSyncTree_,c,!n),n=0<r.length?bS(i,s):s;eS(i.eventQueue_,n,r),yS(0,o,e,t)}),Ub(e,e=>{var t=SS(i,II(s,e));bS(i,t)}),eS(i.eventQueue_,s,[])}}(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}function KS(t){return t=Kd(t),r=t._repo,i=t,(null!=(e=cE(r.serverSyncTree_,i))?Promise.resolve(e):r.server_.get(i).then(e=>{var t=c0(e).withIndex(i._queryParams.getIndex()),n=iE(r.serverSyncTree_,i._path,t);return ZE(r.eventQueue_,i._path,n),Promise.resolve(t)},e=>(vS(r,"get for query "+_d(i)+" failed: "+e),Promise.reject(new Error(e))))).then(e=>new US(e,new FS(t._repo,t._path),t._queryParams.getIndex()));var r,i,e}class WS{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){var n=t._queryParams.getIndex();return new NS("value",this,new US(e.snapshotNode,new FS(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new RS(this,e,t):null}matches(e){return e instanceof WS&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class zS{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new RS(this,e,t):null}createEvent(e,t){Yh(null!=e.childName,"Child events should have a childName.");var n=qS(new FS(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new NS(e.type,this,new US(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof zS&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function HS(n,e,t,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const c=t;var o=(e,t)=>{gS(n._repo,n,a),c(e,t)};o.userCallback=t.userCallback,o.context=t.context,t=o}o=new xS(t,s||void 0);const a="value"===e?new WS(o):new zS(e,o);return function(e,t,n){let r;r=".info"===mI(t._path)?oE(e.infoSyncTree_,t,n):oE(e.serverSyncTree_,t,n),ZE(e.eventQueue_,t._path,r)}(n._repo,n,a),()=>gS(n._repo,n,a)}function GS(e,t,n,r){return HS(e,"value",t,n,r)}function QS(e,t,n,r){return HS(e,"child_added",t,n,r)}function YS(e,t,n,r){return HS(e,"child_changed",t,n,r)}function JS(e,t,n,r){return HS(e,"child_moved",t,n,r)}function XS(e,t,n,r){return HS(e,"child_removed",t,n,r)}function ZS(e,t,n){let r=null;var i=n?new xS(n):null;"value"===t?r=new WS(i):t&&(r=new zS(t,i)),gS(e._repo,e,r)}class ek{}class tk extends ek{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ME("endAt",this._value,e._path,!0);var t=C0(e._queryParams,this._value,this._key);if(LS(t),MS(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new DS(e._repo,e._path,t,e._orderByCalled)}}class nk extends ek{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ME("endBefore",this._value,e._path,!1);var t=function(e,t,n){let r,i;return i=e.index_===FI?C0(e,t="string"==typeof t?h0(t):t,n):(r=null==n?Mb:h0(n),C0(e,t,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(LS(t),MS(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new DS(e._repo,e._path,t,e._orderByCalled)}}class rk extends ek{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ME("startAt",this._value,e._path,!0);var t=k0(e._queryParams,this._value,this._key);if(LS(t),MS(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new DS(e._repo,e._path,t,e._orderByCalled)}}class ik extends ek{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ME("startAfter",this._value,e._path,!1);var t=function(t,n,r){let i;if(t.index_===FI)"string"==typeof n&&(n=u0(n)),i=k0(t,n,r);else{let e;e=null==r?Lb:u0(r),i=k0(t,n,e)}return i.startAfterSet_=!0,i}(e._queryParams,this._value,this._key);if(LS(t),MS(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new DS(e._repo,e._path,t,e._orderByCalled)}}class sk extends ek{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new DS(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class ok extends ek{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new DS(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class ak extends ek{constructor(e){super(),this._path=e}_apply(e){OS(e,"orderByChild");var t=new pI(this._path);if(TI(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");t=new l0(t),t=A0(e._queryParams,t);return MS(t),new DS(e._repo,e._path,t,!0)}}class ck extends ek{_apply(e){OS(e,"orderByKey");var t=A0(e._queryParams,FI);return MS(t),new DS(e._repo,e._path,t,!0)}}class lk extends ek{_apply(e){OS(e,"orderByPriority");var t=A0(e._queryParams,YI);return MS(t),new DS(e._repo,e._path,t,!0)}}class uk extends ek{_apply(e){OS(e,"orderByValue");var t=A0(e._queryParams,d0);return MS(t),new DS(e._repo,e._path,t,!0)}}class hk extends ek{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(ME("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new tk(this._value,this._key)._apply(new rk(this._value,this._key)._apply(e))}}function dk(e,...t){let n=Kd(e);for(const r of t)n=r._apply(n);return n}db=FS,Yh(!VT,"__referenceConstructor has already been defined"),VT=db,fb=FS,Yh(!XT,"__referenceConstructor has already been defined"),XT=fb;const fk="FIREBASE_DATABASE_EMULATOR_HOST",pk={};let gk=!1;function mk(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||xb("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rb("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=CS(s,i),a=o.repoInfo,c,l=void 0;"undefined"!=typeof process&&(l=process.env[fk]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=CS(s,i),a=o.repoInfo):c=!o.repoInfo.secure;var u=i&&c?new Gb(Gb.OWNER):new Hb(e.name,e.options,t);YE("Invalid Firebase Database URL",o),TI(o.path)||xb("Database URL must point to the root of a Firebase Database (not including a child path).");u=function(e,t,n,r){let i=pk[t.name];i||(i={},pk[t.name]=i);var s=i[e.toURLString()];s&&xb("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new iS(e,gk,n,r),i[e.toURLString()]=s}(a,e,u,new zb(e.name,n));return new vk(u,e)}class vk{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(sS(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new FS(this._repo,gI())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=pk[t];n&&n[e.key]===e||xb(`Database ${t}(${e.repoInfo_}) has already been deleted.`),mS(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&xb("Cannot call "+e+" on a deleted database.")}}function yk(e,t,n,r={}){(e=Kd(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&xb("Cannot call useEmulator() after instance has already been initialized.");var i,s=e._repoInternal;let o=void 0;s.repoInfo_.nodeAdmin?(r.mockUserToken&&xb('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Gb(Gb.OWNER)):r.mockUserToken&&(i="string"==typeof r.mockUserToken?r.mockUserToken:id(r.mockUserToken,e.app.options.projectId),o=new Gb(i)),r=s,e=t,t=n,n=o,r.repoInfo_=new Xb(`${e}:${t}`,!1,r.repoInfo_.namespace,r.repoInfo_.webSocketOnly,r.repoInfo_.nodeAdmin,r.repoInfo_.persistenceKey,r.repoInfo_.includeNamespaceInQueryParams),n&&(r.authTokenProvider_=n)}function _k(e){(e=Kd(e))._checkNotDeleted("goOnline"),(e=e._repo).persistentConnection_&&e.persistentConnection_.resume(nS)}function wk(e,t){Nb(e,t)}const bk={".sv":"timestamp"};class Ik{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Tk(i,e,t){if(i=Kd(i),VE("Reference.transaction",i._path),".length"===i.key||".keys"===i.key)throw"Reference.transaction failed: "+i.key+" is a read-only object.";var n=null===(r=null==t?void 0:t.applyLocally)||void 0===r||r;const s=new rd;var r=GS(i,()=>{});return function(t,n,e,r,i,s){vS(t,"transaction on "+n);const o={path:n,update:e,onComplete:r,status:null,order:_b(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=_S(t,n,void 0);o.currentInputSnapshot=a;var c=o.update(a.val());if(void 0===c)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{GE("transaction failed: Data returned ",c,o.path),o.status=0;var l=AE(t.transactionQueueTree_,n);const u=NE(l)||[];u.push(o),RE(l,u);let e;if("object"==typeof c&&null!==c&&bd(c,".priority"))e=Id(c,".priority"),Yh(HE(e),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{const h=aE(t.serverSyncTree_,n)||i0.EMPTY_NODE;e=h.getPriority().val()}l=aS(t),c=c0(c,e),l=SE(c,a,l);o.currentOutputSnapshotRaw=c,o.currentOutputSnapshotResolved=l,o.currentWriteId=hS(t);l=tE(t.serverSyncTree_,n,l,o.currentWriteId,o.applyLocally);eS(t.eventQueue_,n,l),wS(t,t.transactionQueueTree_)}}(i._repo,i._path,e,(e,t,n)=>{var r;e?s.reject(e):(r=new US(n,new FS(i._repo,i._path),YI),s.resolve(new Ik(t,r)))},r,n),s.promise}PI.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},PI.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},ob(Rf),kf(new Wd("database",(e,{instanceIdentifier:t})=>{return mk(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)},"PUBLIC").setMultipleInstances(!0)),Of(ib,"0.12.5",pb),Of(ib,"0.12.5","esm2017");function Ek(e){var t="FIREBASE WARNING: "+e;Sk.warn(t)}const Sk=new ef("@firebase/database-compat");class kk{constructor(e){this._delegate=e}cancel(t){Od("OnDisconnect.cancel",0,1,arguments.length),Ld("OnDisconnect.cancel","onComplete",t,!0);const e=this._delegate.cancel();return t&&e.then(()=>t(null),e=>t(e)),e}remove(t){Od("OnDisconnect.remove",0,1,arguments.length),Ld("OnDisconnect.remove","onComplete",t,!0);const e=this._delegate.remove();return t&&e.then(()=>t(null),e=>t(e)),e}set(e,t){Od("OnDisconnect.set",1,2,arguments.length),Ld("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then(()=>t(null),e=>t(e)),n}setWithPriority(e,t,n){Od("OnDisconnect.setWithPriority",2,3,arguments.length),Ld("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then(()=>n(null),e=>n(e)),r}update(t,n){if(Od("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){const r={};for(let e=0;e<t.length;++e)r[""+e]=t[e];t=r,Ek("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ld("OnDisconnect.update","onComplete",n,!0);const e=this._delegate.update(t);return n&&e.then(()=>n(null),e=>n(e)),e}}class Ck{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Od("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Ak{constructor(e,t){this._database=e,this._delegate=t}val(){return Od("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Od("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Od("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Od("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Od("DataSnapshot.child",0,1,arguments.length),e=String(e),QE("DataSnapshot.child","path",e,!1),new Ak(this._database,this._delegate.child(e))}hasChild(e){return Od("DataSnapshot.hasChild",1,1,arguments.length),QE("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return Od("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(t){return Od("DataSnapshot.forEach",1,1,arguments.length),Ld("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(e=>t(new Ak(this._database,e)))}hasChildren(){return Od("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Od("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Od("DataSnapshot.ref",0,0,arguments.length),new Rk(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Nk{constructor(e,t){this.database=e,this._delegate=t}on(e,n,t,r){var i;Od("Query.on",2,4,arguments.length),Ld("Query.on","callback",n,!1);const s=Nk.getCancelAndContextArgs_("Query.on",t,r);var o=(e,t)=>{n.call(s.context,new Ak(this.database,e),t)};o.userCallback=n,o.context=s.context;var a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return GS(this._delegate,o,a),n;case"child_added":return QS(this._delegate,o,a),n;case"child_removed":return XS(this._delegate,o,a),n;case"child_changed":return YS(this._delegate,o,a),n;case"child_moved":return JS(this._delegate,o,a),n;default:throw new Error(Md("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){var r;Od("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Md(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),Ld("Query.off","callback",t,!0),Fd("Query.off","context",n,!0),t?((r=()=>{}).userCallback=t,r.context=n,ZS(this._delegate,e,r)):ZS(this._delegate,e)}get(){return KS(this._delegate).then(e=>new Ak(this.database,e))}once(e,r,t,n){Od("Query.once",1,4,arguments.length),Ld("Query.once","callback",r,!0);const i=Nk.getCancelAndContextArgs_("Query.once",t,n),s=new rd;var o=(e,t)=>{var n=new Ak(this.database,e);r&&r.call(i.context,n,t),s.resolve(n)};o.userCallback=r,o.context=i.context;var a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":GS(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":QS(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":XS(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":YS(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":JS(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(Md("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return Od("Query.limitToFirst",1,1,arguments.length),new Nk(this.database,dk(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new sk(e)}(e)))}limitToLast(e){return Od("Query.limitToLast",1,1,arguments.length),new Nk(this.database,dk(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new ok(e)}(e)))}orderByChild(e){return Od("Query.orderByChild",1,1,arguments.length),new Nk(this.database,dk(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return QE("orderByChild","path",e,!1),new ak(e)}(e)))}orderByKey(){return Od("Query.orderByKey",0,0,arguments.length),new Nk(this.database,dk(this._delegate,new ck))}orderByPriority(){return Od("Query.orderByPriority",0,0,arguments.length),new Nk(this.database,dk(this._delegate,new lk))}orderByValue(){return Od("Query.orderByValue",0,0,arguments.length),new Nk(this.database,dk(this._delegate,new uk))}startAt(e=null,t){return Od("Query.startAt",0,2,arguments.length),new Nk(this.database,dk(this._delegate,([e=null,t]=[e,t],UE("startAt","key",t,!0),new rk(e,t))))}startAfter(e=null,t){return Od("Query.startAfter",0,2,arguments.length),new Nk(this.database,dk(this._delegate,(e=e,t=t,UE("startAfter","key",t,!0),new ik(e,t))))}endAt(e=null,t){return Od("Query.endAt",0,2,arguments.length),new Nk(this.database,dk(this._delegate,(e=e,t=t,UE("endAt","key",t,!0),new tk(e,t))))}endBefore(e=null,t){return Od("Query.endBefore",0,2,arguments.length),new Nk(this.database,dk(this._delegate,(e=e,t=t,UE("endBefore","key",t,!0),new nk(e,t))))}equalTo(e,t){return Od("Query.equalTo",1,2,arguments.length),new Nk(this.database,dk(this._delegate,(e=e,t=t,UE("equalTo","key",t,!0),new hk(e,t))))}toString(){return Od("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Od("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Od("Query.isEqual",1,1,arguments.length),e instanceof Nk)return this._delegate.isEqual(e._delegate);throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Ld(e,"cancel",r.cancel,!0),r.context=n,Fd(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Md(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new Rk(this.database,new FS(this._delegate._repo,this._delegate._path))}}class Rk extends Nk{constructor(e,t){super(e,new DS(t._repo,t._path,new S0,!1)),this.database=e,this._delegate=t}getKey(){return Od("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Od("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Rk(this.database,qS(this._delegate,e))}getParent(){Od("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new Rk(this.database,e):null}getRoot(){return Od("Reference.root",0,0,arguments.length),new Rk(this.database,this._delegate.root)}set(e,t){Od("Reference.set",1,2,arguments.length),Ld("Reference.set","onComplete",t,!0);const n=BS(this._delegate,e);return t&&n.then(()=>t(null),e=>t(e)),n}update(t,n){if(Od("Reference.update",1,2,arguments.length),Array.isArray(t)){const r={};for(let e=0;e<t.length;++e)r[""+e]=t[e];t=r,Ek("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}VE("Reference.update",this._delegate._path),Ld("Reference.update","onComplete",n,!0);const e=$S(this._delegate,t);return n&&e.then(()=>n(null),e=>n(e)),e}setWithPriority(e,t,n){Od("Reference.setWithPriority",2,3,arguments.length),Ld("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(VE("setWithPriority",e._path),ME("setWithPriority",t,e._path,!1),FE("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new rd;return dS(e._repo,e._path,t,n,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return n&&r.then(()=>n(null),e=>n(e)),r}remove(t){Od("Reference.remove",0,1,arguments.length),Ld("Reference.remove","onComplete",t,!0);const e=(n=this._delegate,VE("remove",n._path),BS(n,null));var n;return t&&e.then(()=>t(null),e=>t(e)),e}transaction(e,t,n){Od("Reference.transaction",1,3,arguments.length),Ld("Reference.transaction","transactionUpdate",e,!1),Ld("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Md(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=Tk(this._delegate,e,{applyLocally:n}).then(e=>new Ck(e.committed,new Ak(this.database,e.snapshot)));return t&&r.then(e=>t(null,e.committed,e.snapshot),e=>t(e,!1,null)),r}setPriority(e,t){Od("Reference.setPriority",1,2,arguments.length),Ld("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=Kd(e),VE("setPriority",e._path),FE("setPriority",t,!1);const n=new rd;return dS(e._repo,II(e._path,".priority"),t,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return t&&n.then(()=>t(null),e=>t(e)),n}push(e,t){Od("Reference.push",0,2,arguments.length),Ld("Reference.push","onComplete",t,!0);const n=function(e,t){e=Kd(e),VE("push",e._path),ME("push",t,e._path,!0);var n=oS(e._repo),n=v0(n);const r=qS(e,n),i=qS(e,n);let s;return s=null!=t?BS(i,t).then(()=>i):Promise.resolve(i),r.then=s.then.bind(s),r.catch=s.then.bind(s,void 0),r}(this._delegate,e),r=n.then(e=>new Rk(this.database,e));t&&r.then(()=>t(null),e=>t(e));const i=new Rk(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return VE("Reference.onDisconnect",this._delegate._path),new kk(new PS(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class xk{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(e,t,n={}){yk(this._delegate,e,t,n)}ref(e){if(Od("database.ref",0,1,arguments.length),e instanceof Rk){var t=VS(this._delegate,e.toString());return new Rk(this,t)}t=jS(this._delegate,e);return new Rk(this,t)}refFromURL(e){Od("database.refFromURL",1,1,arguments.length);var t=VS(this._delegate,e);return new Rk(this,t)}goOffline(){var e;Od("database.goOffline",0,0,arguments.length),(e=Kd(e=this._delegate))._checkNotDeleted("goOffline"),mS(e._repo)}goOnline(){return Od("database.goOnline",0,0,arguments.length),_k(this._delegate)}}xk.ServerValue={TIMESTAMP:bk,increment:e=>({".sv":{increment:e}})};var Pk,Dk=Object.freeze({__proto__:null,initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){ob(n);const o=new Hd("auth-internal",new Gd("database-standalone"));return o.setComponent(new Wd("auth-internal",()=>r,"PRIVATE")),{instance:new xk(mk(e,o,void 0,t,s),e),namespace:i}}});const Ok=xk.ServerValue;(Pk=Xf).INTERNAL.registerComponent(new Wd("database-compat",(e,{instanceIdentifier:t})=>{var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new xk(r,n)},"PUBLIC").setServiceProps({Reference:Rk,Query:Nk,Database:xk,DataSnapshot:Ak,enableLogging:wk,INTERNAL:Dk,ServerValue:Ok}).setMultipleInstances(!0)),Pk.registerVersion("@firebase/database-compat","0.1.5");var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Mk={},Lk=l||self;function Fk(){}function Uk(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function jk(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Vk="closure_uid_"+(1e9*Math.random()>>>0),qk=0;function Bk(e,t,n){return e.call.apply(e.bind,arguments)}function $k(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function Kk(e,t,n){return(Kk=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Bk:$k).apply(null,arguments)}function Wk(t){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function zk(e,s){function t(){}t.prototype=s.prototype,e.Z=s.prototype,e.prototype=new t,(e.prototype.constructor=e).Vb=function(e,t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return s.prototype[t].apply(e,r)}}function Hk(){this.s=this.s,this.o=this.o}var Gk={};Hk.prototype.s=!1,Hk.prototype.na=function(){var e,t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,e=Object.prototype.hasOwnProperty.call(t,Vk)&&t[Vk]||(t[Vk]=++qk),delete Gk[e])},Hk.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Qk=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Yk=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){var r=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function Jk(){return Array.prototype.concat.apply([],arguments)}function Xk(t){var n=t.length;if(0<n){const r=Array(n);for(let e=0;e<n;e++)r[e]=t[e];return r}return[]}function Zk(e){return/^[\s\xa0]*$/.test(e)}var eC,tC=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function nC(e,t){return-1!=e.indexOf(t)}function rC(e,t){return e<t?-1:t<e?1:0}e:{var iC=Lk.navigator;if(iC){iC=iC.userAgent;if(iC){eC=iC;break e}}eC=""}function sC(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function oC(e){const t={};for(const n in e)t[n]=e[n];return t}var aC="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cC(t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(let e=0;e<aC.length;e++)n=aC[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lC(e){return lC[" "](e),e}lC[" "]=Fk;var uC,hC=nC(eC,"Opera"),dC=nC(eC,"Trident")||nC(eC,"MSIE"),fC=nC(eC,"Edge"),pC=fC||dC,gC=nC(eC,"Gecko")&&!(nC(eC.toLowerCase(),"webkit")&&!nC(eC,"Edge"))&&!(nC(eC,"Trident")||nC(eC,"MSIE"))&&!nC(eC,"Edge"),mC=nC(eC.toLowerCase(),"webkit")&&!nC(eC,"Edge");function vC(){var e=Lk.document;return e?e.documentMode:void 0}e:{var yC="",_C=(_C=eC,gC?/rv:([^\);]+)(\)|;)/.exec(_C):fC?/Edge\/([\d\.]+)/.exec(_C):dC?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(_C):mC?/WebKit\/(\S+)/.exec(_C):hC?/(?:Version)[ \/]?(\S+)/.exec(_C):void 0);if(_C&&(yC=_C?_C[1]:""),dC){_C=vC();if(null!=_C&&_C>parseFloat(yC)){uC=String(_C);break e}}uC=yC}var wC={};function bC(){return e=function(){let e=0;var t=tC(String(uC)).split("."),n=tC("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++)for(var i=t[o]||"",s=n[o]||"";i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=i[0].length||0!=s[0].length)&&(e=rC(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||rC(0==i[2].length,0==s[2].length)||rC(i[2],s[2]),i=i[3],s=s[3],0==e););return 0<=e},t=wC,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9);var e,t}var IC=Lk.document&&dC&&(vC()||parseInt(uC,10))||void 0,TC=function(){if(!Lk.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Lk.addEventListener("test",Fk,t),Lk.removeEventListener("test",Fk,t)}catch(e){}return e}();function EC(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function SC(e,t){if(EC.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(gC){e:{try{lC(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:kC[e.pointerType]||"",this.state=e.state,(this.i=e).defaultPrevented&&SC.Z.h.call(this)}}EC.prototype.h=function(){this.defaultPrevented=!0},zk(SC,EC);var kC={2:"touch",3:"pen",4:"mouse"};SC.prototype.h=function(){SC.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var CC="closure_listenable_"+(1e6*Math.random()|0),AC=0;function NC(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++AC,this.ca=this.fa=!1}function RC(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function xC(e){this.src=e,this.g={},this.h=0}function PC(e,t){var n,r,i,s=t.type;s in e.g&&(n=e.g[s],(i=0<=(r=Qk(n,t)))&&Array.prototype.splice.call(n,r,1),i&&(RC(t),0==e.g[s].length&&(delete e.g[s],e.h--)))}function DC(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}xC.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=DC(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new NC(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var OC="closure_lm_"+(1e6*Math.random()|0),MC={};function LC(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,s){if(Array.isArray(n)){for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);return null}r=$C(r);return t&&t[CC]?t.O(n,r,jk(i)?!!i.capture:!!i,s):FC(t,n,r,!0,i,s)}(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)LC(e,t[s],n,r,i);return null}return n=$C(n),e&&e[CC]?e.N(t,n,jk(r)?!!r.capture:!!r,i):FC(e,t,n,!1,r,i)}function FC(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o,a=jk(i)?!!i.capture:!!i,c=qC(e);if(c||(e[OC]=c=new xC(e)),(n=c.add(t,n,r,a,s)).proxy)return n;if(o=VC,r=function e(t){return o.call(e.src,e.listener,t)},(n.proxy=r).src=e,r.listener=n,e.addEventListener)void 0===(i=!TC?a:i)&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(jC(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function UC(e){var t,n,r;"number"!=typeof e&&e&&!e.ca&&((t=e.src)&&t[CC]?PC(t.i,e):(n=e.type,r=e.proxy,t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(jC(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=qC(t))?(PC(n,e),0==n.h&&(n.src=null,t[OC]=null)):RC(e)))}function jC(e){return e in MC?MC[e]:MC[e]="on"+e}function VC(e,t){var n,r;return e=!!e.ca||(t=new SC(t,this),n=e.listener,r=e.ia||e.src,e.fa&&UC(e),n.call(r,t))}function qC(e){return(e=e[OC])instanceof xC?e:null}var BC="__closure_events_fn_"+(1e9*Math.random()>>>0);function $C(t){return"function"==typeof t?t:(t[BC]||(t[BC]=function(e){return t.handleEvent(e)}),t[BC])}function KC(){Hk.call(this),this.i=new xC(this),(this.P=this).I=null}function WC(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t?t=new EC(t,e):t instanceof EC?t.target=t.target||e:(o=t,cC(t=new EC(r,e),o)),o=!0,n)for(var i=n.length-1;0<=i;i--)var s=t.g=n[i],o=zC(s,r,!0,t)&&o;if(o=zC(s=t.g=e,r,!0,t)&&o,o=zC(s,r,!1,t)&&o,n)for(i=0;i<n.length;i++)o=zC(s=t.g=n[i],r,!1,t)&&o}function zC(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o,a,c=t[s];c&&!c.ca&&c.capture==n&&(o=c.listener,a=c.ia||c.src,c.fa&&PC(e.i,c),i=!1!==o.call(a,r)&&i)}return i&&!r.defaultPrevented}zk(KC,Hk),KC.prototype[CC]=!0,KC.prototype.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,s){if(Array.isArray(n))for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);else i=jk(i)?!!i.capture:!!i,r=$C(r),t&&t[CC]?(t=t.i,(n=String(n).toString())in t.g&&-1<(r=DC(o=t.g[n],r,i,s))&&(RC(o[r]),Array.prototype.splice.call(o,r,1),0==o.length&&(delete t.g[n],t.h--))):(t=t&&qC(t))&&(n=t.g[n.toString()],(r=(t=-1)<(t=n?DC(n,r,i,s):t)?n[t]:null)&&UC(r))}(this,e,t,n,r)},KC.prototype.M=function(){if(KC.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)RC(n[r]);delete t.g[e],t.h--}}this.I=null},KC.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},KC.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var HC=Lk.JSON.stringify;var GC,QC=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new YC,e=>e.reset());class YC{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function JC(e,t){var n;GC||(n=Lk.Promise.resolve(void 0),GC=function(){n.then(eA)}),XC||(GC(),XC=!0),ZC.add(e,t)}var XC=!1,ZC=new class{constructor(){this.h=this.g=null}add(e,t){const n=QC.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function eA(){for(var e;e=function(){var e=ZC;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}();){try{e.h.call(e.g)}catch(e){!function(e){Lk.setTimeout(()=>{throw e},0)}(e)}var t=QC;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}XC=!1}function tA(e,t){KC.call(this),this.h=e||1,this.g=t||Lk,this.j=Kk(this.kb,this),this.l=Date.now()}function nA(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function rA(e,t,n){if("function"==typeof e)n&&(e=Kk(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Kk(e.handleEvent,e)}return 2147483647<Number(t)?-1:Lk.setTimeout(e,t||0)}zk(tA,KC),(ze=tA.prototype).da=!1,ze.S=null,ze.kb=function(){var e;this.da&&(0<(e=Date.now()-this.l)&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),WC(this,"tick"),this.da&&(nA(this),this.start())))},ze.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ze.M=function(){tA.Z.M.call(this),nA(this),delete this.g};class iA extends Hk{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=rA(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.j);var n=t.h;t.h=null,t.m.apply(null,n)}(this)}M(){super.M(),this.g&&(Lk.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sA(e){Hk.call(this),this.h=e,this.g={}}zk(sA,Hk);var oA=[];function aA(e,t,n,r){Array.isArray(n)||(n&&(oA[0]=n.toString()),n=oA);for(var i=0;i<n.length;i++){var s=LC(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function cA(e){sC(e.g,function(e,t){this.g.hasOwnProperty(t)&&UC(e)},e),e.g={}}function lA(){this.g=!0}function uA(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return HC(n)}catch(e){return t}}(e,n)+(r?" "+r:"")})}sA.prototype.M=function(){sA.Z.M.call(this),cA(this)},sA.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},lA.prototype.Aa=function(){this.g=!1},lA.prototype.info=function(){};var hA={},dA=null;function fA(){return dA=dA||new KC}function pA(e){EC.call(this,hA.Ma,e)}function gA(){var e=fA();WC(e,new pA(e))}function mA(e,t){EC.call(this,hA.STAT_EVENT,e),this.stat=t}function vA(e){var t=fA();WC(t,new mA(t,e))}function yA(e,t){EC.call(this,hA.Na,e),this.size=t}function _A(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Lk.setTimeout(function(){e()},t)}hA.Ma="serverreachability",zk(pA,EC),hA.STAT_EVENT="statevent",zk(mA,EC),hA.Na="timingevent",zk(yA,EC);c={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},yt={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function wA(){}function bA(e){return e.h||(e.h=e.i())}function IA(){}wA.prototype.h=null;l={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function TA(){EC.call(this,"d")}function EA(){EC.call(this,"c")}function SA(){}function kA(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new sA(this),this.P=NA,this.W=new tA(e=pC?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new CA}function CA(){this.i=null,this.g="",this.h=!1}zk(TA,EC),zk(EA,EC),zk(SA,wA),SA.prototype.g=function(){return new XMLHttpRequest},SA.prototype.i=function(){return{}};var AA=new SA,NA=45e3,RA={},xA={};function PA(e,t,n){e.K=1,e.v=eN(GA(t)),e.s=n,e.U=!0,DA(e,null)}function DA(e,t){e.F=Date.now(),LA(e),e.A=GA(e.v);var o,a,c,l,u,h,n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),fN(n.h,"t",r),e.C=0,n=e.l.H,e.h=new CA,e.g=fR(e.l,n?t:null,!e.s),0<e.O&&(e.L=new iA(Kk(e.Ia,e,e.g),e.O)),aA(e.V,e.g,"readystatechange",e.gb),t=e.H?oC(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),gA(),o=e.j,a=e.u,c=e.A,l=e.m,u=e.X,h=e.s,o.info(function(){if(o.g)if(h)for(var e="",t=h.split("&"),n=0;n<t.length;n++){var r,i,s=t[n].split("=");1<s.length&&(r=s[0],s=s[1],e=2<=(i=r.split("_")).length&&"type"==i[1]?e+(r+"=")+s+"&":e+(r+"=redacted&"))}else e=null;else e=h;return"XMLHTTP REQ ("+l+") [attempt "+u+"]: "+a+"\n"+c+"\n"+e})}function OA(e){return e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function MA(e,t,n){let r=!0,i;for(;!e.I&&e.C<n.length;){if(i=(o=n,c=a=void 0,a=(s=e).C,-1==(c=o.indexOf("\n",a))?xA:(a=Number(o.substring(a,c)),isNaN(a)?RA:(c+=1)+a>o.length?xA:(o=o.substr(c,a),s.C=c+a,o))),i==xA){4==t&&(e.o=4,vA(14),r=!1),uA(e.j,e.m,null,"[Incomplete Response]");break}if(i==RA){e.o=4,vA(15),uA(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}uA(e.j,e.m,i,null),qA(e,i)}var s,o,a,c;OA(e)&&i!=xA&&i!=RA&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,vA(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),sR(t),t.L=!0,vA(11))):(uA(e.j,e.m,n,"[Invalid Chunked Response]"),VA(e),jA(e))}function LA(e){e.Y=Date.now()+e.P,FA(e,e.P)}function FA(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=_A(Kk(e.eb,e),t)}function UA(e){e.B&&(Lk.clearTimeout(e.B),e.B=null)}function jA(e){0==e.l.G||e.I||cR(e.l,e)}function VA(e){UA(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,nA(e.W),cA(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function qA(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||wN(n.i,e)))if(n.I=e.N,!e.J&&wN(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;aR(n),YN(n)}iR(n),vA(18)}}else n.ta=i[1],0<n.ta-n.U&&i[2]<37500&&n.N&&0==n.A&&!n.v&&(n.v=_A(Kk(n.ab,n),6e3));if(_N(n.i)<=1&&n.ka){try{n.ka()}catch(e){}n.ka=void 0}}else uR(n,11)}else if(!e.J&&n.g!=e||aR(n),!Zk(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c,l,u,h=s[5];null!=h&&"number"==typeof h&&0<h&&(r=1.5*h,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const g=e.g;g&&(!(c=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null)||!(l=r.i).g&&(nC(c,"spdy")||nC(c,"quic")||nC(c,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(bN(l,l.h),l.h=null)),!r.D||(u=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null)&&(r.sa=u,ZA(r.F,r.D,u))),n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d,f,p=e;(r=n).oa=dR(r,r.H?r.la:null,r.W),p.J?(IN(r.i,p),d=p,(f=r.K)&&d.setTimeout(f),d.B&&(UA(d),LA(d)),r.g=p):rR(r),0<n.l.length&&ZN(n)}else"stop"!=s[0]&&"close"!=s[0]||uR(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?uR(n,7):QN(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}gA()}catch(e){}}function BA(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Uk(e)||"string"==typeof e)Yk(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(Uk(e)||"string"==typeof e)for(var n=[],r=e.length,i=0;i<r;i++)n.push(i);else for(i in n=[],r=0,e)n[r++]=i;for(var i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(Uk(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function $A(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof $A)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function KA(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];WA(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){for(var i={},n=t=0;t<e.g.length;)WA(i,r=e.g[t])||(i[e.g[n++]=r]=1),t++;e.g.length=n}}function WA(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(ze=kA.prototype).setTimeout=function(e){this.P=e},ze.gb=function(e){e=e.target;const t=this.L;t&&3==KN(e)?t.l():this.Ia(e)},ze.Ia=function(e){try{if(e==this.g)e:{var t=KN(this.g),n=this.g.Da();this.g.ba();if(!(t<3)&&(3!=t||pC||this.g&&(this.h.h||this.g.ga()||WN(this.g)))){this.I||4!=t||7==n||gA(),UA(this);var r=this.g.ba();this.N=r;t:if(OA(this)){var i=WN(this.g);e="";var s=i.length,o=4==KN(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){VA(this),jA(this);var a="";break t}this.h.i=new Lk.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==s-1});i.splice(0,s),this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.ga();if(this.i=200==r,h=this.j,d=this.u,f=this.A,p=this.m,g=this.X,m=t,v=r,h.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+g+"]: "+d+"\n"+f+"\n"+m+" "+v}),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Zk(c)){var u=c;break t}}u=null}if(!(r=u)){this.i=!1,this.o=3,vA(12),VA(this),jA(this);break e}uA(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,qA(this,r)}this.U?(MA(this,t,a),pC&&this.i&&3==t&&(aA(this.V,this.W,"tick",this.fb),this.W.start())):(uA(this.j,this.m,a,null),qA(this,a)),4==t&&VA(this),this.i&&!this.I&&(4==t?cR(this.l,this):(this.i=!1,LA(this)))}else 400==r&&0<a.indexOf("Unknown SID")?(this.o=3,vA(12)):(this.o=0,vA(13)),VA(this),jA(this)}}}catch(e){}var h,d,f,p,g,m,v},ze.fb=function(){var e,t;this.g&&(e=KN(this.g),t=this.g.ga(),this.C<t.length&&(UA(this),MA(this,e,t),this.i&&4!=e&&LA(this)))},ze.cancel=function(){this.I=!0,VA(this)},ze.eb=function(){this.B=null;var e,t,n=Date.now();0<=n-this.Y?(e=this.j,t=this.A,e.info(function(){return"TIMEOUT: "+t}),2!=this.K&&(gA(),vA(17)),VA(this),this.o=2,jA(this)):FA(this,this.Y-n)},(ze=$A.prototype).R=function(){KA(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},ze.T=function(){return KA(this),this.g.concat()},ze.get=function(e,t){return WA(this.h,e)?this.h[e]:t},ze.set=function(e,t){WA(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},ze.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var zA=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function HA(e,t){var n;this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof HA?(this.g=void 0!==t?t:e.g,QA(this,e.j),this.s=e.s,YA(this,e.i),JA(this,e.m),this.l=e.l,t=e.h,(n=new lN).i=t.i,t.g&&(n.g=new $A(t.g),n.h=t.h),XA(this,n),this.o=e.o):e&&(n=String(e).match(zA))?(this.g=!!t,QA(this,n[1]||"",!0),this.s=tN(n[2]||""),YA(this,n[3]||"",!0),JA(this,n[4]),this.l=tN(n[5]||"",!0),XA(this,n[6]||"",!0),this.o=tN(n[7]||"")):(this.g=!!t,this.h=new lN(null,this.g))}function GA(e){return new HA(e)}function QA(e,t,n){e.j=n?tN(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function YA(e,t,n){e.i=n?tN(t,!0):t}function JA(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.m=t}else e.m=null}function XA(e,t,n){var r,i;t instanceof lN?(e.h=t,r=e.h,(i=e.g)&&!r.j&&(uN(r),r.i=null,r.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(hN(this,t),fN(this,n,e))},r)),r.j=i):(n||(t=nN(t,aN)),e.h=new lN(t,e.g))}function ZA(e,t,n){e.h.set(t,n)}function eN(e){return ZA(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function tN(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function nN(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,rN),e=n?e.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):e):null}function rN(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}HA.prototype.toString=function(){var e=[],t=this.j;t&&e.push(nN(t,iN,!0),":");var n=this.i;return!n&&"file"!=t||(e.push("//"),(t=this.s)&&e.push(nN(t,iN,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(nN(n,"/"==n.charAt(0)?oN:sN,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",nN(n,cN)),e.join("")};var iN=/[#\/\?@]/g,sN=/[#\?:]/g,oN=/[#\?]/g,aN=/[#\?@]/g,cN=/#/g;function lN(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function uN(n){n.g||(n.g=new $A,n.h=0,n.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r,i=e[n].indexOf("="),s=null;0<=i?(r=e[n].substring(0,i),s=e[n].substring(i+1)):r=e[n],t(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function hN(e,t){uN(e),t=pN(e,t),WA(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,WA((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&KA(e)))}function dN(e,t){return uN(e),t=pN(e,t),WA(e.g.h,t)}function fN(e,t,n){hN(e,t),0<n.length&&(e.i=null,e.g.set(pN(e,t),Xk(n)),e.h+=n.length)}function pN(e,t){return t=String(t),t=e.j?t.toLowerCase():t}(ze=lN.prototype).add=function(e,t){uN(this),this.i=null,e=pN(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},ze.forEach=function(n,r){uN(this),this.g.forEach(function(e,t){Yk(e,function(e){n.call(r,e,t,this)},this)},this)},ze.T=function(){uN(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},ze.R=function(e){uN(this);var t=[];if("string"==typeof e)dN(this,e)&&(t=Jk(t,this.g.get(pN(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Jk(t,e[n])}return t},ze.set=function(e,t){return uN(this),this.i=null,dN(this,e=pN(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},ze.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},ze.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.R(r),s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}return this.i=e.join("&")};var gN=class{constructor(e,t){this.h=e,this.g=t}};function mN(e){this.l=e||10,e=Lk.PerformanceNavigationTiming?0<(e=Lk.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Lk.g&&Lk.g.Ea&&Lk.g.Ea()&&Lk.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vN;function yN(e){return e.h||e.g&&e.g.size>=e.j}function _N(e){return e.h?1:e.g?e.g.size:0}function wN(e,t){return e.h?e.h==t:e.g&&e.g.has(t)}function bN(e,t){e.g?e.g.add(t):e.h=t}function IN(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function TN(t){if(null!=t.h)return t.i.concat(t.h.D);if(null==t.g||0===t.g.size)return Xk(t.i);{let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}}function EN(){}function SN(){this.g=new EN}function kN(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function CN(e){this.l=e.$b||null,this.j=e.ib||!1}function AN(e,t){KC.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=NN,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mN.prototype.cancel=function(){if(this.i=TN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},EN.prototype.stringify=function(e){return Lk.JSON.stringify(e,void 0)},EN.prototype.parse=function(e){return Lk.JSON.parse(e,void 0)},zk(CN,wA),CN.prototype.g=function(){return new AN(this.l,this.j)},CN.prototype.i=(vN={},function(){return vN}),zk(AN,KC);var NN=0;function RN(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function xN(e){e.readyState=4,e.l=null,e.j=null,e.A=null,PN(e)}function PN(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(ze=AN.prototype).open=function(e,t){if(this.readyState!=NN)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,PN(this)},ze.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Lk).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},ze.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xN(this)),this.readyState=NN},ze.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,PN(this)),this.g&&(this.readyState=3,PN(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Lk.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;RN(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},ze.Sa=function(e){var t;this.g&&(this.u&&e.value?this.response.push(e.value):this.u||(t=e.value||new Uint8Array(0),(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)),(e.done?xN:PN)(this),3==this.readyState&&RN(this))},ze.Ua=function(e){this.g&&(this.response=this.responseText=e,xN(this))},ze.Ta=function(e){this.g&&(this.response=e,xN(this))},ze.ha=function(){this.g&&xN(this)},ze.setRequestHeader=function(e,t){this.v.append(e,t)},ze.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},ze.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(AN.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var DN=Lk.JSON.parse;function ON(e){KC.call(this),this.headers=new $A,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=MN,this.K=this.L=!1}zk(ON,KC);var MN="",LN=/^https?$/i,FN=["POST","PUT"];function UN(e){return"content-type"==e.toLowerCase()}function jN(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,VN(e),BN(e)}function VN(e){e.D||(e.D=!0,WC(e,"complete"),WC(e,"error"))}function qN(e){if(e.h&&void 0!==Mk&&(!e.C[1]||4!=KN(e)||2!=e.ba()))if(e.v&&4==KN(e))rA(e.Fa,0,e);else if(WC(e,"readystatechange"),4==KN(e)){e.h=!1;try{var t,n,r,i,s=e.ba();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break e;default:o=!1}if((t=o)||((n=0===s)&&(!(i=String(e.H).match(zA)[1]||null)&&Lk.self&&Lk.self.location&&(i=(r=Lk.self.location.protocol).substr(0,r.length-1)),n=!LN.test(i?i.toLowerCase():"")),t=n),t)WC(e,"complete"),WC(e,"success");else{e.m=6;try{var a=2<KN(e)?e.g.statusText:""}catch(e){a=""}e.j=a+" ["+e.ba()+"]",VN(e)}}finally{BN(e)}}}function BN(e,t){if(e.g){$N(e);const n=e.g,r=e.C[0]?Fk:null;e.g=null,e.C=null,t||WC(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function $N(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Lk.clearTimeout(e.A),e.A=null)}function KN(e){return e.g?e.g.readyState:0}function WN(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case MN:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function zN(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){let n="";return sC(e,function(e,t){n+=t,n+=":",n+=e,n+="\r\n"}),n}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ZA(e,t,n))}function HN(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function GN(e){this.za=0,this.l=[],this.h=new lA,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=HN("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=HN("baseRetryDelayMs",5e3,e),this.$a=HN("retryDelaySeedMs",1e4,e),this.Ya=HN("forwardChannelMaxRetries",2,e),this.ra=HN("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new mN(e&&e.concurrentRequestLimit),this.Ca=new SN,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function QN(e){var t,n;JN(e),3==e.G&&(t=e.V++,ZA(n=GA(e.F),"SID",e.J),ZA(n,"RID",t),ZA(n,"TYPE","terminate"),tR(e,n),(t=new kA(e,e.h,t,void 0)).K=2,t.v=eN(GA(n)),n=!1,!(n=Lk.navigator&&Lk.navigator.sendBeacon?Lk.navigator.sendBeacon(t.v.toString(),""):n)&&Lk.Image&&((new Image).src=t.v,n=!0),n||(t.g=fR(t.l,null),t.g.ea(t.v)),t.F=Date.now(),LA(t)),hR(e)}function YN(e){e.g&&(sR(e),e.g.cancel(),e.g=null)}function JN(e){YN(e),e.u&&(Lk.clearTimeout(e.u),e.u=null),aR(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Lk.clearTimeout(e.m),e.m=null)}function XN(e,t){e.l.push(new gN(e.Za++,t)),3==e.G&&ZN(e)}function ZN(e){yN(e.i)||e.m||(e.m=!0,JC(e.Ha,e),e.C=0)}function eR(e,t){var n=t?t.m:e.V++,r=GA(e.F);ZA(r,"SID",e.J),ZA(r,"RID",n),ZA(r,"AID",e.U),tR(e,r),e.o&&e.s&&zN(r,e.o,e.s),n=new kA(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=nR(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),bN(e.i,n),PA(n,r,t)}function tR(e,n){e.j&&BA({},function(e,t){ZA(n,t,e)})}function nR(e,t,r){r=Math.min(e.l.length,r);var i=e.j?Kk(e.j.Oa,e.j,e):null;e:{var s=e.l;let n=-1;for(;;){const c=["count="+r];-1==n?0<r?(n=s[0].h,c.push("ofs="+n)):n=0:c.push("ofs="+n);let e=!0;for(let t=0;t<r;t++){var o=s[t].h,a=s[t].g;if((o-=n)<0)n=Math.max(0,s[t].h-100),e=!1;else try{!function(e,r,t){const i=t||"";try{BA(e,function(e,t){let n=e;jk(e)&&(n=HC(e)),r.push(i+t+"="+encodeURIComponent(n))})}catch(e){throw r.push(i+"type="+encodeURIComponent("_badmap")),e}}(a,c,"req"+o+"_")}catch(e){i&&i(a)}}if(e){i=c.join("&");break e}}}return e=e.l.splice(0,r),t.D=e,i}function rR(e){e.g||e.u||(e.Y=1,JC(e.Ga,e),e.A=0)}function iR(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=_A(Kk(e.Ga,e),lR(e,e.A)),e.A++,1)}function sR(e){null!=e.B&&(Lk.clearTimeout(e.B),e.B=null)}function oR(e){e.g=new kA(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=GA(e.oa);ZA(t,"RID","rpc"),ZA(t,"SID",e.J),ZA(t,"CI",e.N?"0":"1"),ZA(t,"AID",e.U),tR(e,t),ZA(t,"TYPE","xmlhttp"),e.o&&e.s&&zN(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=eN(GA(t)),n.s=null,n.U=!0,DA(n,e)}function aR(e){null!=e.v&&(Lk.clearTimeout(e.v),e.v=null)}function cR(e,t){var n,r,i,s=null;if(e.g==t){aR(e),sR(e),e.g=null;var o=2}else{if(!wN(e.i,t))return;s=t.D,IN(e.i,t),o=1}if(e.I=t.N,0!=e.G)if(t.i)1==o?(s=t.s?t.s.length:0,t=Date.now()-t.F,n=e.C,WC(o=fA(),new yA(o,s)),ZN(e)):rR(e);else if(3==(n=t.o)||0==n&&0<e.I||(1!=o||(i=t,_N((r=e).i)>=r.i.j-(r.m?1:0)||(r.m?(r.l=i.D.concat(r.l),0):1==r.G||2==r.G||r.C>=(r.Xa?0:r.Ya)||(r.m=_A(Kk(r.Ha,r,i),lR(r,r.C)),r.C++,0))))&&(2!=o||!iR(e)))switch(s&&0<s.length&&(t=e.i,t.i=t.i.concat(s)),n){case 1:uR(e,5);break;case 4:uR(e,10);break;case 3:uR(e,6);break;default:uR(e,2)}}function lR(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function uR(e,t){var n,r;e.h.info("Error code "+t),2==t?(n=null,e.j&&(n=null),r=Kk(e.jb,e),n||(n=new HA("//www.google.com/images/cleardot.gif"),Lk.location&&"http"==Lk.location.protocol||QA(n,"https"),eN(n)),function(e,t){var n=new lA;if(Lk.Image){const r=new Image;r.onload=Wk(kN,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Wk(kN,n,r,"TestLoadImage: error",!1,t),r.onabort=Wk(kN,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Wk(kN,n,r,"TestLoadImage: timeout",!1,t),Lk.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)):vA(2),e.G=0,e.j&&e.j.va(t),hR(e),JN(e)}function hR(e){e.G=0,e.I=-1,e.j&&(0==TN(e.i).length&&0==e.l.length||(e.i.i.length=0,Xk(e.l),e.l.length=0),e.j.ua())}function dR(e,t,n){let r=(a=n)instanceof HA?GA(a):new HA(a,void 0);var i,s,o,a,c;return""!=r.i?(t&&YA(r,t+"."+r.i),JA(r,r.m)):(c=Lk.location,r=(i=c.protocol,s=t?t+"."+c.hostname:c.hostname,o=+c.port,a=n,c=new HA(null,void 0),i&&QA(c,i),s&&YA(c,s),o&&JA(c,o),a&&(c.l=a),c)),e.aa&&sC(e.aa,function(e,t){ZA(r,t,e)}),t=e.D,n=e.sa,t&&n&&ZA(r,t,n),ZA(r,"VER",e.ma),tR(e,r),r}function fR(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new ON(new CN({ib:!0})):new ON(e.qa)).L=e.H,t}function pR(){}function gR(){if(dC&&!(10<=Number(IC)))throw Error("Environmental error: no available transport.")}function mR(e,t){KC.call(this),this.g=new GN(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Zk(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Zk(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new _R(this)}function vR(e){TA.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yR(){EA.call(this),this.status=1}function _R(e){this.g=e}(ze=ON.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=(this.u||AA).g(),this.C=this.u?bA(this.u):bA(AA),this.g.onreadystatechange=Kk(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void jN(this,e)}e=n||"";const i=new $A(this.headers);r&&BA(r,function(e,t){i.set(t,e)}),r=function(t){e:{var n=UN,r=t.length,i="string"==typeof t?t.split(""):t;for(let e=0;e<r;e++)if(e in i&&n.call(void 0,i[e],e,t)){n=e;break e}n=-1}return n<0?null:"string"==typeof t?t.charAt(n):t[n]}(i.T()),n=Lk.FormData&&e instanceof Lk.FormData,0<=Qk(FN,t)&&!r&&!n&&i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{$N(this),0<this.B&&((this.K=(s=this.g,dC&&bC()&&"number"==typeof s.timeout&&void 0!==s.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=Kk(this.pa,this)):this.A=rA(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){jN(this,e)}var s},ze.pa=function(){void 0!==Mk&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,WC(this,"timeout"),this.abort(8))},ze.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,WC(this,"complete"),WC(this,"abort"),BN(this))},ze.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),BN(this,!0)),ON.Z.M.call(this)},ze.Fa=function(){this.s||(this.F||this.v||this.l?qN(this):this.cb())},ze.cb=function(){qN(this)},ze.ba=function(){try{return 2<KN(this)?this.g.status:-1}catch(e){return-1}},ze.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},ze.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),DN(t)}},ze.Da=function(){return this.m},ze.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(ze=GN.prototype).ma=8,ze.G=1,ze.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},ze.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new kA(this,this.h,t,void 0);let e=this.s;if(this.P&&(e?(e=oC(e),cC(e,this.P)):e=this.P),null===this.o&&(s.H=e),this.ja)e:{for(var n=0,r=0;r<this.l.length;r++){var i=this.l[r];if("__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i=i.length:i=void 0,void 0===i)break;if(4096<(n+=i)){n=r;break e}if(4096===n||r===this.l.length-1){n=r+1;break e}}n=1e3}else n=1e3;n=nR(this,s,n),ZA(r=GA(this.F),"RID",t),ZA(r,"CVER",22),this.D&&ZA(r,"X-HTTP-Session-Id",this.D),tR(this,r),this.o&&e&&zN(r,this.o,e),bN(this.i,s),this.Ra&&ZA(r,"TYPE","init"),this.ja?(ZA(r,"$req",n),ZA(r,"SID","null"),s.$=!0,PA(s,r,null)):PA(s,r,n),this.G=2}}else 3==this.G&&(t?eR(this,t):0==this.l.length||yN(this.i)||eR(this))},ze.Ga=function(){var e;this.u=null,oR(this),this.$&&!(this.L||null==this.g||this.O<=0)&&(e=2*this.O,this.h.info("BP detection timer enabled: "+e),this.B=_A(Kk(this.bb,this),e))},ze.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,vA(10),YN(this),oR(this))},ze.ab=function(){null!=this.v&&(this.v=null,YN(this),iR(this),vA(19))},ze.jb=function(e){e?(this.h.info("Successfully pinged google.com"),vA(2)):(this.h.info("Failed to ping google.com"),vA(1))},(ze=pR.prototype).xa=function(){},ze.wa=function(){},ze.va=function(){},ze.ua=function(){},ze.Oa=function(){},gR.prototype.g=function(e,t){return new mR(e,t)},zk(mR,KC),mR.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),JC(Kk(e.hb,e,t))),vA(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=dR(e,null,e.W),ZN(e)},mR.prototype.close=function(){QN(this.g)},mR.prototype.u=function(e){var t;"string"==typeof e?((t={}).__data__=e,XN(this.g,t)):this.v?((t={}).__data__=HC(e),XN(this.g,t)):XN(this.g,e)},mR.prototype.M=function(){this.g.j=null,delete this.j,QN(this.g),delete this.g,mR.Z.M.call(this)},zk(vR,TA),zk(yR,EA),zk(_R,pR),_R.prototype.xa=function(){WC(this.g,"a")},_R.prototype.wa=function(e){WC(this.g,new vR(e))},_R.prototype.va=function(e){WC(this.g,new yR)},_R.prototype.ua=function(){WC(this.g,"b")},gR.prototype.createWebChannel=gR.prototype.g,mR.prototype.send=mR.prototype.u,mR.prototype.open=mR.prototype.m,c.NO_ERROR=0,c.TIMEOUT=8,c.HTTP_ERROR=6,yt.COMPLETE="complete",(IA.EventType=l).OPEN="a",l.CLOSE="b",l.ERROR="c",l.MESSAGE="d",KC.prototype.listen=KC.prototype.N,ON.prototype.listenOnce=ON.prototype.O,ON.prototype.getLastError=ON.prototype.La,ON.prototype.getLastErrorCode=ON.prototype.Da,ON.prototype.getStatus=ON.prototype.ba,ON.prototype.getResponseJson=ON.prototype.Qa,ON.prototype.getResponseText=ON.prototype.ga,ON.prototype.send=ON.prototype.ea;var wR,bR=fA,IR=c,TR=yt,ER=hA,SR=10,kR=11,CR=CN,AR=IA,NR=ON;const RR="@firebase/firestore";class xR{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xR.UNAUTHENTICATED=new xR(null),xR.GOOGLE_CREDENTIALS=new xR("google-credentials-uid"),xR.FIRST_PARTY=new xR("first-party-uid"),xR.MOCK_USER=new xR("mock-user");let PR="9.6.8";const DR=new ef("@firebase/firestore");function OR(){return DR.logLevel}function MR(e,...t){var n;DR.logLevel<=Kh.DEBUG&&(n=t.map(UR),DR.debug(`Firestore (${PR}): ${e}`,...n))}function LR(e,...t){var n;DR.logLevel<=Kh.ERROR&&(n=t.map(UR),DR.error(`Firestore (${PR}): ${e}`,...n))}function FR(e,...t){var n;DR.logLevel<=Kh.WARN&&(n=t.map(UR),DR.warn(`Firestore (${PR}): ${e}`,...n))}function UR(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function jR(e="Unexpected state"){var t=`FIRESTORE (${PR}) INTERNAL ASSERTION FAILED: `+e;throw LR(t),new Error(t)}function VR(e){e||jR()}const qR={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class BR extends gd{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class $R{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class KR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class WR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(xR.UNAUTHENTICATED))}shutdown(){}}class zR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class HR{constructor(e){this.t=e,this.currentUser=xR.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let r=this.i;const i=e=>this.i!==r?(r=this.i,n(e)):Promise.resolve();let s=new $R;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new $R,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const e=s;t.enqueueRetryable(async()=>{await e.promise,await i(this.currentUser)})},a=e=>{MR("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(e=>a(e)),setTimeout(()=>{var e;this.auth||((e=this.t.getImmediate({optional:!0}))?a(e):(MR("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new $R))},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(MR("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(VR("string"==typeof e.accessToken),new KR(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){var e=this.auth&&this.auth.getUid();return VR(null===e||"string"==typeof e),new xR(e)}}class GR{constructor(e,t,n){this.type="FirstParty",this.user=xR.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);var r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class QR{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new GR(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(xR.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class YR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&0<e.length&&this.headers.set("x-firebase-appcheck",this.value)}}class JR{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(t,n){const r=e=>{null!=e.error&&MR("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);var t=e.token!==this.p;return this.p=e.token,MR("FirebaseAppCheckTokenProvider",`Received ${t?"new":"existing"} token.`),t?n(e.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>r(e))};const i=e=>{MR("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.g.onInit(e=>i(e)),setTimeout(()=>{var e;this.appCheck||((e=this.g.getImmediate({optional:!0}))?i(e):MR("FirebaseAppCheckTokenProvider","AppCheck not yet detected"))},0)}getToken(){var e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(VR("string"==typeof e.token),this.p=e.token,new YR(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class XR{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.I(e),this.T=e=>t.writeSequenceNumber(e))}I(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){var e=++this.previousValue;return this.T&&this.T(e),e}}XR.A=-1;class ZR{static R(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){var i=function(t){const n="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(n&&"function"==typeof n.getRandomValues)n.getRandomValues(r);else for(let e=0;e<t;e++)r[e]=Math.floor(256*Math.random());return r}(40);for(let e=0;e<i.length;++e)r.length<20&&i[e]<n&&(r+=t.charAt(i[e]%t.length))}return r}}function ex(e,t){return e<t?-1:t<e?1:0}function tx(e,n,r){return e.length===n.length&&e.every((e,t)=>r(e,n[t]))}function nx(e){return e+"\0"}class rx{constructor(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new BR(qR.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new BR(qR.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new BR(qR.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new BR(qR.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rx.fromMillis(Date.now())}static fromDate(e){return rx.fromMillis(e.getTime())}static fromMillis(e){var t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new rx(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ex(this.nanoseconds,e.nanoseconds):ex(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ix{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ix(e)}static min(){return new ix(new rx(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function sx(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ox(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ax(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class cx{constructor(e,t,n){void 0===t?t=0:t>e.length&&jR(),void 0===n?n=e.length-t:n>e.length-t&&jR(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===cx.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof cx?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class lx extends cx{construct(e,t,n){return new lx(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(0<=n.indexOf("//"))throw new BR(qR.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>0<e.length))}return new lx(t)}static emptyPath(){return new lx([])}}const ux=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hx extends cx{construct(e,t,n){return new hx(e,t,n)}static isValidIdentifier(e){return ux.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e=!hx.isValidIdentifier(e)?"`"+e+"`":e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new hx(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;var i=()=>{if(0===n.length)throw new BR(qR.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new BR(qR.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new BR(qR.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?s=!s:"."!==t||s?n+=t:i(),r++}if(i(),s)throw new BR(qR.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hx(t)}static emptyPath(){return new hx([])}}class dx{constructor(e){(this.fields=e).sort(hx.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tx(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class fx{constructor(e){this.binaryString=e}static fromBase64String(e){var t=atob(e);return new fx(t)}static fromUint8Array(e){var t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new fx(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ex(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fx.EMPTY_BYTE_STRING=new fx("");const px=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gx(t){if(VR(!!t),"string"!=typeof t)return{seconds:mx(t.seconds),nanos:mx(t.nanos)};{let e=0;var n=px.exec(t);VR(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}}function mx(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function vx(e){return"string"==typeof e?fx.fromBase64String(e):fx.fromUint8Array(e)}function yx(e){var t;return"server_timestamp"===(null===(t=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function _x(e){var t=gx(e.mapValue.fields.__local_write_time__.timestampValue);return new rx(t.seconds,t.nanos)}class wx{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class bx{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new bx("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof bx&&e.projectId===this.projectId&&e.database===this.database}}function Ix(e){return null==e}function Tx(e){return 0===e&&1/e==-1/0}function Ex(e){return"number"==typeof e&&Number.isInteger(e)&&!Tx(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}class Sx{constructor(e){this.path=e}static fromPath(e){return new Sx(lx.fromString(e))}static fromName(e){return new Sx(lx.fromString(e).popFirst(5))}static empty(){return new Sx(lx.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return 2<=this.path.length&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===lx.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return lx.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Sx(new lx(e.slice()))}}const kx={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Cx={nullValue:"NULL_VALUE"};function Ax(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?yx(e)?4:qx(e)?9:10:jR()}function Nx(r,i){if(r===i)return!0;var e,t,n=Ax(r);if(n!==Ax(i))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return _x(r).isEqual(_x(i));case 3:return function(e){if("string"==typeof r.timestampValue&&"string"==typeof e.timestampValue&&r.timestampValue.length===e.timestampValue.length)return r.timestampValue===e.timestampValue;var t=gx(r.timestampValue),n=gx(e.timestampValue);return t.seconds===n.seconds&&t.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,vx(r.bytesValue).isEqual(vx(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,mx((t=r).geoPointValue.latitude)===mx(e.geoPointValue.latitude)&&mx(t.geoPointValue.longitude)===mx(e.geoPointValue.longitude);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return mx(e.integerValue)===mx(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=mx(e.doubleValue),r=mx(t.doubleValue);return n===r?Tx(n)===Tx(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return tx(r.arrayValue.values||[],i.arrayValue.values||[],Nx);case 10:return function(e){const t=e.mapValue.fields||{},n=i.mapValue.fields||{};if(sx(t)!==sx(n))return!1;for(const e in t)if(t.hasOwnProperty(e)&&(void 0===n[e]||!Nx(t[e],n[e])))return!1;return!0}(r);default:return jR()}}function Rx(e,t){return void 0!==(e.values||[]).find(e=>Nx(e,t))}function xx(e,t){if(e===t)return 0;var n,r,i,s,o=Ax(e),a=Ax(t);if(o!==a)return ex(o,a);switch(o){case 0:case 9007199254740991:return 0;case 1:return ex(e.booleanValue,t.booleanValue);case 2:return r=t,i=mx(e.integerValue||e.doubleValue),s=mx(r.integerValue||r.doubleValue),i<s?-1:s<i?1:i===s?0:isNaN(i)?isNaN(s)?0:-1:1;case 3:return Px(e.timestampValue,t.timestampValue);case 4:return Px(_x(e),_x(t));case 5:return ex(e.stringValue,t.stringValue);case 6:return function(e,t){const n=vx(e),r=vx(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){var n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const t=ex(n[i],r[i]);if(0!==t)return t}return ex(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return n=e.geoPointValue,r=t.geoPointValue,0!==(s=ex(mx(n.latitude),mx(r.latitude)))?s:ex(mx(n.longitude),mx(r.longitude));case 9:return function(e,t){var n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const t=xx(n[i],r[i]);if(t)return t}return ex(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const t=ex(r[a],s[a]);if(0!==t)return t;var o=xx(n[r[a]],i[s[a]]);if(0!==o)return o}return ex(r.length,s.length)}(e.mapValue,t.mapValue);default:throw jR()}}function Px(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ex(e,t);var n=gx(e),r=gx(t),i=ex(n.seconds,r.seconds);return 0!==i?i:ex(n.nanos,r.nanos)}function Dx(e){return function s(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=gx(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?vx(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,Sx.fromName(t).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=s(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${s(e.fields[i])}`;return n+"}"}(e.mapValue):jR();var t}(e)}function Ox(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Mx(e){return e&&"integerValue"in e}function Lx(e){return!!e&&"arrayValue"in e}function Fx(e){return e&&"nullValue"in e}function Ux(e){return e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function jx(e){return e&&"mapValue"in e}function Vx(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const n={mapValue:{fields:{}}};return ox(t.mapValue.fields,(e,t)=>n.mapValue.fields[e]=Vx(t)),n}if(t.arrayValue){const r={arrayValue:{values:[]}};for(let e=0;e<(t.arrayValue.values||[]).length;++e)r.arrayValue.values[e]=Vx(t.arrayValue.values[e]);return r}return Object.assign({},t)}function qx(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Bx(e,t){return void 0!==e&&(void 0===t||0<xx(e,t))?e:t}function $x(e,t){return void 0!==e&&(void 0===t||xx(e,t)<0)?e:t}class Kx{constructor(e){this.value=e}static empty(){return new Kx({mapValue:{}})}field(n){if(n.isEmpty())return this.value;{let e=this.value;for(let t=0;t<n.length-1;++t)if(e=(e.mapValue.fields||{})[n.get(t)],!jx(e))return null;return e=(e.mapValue.fields||{})[n.lastSegment()],e||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vx(t)}setAll(e){let n=hx.emptyPath(),r={},i=[];e.forEach((e,t)=>{if(!n.isImmediateParentOf(t)){const e=this.getFieldsMap(n);this.applyChanges(e,r,i),r={},i=[],n=t.popLast()}e?r[t.lastSegment()]=Vx(e):i.push(t.lastSegment())});var t=this.getFieldsMap(n);this.applyChanges(t,r,i)}delete(e){const t=this.field(e.popLast());jx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nx(this.value,e.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let e=n.mapValue.fields[t.get(r)];jx(e)&&e.mapValue.fields||(e={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=e),n=e}return n.mapValue.fields}applyChanges(n,e,t){ox(e,(e,t)=>n[e]=t);for(const e of t)delete n[e]}clone(){return new Kx(Vx(this.value))}}class Wx{constructor(e,t,n,r,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new Wx(e,0,ix.min(),ix.min(),Kx.empty(),0)}static newFoundDocument(e,t,n){return new Wx(e,1,t,ix.min(),n,0)}static newNoDocument(e,t){return new Wx(e,2,t,ix.min(),Kx.empty(),0)}static newUnknownDocument(e,t){return new Wx(e,3,t,ix.min(),Kx.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kx.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kx.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Wx&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wx(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zx{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Hx(e){return e.fields.find(e=>2===e.kind)}function Gx(e){return e.fields.filter(e=>2!==e.kind)}zx.UNKNOWN_ID=-1;class Qx{constructor(e,t){this.fieldPath=e,this.kind=t}}class Yx{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Yx(0,Jx.min())}}class Jx{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Jx(ix.min(),Sx.empty(),-1)}}class Xx{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.P=null}}function Zx(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Xx(e,t,n,r,i,s,o)}function eP(e){const t=e;if(null===t.P){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>{return(t=e).field.canonicalString()+t.op.toString()+Dx(t.value);var t}).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Ix(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Dx(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Dx(e)).join(",")),t.P=e}return t.P}function tP(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let o=0;o<e.orderBy.length;o++)if(n=e.orderBy[o],r=t.orderBy[o],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;var n,r,i,s;if(e.filters.length!==t.filters.length)return!1;for(let a=0;a<e.filters.length;a++)if(i=e.filters[a],s=t.filters[a],i.op!==s.op||!i.field.isEqual(s.field)||!Nx(i.value,s.value))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!mP(e.startAt,t.startAt)&&mP(e.endAt,t.endAt)}function nP(e){return Sx.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function rP(e,t){return e.filters.filter(e=>e instanceof iP&&e.field.isEqual(t))}class iP extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.V(e,t,n):new sP(e,t,n):"array-contains"===t?new lP(e,n):"in"===t?new uP(e,n):"not-in"===t?new hP(e,n):"array-contains-any"===t?new dP(e,n):new iP(e,t,n)}static V(e,t,n){return new("in"===t?oP:aP)(e,n)}matches(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(xx(t,this.value)):null!==t&&Ax(this.value)===Ax(t)&&this.v(xx(t,this.value))}v(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return 0<e;case">=":return 0<=e;default:return jR()}}S(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)}}class sP extends iP{constructor(e,t,n){super(e,t,n),this.key=Sx.fromName(n.referenceValue)}matches(e){var t=Sx.comparator(e.key,this.key);return this.v(t)}}class oP extends iP{constructor(e,t){super(e,"in",t),this.keys=cP(0,t)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class aP extends iP{constructor(e,t){super(e,"not-in",t),this.keys=cP(0,t)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function cP(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Sx.fromName(e.referenceValue))}class lP extends iP{constructor(e,t){super(e,"array-contains",t)}matches(e){var t=e.data.field(this.field);return Lx(t)&&Rx(t.arrayValue,this.value)}}class uP extends iP{constructor(e,t){super(e,"in",t)}matches(e){var t=e.data.field(this.field);return null!==t&&Rx(this.value.arrayValue,t)}}class hP extends iP{constructor(e,t){super(e,"not-in",t)}matches(e){if(Rx(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Rx(this.value.arrayValue,t)}}class dP extends iP{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Lx(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Rx(this.value.arrayValue,e))}}class fP{constructor(e,t){this.position=e,this.inclusive=t}}class pP{constructor(e,t="asc"){this.field=e,this.dir=t}}function gP(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Sx.comparator(Sx.fromName(o.referenceValue),n.key):xx(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function mP(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Nx(e.position[n],t.position[n]))return!1;return!0}class vP{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.D=null,this.C=null,this.startAt,this.endAt}}function yP(e,t,n,r,i,s,o,a){return new vP(e,t,n,r,i,s,o,a)}function _P(e){return new vP(e)}function wP(e){return!Ix(e.limit)&&"F"===e.limitType}function bP(e){return!Ix(e.limit)&&"L"===e.limitType}function IP(e){return 0<e.explicitOrderBy.length?e.explicitOrderBy[0].field:null}function TP(e){for(const t of e.filters)if(t.S())return t.field;return null}function EP(e){return null!==e.collectionGroup}function SP(t){const n=t;if(null===n.D){n.D=[];const t=TP(n),e=IP(n);if(null!==t&&null===e)t.isKeyField()||n.D.push(new pP(t)),n.D.push(new pP(hx.keyField(),"asc"));else{let e=!1;for(const r of n.explicitOrderBy)n.D.push(r),r.field.isKeyField()&&(e=!0);if(!e){const t=0<n.explicitOrderBy.length?n.explicitOrderBy[n.explicitOrderBy.length-1].dir:"asc";n.D.push(new pP(hx.keyField(),t))}}}return n.D}function kP(e){const t=e;if(!t.C)if("F"===t.limitType)t.C=Zx(t.path,t.collectionGroup,SP(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of SP(t)){const t="desc"===i.dir?"asc":"desc";e.push(new pP(i.field,t))}var n=t.endAt?new fP(t.endAt.position,!t.endAt.inclusive):null,r=t.startAt?new fP(t.startAt.position,!t.startAt.inclusive):null;t.C=Zx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.C}function CP(e,t,n){return new vP(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function AP(e,t){return tP(kP(e),kP(t))&&e.limitType===t.limitType}function NP(e){return`${eP(kP(e))}|lt:${e.limitType}`}function RP(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(t+=`, filters: [${e.filters.map(e=>{return`${(t=e).field.canonicalString()} ${t.op} ${Dx(t.value)}`;var t}).join(", ")}]`),Ix(e.limit)||(t+=", limit: "+e.limit),0<e.orderBy.length&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Dx(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Dx(e)).join(",")),`Target(${t})`}(kP(e))}; limitType=${e.limitType})`}function xP(n,e){return e.isFoundDocument()&&(i=n,o=(s=e).key.path,null!==i.collectionGroup?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Sx.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o))&&function(e){for(const t of n.explicitOrderBy)if(!t.field.isKeyField()&&null===e.data.field(t.field))return;return 1}(e)&&function(e){for(const t of n.filters)if(!t.matches(e))return;return 1}(e)&&(i=e,(!(e=n).startAt||(t=e.startAt,r=gP(t,SP(e),i),t.inclusive?r<=0:r<0))&&(!e.endAt||(t=e.endAt,r=gP(t,SP(e),i),t.inclusive?0<=r:0<r)));var t,r,i,s,o}function PP(i){return(e,t)=>{let n=!1;for(const r of SP(i)){const i=function(e,i,t){var n=e.field.isKeyField()?Sx.comparator(i.key,t.key):function(e,t){var n=i.data.field(e),r=t.data.field(e);return null!==n&&null!==r?xx(n,r):jR()}(e.field,t);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return jR()}}(r,e,t);if(0!==i)return i;n=n||r.field.isKeyField()}return 0}}function DP(e,t){if(e.N){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tx(t)?"-0":t}}function OP(e){return{integerValue:""+e}}function MP(e,t){return Ex(t)?OP(t):DP(e,t)}class LP{constructor(){this._=void 0}}function FP(e,t){return e instanceof $P?Mx(n=t)||n&&"doubleValue"in n?t:{integerValue:0}:null;var n}class UP extends LP{}class jP extends LP{constructor(e){super(),this.elements=e}}function VP(e,t){const n=WP(t);for(const t of e.elements)n.some(e=>Nx(e,t))||n.push(t);return{arrayValue:{values:n}}}class qP extends LP{constructor(e){super(),this.elements=e}}function BP(e,t){let n=WP(t);for(const t of e.elements)n=n.filter(e=>!Nx(e,t));return{arrayValue:{values:n}}}class $P extends LP{constructor(e,t){super(),this.M=e,this.k=t}}function KP(e){return mx(e.integerValue||e.doubleValue)}function WP(e){return Lx(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class zP{constructor(e,t){this.field=e,this.transform=t}}class HP{constructor(e,t){this.version=e,this.transformResults=t}}class GP{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new GP}static exists(e){return new GP(void 0,e)}static updateTime(e){return new GP(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function QP(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class YP{}function JP(e,t,n){e instanceof tD?function(e,t,n){const r=e.value.clone(),i=iD(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof nD?function(e,t,n){if(!QP(e.precondition,t))return t.convertToUnknownDocument(n.version);const r=iD(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(rD(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function XP(e,t,n){e instanceof tD?function(e,t,n){if(QP(e.precondition,t)){const r=e.value.clone(),i=sD(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(eD(t),r).setHasLocalMutations()}}(e,t,n):e instanceof nD?function(e,t,n){if(QP(e.precondition,t)){const r=sD(e.fieldTransforms,n,t),i=t.data;i.setAll(rD(e)),i.setAll(r),t.convertToFoundDocument(eD(t),i).setHasLocalMutations()}}(e,t,n):(t=t,QP(e.precondition,t)&&t.convertToNoDocument(ix.min()))}function ZP(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&tx(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(e=e.transform,t=t.transform,e instanceof jP&&t instanceof jP||e instanceof qP&&t instanceof qP?tx(e.elements,t.elements,Nx):e instanceof $P&&t instanceof $P?Nx(e.k,t.k):e instanceof UP&&t instanceof UP)}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,r}function eD(e){return e.isFoundDocument()?e.version:ix.min()}class tD extends YP{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class nD extends YP{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function rD(n){const r=new Map;return n.fieldMask.fields.forEach(e=>{var t;e.isEmpty()||(t=n.data.field(e),r.set(e,t))}),r}function iD(e,t,n){const r=new Map;VR(e.length===n.length);for(let u=0;u<n.length;u++){var i=e[u],s=i.transform,o=t.data.field(i.field);r.set(i.field,(a=s,c=o,l=n[u],a instanceof jP?VP(a,c):a instanceof qP?BP(a,c):l))}var a,c,l;return r}function sD(e,t,n){const r=new Map;for(const l of e){const e=l.transform,u=n.data.field(l.field);r.set(l.field,(i=e,s=u,o=t,c=a=void 0,i instanceof UP?function(){const e={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return s&&(e.fields.__previous_value__=s),{mapValue:e}}():i instanceof jP?VP(i,s):i instanceof qP?BP(i,s):(a=FP(i=i,s),c=KP(a)+KP(i.k),Mx(a)&&Mx(i.k)?OP(c):DP(i.M,c))))}var i,s,o,a,c;return r}class oD extends YP{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class aD extends YP{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class cD{constructor(e){this.count=e}}function lD(e){switch(e){default:return jR(),0;case qR.CANCELLED:case qR.UNKNOWN:case qR.DEADLINE_EXCEEDED:case qR.RESOURCE_EXHAUSTED:case qR.INTERNAL:case qR.UNAVAILABLE:case qR.UNAUTHENTICATED:return;case qR.INVALID_ARGUMENT:case qR.NOT_FOUND:case qR.ALREADY_EXISTS:case qR.PERMISSION_DENIED:case qR.FAILED_PRECONDITION:case qR.ABORTED:case qR.OUT_OF_RANGE:case qR.UNIMPLEMENTED:case qR.DATA_LOSS:return 1}}function uD(e){if(void 0===e)return LR("GRPC error has no .code"),qR.UNKNOWN;switch(e){case wR.OK:return qR.OK;case wR.CANCELLED:return qR.CANCELLED;case wR.UNKNOWN:return qR.UNKNOWN;case wR.DEADLINE_EXCEEDED:return qR.DEADLINE_EXCEEDED;case wR.RESOURCE_EXHAUSTED:return qR.RESOURCE_EXHAUSTED;case wR.INTERNAL:return qR.INTERNAL;case wR.UNAVAILABLE:return qR.UNAVAILABLE;case wR.UNAUTHENTICATED:return qR.UNAUTHENTICATED;case wR.INVALID_ARGUMENT:return qR.INVALID_ARGUMENT;case wR.NOT_FOUND:return qR.NOT_FOUND;case wR.ALREADY_EXISTS:return qR.ALREADY_EXISTS;case wR.PERMISSION_DENIED:return qR.PERMISSION_DENIED;case wR.FAILED_PRECONDITION:return qR.FAILED_PRECONDITION;case wR.ABORTED:return qR.ABORTED;case wR.OUT_OF_RANGE:return qR.OUT_OF_RANGE;case wR.UNIMPLEMENTED:return qR.UNIMPLEMENTED;case wR.DATA_LOSS:return qR.DATA_LOSS;default:return jR()}}(c=wR=wR||{})[c.OK=0]="OK",c[c.CANCELLED=1]="CANCELLED",c[c.UNKNOWN=2]="UNKNOWN",c[c.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",c[c.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",c[c.NOT_FOUND=5]="NOT_FOUND",c[c.ALREADY_EXISTS=6]="ALREADY_EXISTS",c[c.PERMISSION_DENIED=7]="PERMISSION_DENIED",c[c.UNAUTHENTICATED=16]="UNAUTHENTICATED",c[c.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",c[c.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",c[c.ABORTED=10]="ABORTED",c[c.OUT_OF_RANGE=11]="OUT_OF_RANGE",c[c.UNIMPLEMENTED=12]="UNIMPLEMENTED",c[c.INTERNAL=13]="INTERNAL",c[c.UNAVAILABLE=14]="UNAVAILABLE",c[c.DATA_LOSS=15]="DATA_LOSS";class hD{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(r){ox(this.inner,(e,t)=>{for(const[e,n]of t)r(e,n)})}isEmpty(){return ax(this.inner)}size(){return this.innerSize}}class dD{constructor(e,t){this.comparator=e,this.root=t||pD.EMPTY}insert(e,t){return new dD(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pD.BLACK,null,null))}remove(e){return new dD(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pD.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:0<n&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;n=r<0?n.left:(t+=n.left.size+1,n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(n){this.inorderTraversal((e,t)=>(n(e,t),!1))}toString(){const n=[];return this.inorderTraversal((e,t)=>(n.push(`${e}:${t}`),!1)),`{${n.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fD(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fD(this.root,e,this.comparator,!1)}getReverseIterator(){return new fD(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fD(this.root,e,this.comparator,!0)}}class fD{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();var t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return 0<this.nodeStack.length}peek(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pD{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:pD.RED,this.left=null!=r?r:pD.EMPTY,this.right=null!=i?i:pD.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new pD(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;var i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return pD.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return pD.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){var e=this.copy(null,null,pD.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){var e=this.copy(null,null,pD.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){var e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw jR();if(this.right.isRed())throw jR();var e=this.left.check();if(e!==this.right.check())throw jR();return e+(this.isRed()?0:1)}}pD.EMPTY=null,pD.RED=!0,pD.BLACK=!1,pD.EMPTY=new class{constructor(){this.size=0}get key(){throw jR()}get value(){throw jR()}get color(){throw jR()}get left(){throw jR()}get right(){throw jR()}copy(e,t,n,r,i){return this}insert(e,t,n){return new pD(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class gD{constructor(e){this.comparator=e,this.data=new dD(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(n){this.data.inorderTraversal((e,t)=>(n(e),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,e[1]))return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mD(this.data.getIterator())}getIteratorFrom(e){return new mD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof gD))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(e){const t=new gD(this.comparator);return t.data=e,t}}class mD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function vD(e){return e.hasNext()?e.getNext():void 0}const yD=new dD(Sx.comparator);const _D=new dD(Sx.comparator);function wD(){return new hD(e=>e.toString(),(e,t)=>e.isEqual(t))}const bD=new dD(Sx.comparator),ID=new gD(Sx.comparator);function TD(...e){let t=ID;for(const n of e)t=t.add(n);return t}const ED=new gD(ex);class SD{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,kD.createSynthesizedTargetChangeForCurrentChange(e,t)),new SD(ix.min(),n,ED,yD,TD())}}class kD{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new kD(fx.EMPTY_BYTE_STRING,t,TD(),TD(),TD())}}class CD{constructor(e,t,n,r){this.O=e,this.removedTargetIds=t,this.key=n,this.$=r}}class AD{constructor(e,t){this.targetId=e,this.F=t}}class ND{constructor(e,t,n=fx.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class RD{constructor(){this.B=0,this.L=DD(),this.q=fx.EMPTY_BYTE_STRING,this.U=!1,this.K=!0}get current(){return this.U}get resumeToken(){return this.q}get G(){return 0!==this.B}get j(){return this.K}W(e){0<e.approximateByteSize()&&(this.K=!0,this.q=e)}H(){let n=TD(),r=TD(),i=TD();return this.L.forEach((e,t)=>{switch(t){case 0:n=n.add(e);break;case 2:r=r.add(e);break;case 1:i=i.add(e);break;default:jR()}}),new kD(this.q,this.U,n,r,i)}J(){this.K=!1,this.L=DD()}Y(e,t){this.K=!0,this.L=this.L.insert(e,t)}X(e){this.K=!0,this.L=this.L.remove(e)}Z(){this.B+=1}tt(){--this.B}et(){this.K=!0,this.U=!0}}class xD{constructor(e){this.nt=e,this.st=new Map,this.it=yD,this.rt=PD(),this.ot=new gD(ex)}at(e){for(const t of e.O)e.$&&e.$.isFoundDocument()?this.ut(t,e.$):this.ct(t,e.key,e.$);for(const n of e.removedTargetIds)this.ct(n,e.key,e.$)}ht(n){this.forEachTarget(n,e=>{const t=this.lt(e);switch(n.state){case 0:this.ft(e)&&t.W(n.resumeToken);break;case 1:t.tt(),t.G||t.J(),t.W(n.resumeToken);break;case 2:t.tt(),t.G||this.removeTarget(e);break;case 3:this.ft(e)&&(t.et(),t.W(n.resumeToken));break;case 4:this.ft(e)&&(this.dt(e),t.W(n.resumeToken));break;default:jR()}})}forEachTarget(e,n){0<e.targetIds.length?e.targetIds.forEach(n):this.st.forEach((e,t)=>{this.ft(t)&&n(t)})}_t(e){const t=e.targetId,n=e.F.count,r=this.wt(t);if(r){const e=r.target;if(nP(e))if(0===n){const n=new Sx(e.path);this.ct(t,n,Wx.newNoDocument(n,ix.min()))}else VR(1===n);else this.gt(t)!==n&&(this.dt(t),this.ot=this.ot.add(t))}}yt(r){const i=new Map;this.st.forEach((e,t)=>{var n=this.wt(t);if(n){if(e.current&&nP(n.target)){const i=new Sx(n.target.path);null!==this.it.get(i)||this.It(t,i)||this.ct(t,i,Wx.newNoDocument(i,r))}e.j&&(i.set(t,e.H()),e.J())}});let s=TD();this.rt.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{var t=this.wt(e);return!t||2===t.purpose||(n=!1)}),n&&(s=s.add(e))}),this.it.forEach((e,t)=>t.setReadTime(r));var e=new SD(r,i,this.ot,this.it,s);return this.it=yD,this.rt=PD(),this.ot=new gD(ex),e}ut(e,t){var n;this.ft(e)&&(n=this.It(e,t.key)?2:0,this.lt(e).Y(t.key,n),this.it=this.it.insert(t.key,t),this.rt=this.rt.insert(t.key,this.Tt(t.key).add(e)))}ct(e,t,n){if(this.ft(e)){const r=this.lt(e);this.It(e,t)?r.Y(t,1):r.X(t),this.rt=this.rt.insert(t,this.Tt(t).delete(e)),n&&(this.it=this.it.insert(t,n))}}removeTarget(e){this.st.delete(e)}gt(e){var t=this.lt(e).H();return this.nt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Z(e){this.lt(e).Z()}lt(e){let t=this.st.get(e);return t||(t=new RD,this.st.set(e,t)),t}Tt(e){let t=this.rt.get(e);return t||(t=new gD(ex),this.rt=this.rt.insert(e,t)),t}ft(e){var t=null!==this.wt(e);return t||MR("WatchChangeAggregator","Detected inactive target",e),t}wt(e){var t=this.st.get(e);return t&&t.G?null:this.nt.Et(e)}dt(t){this.st.set(t,new RD),this.nt.getRemoteKeysForTarget(t).forEach(e=>{this.ct(t,e,null)})}It(e,t){return this.nt.getRemoteKeysForTarget(e).has(t)}}function PD(){return new dD(Sx.comparator)}function DD(){return new dD(Sx.comparator)}const OD={asc:"ASCENDING",desc:"DESCENDING"},MD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class LD{constructor(e,t){this.databaseId=e,this.N=t}}function FD(e,t){return e.N?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function UD(e,t){return e.N?t.toBase64():t.toUint8Array()}function jD(e){return VR(!!e),ix.fromTimestamp((t=gx(e),new rx(t.seconds,t.nanos)));var t}function VD(e,t){return e=e,new lx(["projects",e.projectId,"databases",e.database]).child("documents").child(t).canonicalString()}function qD(e){var t=lx.fromString(e);return VR(s1(t)),t}function BD(e,t){return VD(e.databaseId,t.path)}function $D(e,t){const n=qD(t);if(n.get(1)!==e.databaseId.projectId)throw new BR(qR.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new BR(qR.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Sx(HD(n))}function KD(e,t){return VD(e.databaseId,t)}function WD(e){var t=qD(e);return 4===t.length?lx.emptyPath():HD(t)}function zD(e){return new lx(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function HD(e){return VR(4<e.length&&"documents"===e.get(4)),e.popFirst(5)}function GD(e,t,n){return{name:BD(e,t),fields:n.value.mapValue.fields}}function QD(e,t,n){const r=$D(e,t.name),i=jD(t.updateTime),s=new Kx({mapValue:{fields:t.fields}}),o=Wx.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function YD(e,t){let n;if(t instanceof tD)n={update:GD(e,t.key,t.value)};else if(t instanceof oD)n={delete:BD(e,t.key)};else if(t instanceof nD)n={update:GD(e,t.key,t.data),updateMask:function(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}(t.fieldMask)};else{if(!(t instanceof aD))return jR();n={verify:BD(e,t.key)}}return 0<t.fieldTransforms.length&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e){var t=e.transform;if(t instanceof UP)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof jP)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof qP)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof $P)return{fieldPath:e.field.canonicalString(),increment:t.k};throw jR()}(e))),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:(t=r.updateTime,FD(e,t.toTimestamp()))}:void 0!==r.exists?{exists:r.exists}:jR()),n;var r}function JD(t,n){const e=n.currentDocument?void 0!==(i=n.currentDocument).updateTime?GP.updateTime(jD(i.updateTime)):void 0!==i.exists?GP.exists(i.exists):GP.none():GP.none(),r=n.updateTransforms?n.updateTransforms.map(e=>function(e,t){let n=null;if("setToServerValue"in t)VR("REQUEST_TIME"===t.setToServerValue),n=new UP;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new jP(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new qP(e)}else"increment"in t?n=new $P(e,t.increment):jR();var r=hx.fromServerFormat(t.fieldPath);return new zP(r,n)}(t,e)):[];var i;if(n.update){n.update.name;var s=$D(t,n.update.name),o=new Kx({mapValue:{fields:n.update.fields}});if(n.updateMask){const t=function(){const e=n.updateMask.fieldPaths||[];return new dx(e.map(e=>hx.fromServerFormat(e)))}();return new nD(s,o,t,e,r)}return new tD(s,o,e,r)}if(n.delete){const r=$D(t,n.delete);return new oD(r,e)}if(n.verify){const r=$D(t,n.verify);return new aD(r,e)}return jR()}function XD(e,t){return{documents:[KD(e,t.path)]}}function ZD(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=KD(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=KD(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(e=>function(e){if("=="===e.op){if(Ux(e.value))return{unaryFilter:{field:t1(e.field),op:"IS_NAN"}};if(Fx(e.value))return{unaryFilter:{field:t1(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ux(e.value))return{unaryFilter:{field:t1(e.field),op:"IS_NOT_NAN"}};if(Fx(e.value))return{unaryFilter:{field:t1(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:t1(e.field),op:(t=e.op,MD[t]),value:e.value}};var t}(e));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:t1(e.field),direction:(e=e.dir,OD[e])}}(e))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);var s,i=(s=t.limit,e.N||Ix(s)?s:{value:s});return null!==i&&(n.structuredQuery.limit=i),t.startAt&&(n.structuredQuery.startAt={before:(i=t.startAt).inclusive,values:i.position}),t.endAt&&(n.structuredQuery.endAt={before:!(t=t.endAt).inclusive,values:t.position}),n}function e1(e){let t=WD(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(0<r){VR(1===r);const p=n.from[0];p.allDescendants?i=p.collectionId:t=t.child(p.collectionId)}let s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[i1(e)]:void 0!==e.fieldFilter?[r1(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>t(e)).reduce((e,t)=>e.concat(t)):jR():[]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>function(e){return new pP(n1(e.field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}())}(e)));let a=null;var c,l,u,h;n.limit&&(a=(e=n.limit,Ix(c="object"==typeof e?e.value:e)?null:c));let d=null;n.startAt&&(d=(l=n.startAt,h=!!l.before,u=l.values||[],new fP(u,h)));let f=null;return n.endAt&&(f=(l=n.endAt,u=!l.before,h=l.values||[],new fP(h,u))),yP(t,i,o,s,a,"F",d,f)}function t1(e){return{fieldPath:e.canonicalString()}}function n1(e){return hx.fromServerFormat(e.fieldPath)}function r1(e){return iP.create(n1(e.fieldFilter.field),function(){switch(e.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return jR()}}(),e.fieldFilter.value)}function i1(e){switch(e.unaryFilter.op){case"IS_NAN":var t=n1(e.unaryFilter.field);return iP.create(t,"==",{doubleValue:NaN});case"IS_NULL":t=n1(e.unaryFilter.field);return iP.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=n1(e.unaryFilter.field);return iP.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":n=n1(e.unaryFilter.field);return iP.create(n,"!=",{nullValue:"NULL_VALUE"});default:return jR()}}function s1(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)}function o1(e){let t="";for(let n=0;n<e.length;n++)0<t.length&&(t=a1(t)),t=function(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const r=e.charAt(i);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}(e.get(n),t);return a1(t)}function a1(e){return e+""}function c1(t){const n=t.length;if(VR(2<=n),2===n)return VR(""===t.charAt(0)&&""===t.charAt(1)),lx.emptyPath();const r=n-2,i=[];let s="";for(let o=0;o<n;){const n=t.indexOf("",o);switch((n<0||n>r)&&jR(),t.charAt(n+1)){case"":const r=t.substring(o,n);let e;0===s.length?e=r:(s+=r,e=s,s=""),i.push(e);break;case"":s+=t.substring(o,n),s+="\0";break;case"":s+=t.substring(o,n+1);break;default:jR()}o=n+2}return new lx(i)}const l1=["userId","batchId"];function u1(e,t){return[e,o1(t)]}function h1(e,t,n){return[e,o1(t),n]}const d1={},f1=["parentPath","readTime"],p1=["canonicalId","targetId"],g1=["targetId","path"],m1=["path","targetId"],v1=["collectionId","parent"],y1=["indexId","uid"],_1=["uid","sequenceNumber"],w1=["indexId","uid","arrayValue","directionalValue","documentKey"],b1=["indexId","uid","documentKey"],I1=["userId","collectionPath","documentId"],T1=["userId","collectionPath","largestBatchId"],E1=["userId","collectionGroup","largestBatchId"],S1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],k1=[...S1,"documentOverlays"],C1=[...k1,"indexConfiguration","indexState","indexEntries"],A1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class N1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class R1{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(r,i){return this.callbackAttached&&jR(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new R1((t,n)=>{this.nextCallback=e=>{this.wrapSuccess(r,e).next(t,n)},this.catchCallback=e=>{this.wrapFailure(i,e).next(t,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{var t=e();return t instanceof R1?t:R1.resolve(t)}catch(e){return R1.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R1.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R1.reject(t)}static resolve(n){return new R1((e,t)=>{e(n)})}static reject(n){return new R1((e,t)=>{t(n)})}static waitFor(e){return new R1((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=R1.resolve(!1);for(const n of e)t=t.next(e=>e?R1.resolve(e):n());return t}static forEach(e,n){const r=[];return e.forEach((e,t)=>{r.push(n.call(this,e,t))}),this.waitFor(r)}}class x1{constructor(n,e){this.action=n,this.transaction=e,this.aborted=!1,this.At=new $R,this.transaction.oncomplete=()=>{this.At.resolve()},this.transaction.onabort=()=>{e.error?this.At.reject(new O1(n,e.error)):this.At.resolve()},this.transaction.onerror=e=>{var t=j1(e.target.error);this.At.reject(new O1(n,t))}}static open(e,t,n,r){try{return new x1(t,e.transaction(r,n))}catch(e){throw new O1(t,e)}}get Rt(){return this.At.promise}abort(e){e&&this.At.reject(e),this.aborted||(MR("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}bt(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){var t=this.transaction.objectStore(e);return new L1(t)}}class P1{constructor(e,t,n){this.name=e,this.version=t,this.Pt=n,12.2===P1.Vt(sd())&&LR("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return MR("SimpleDb","Removing database:",e),F1(window.indexedDB.deleteDatabase(e)).toPromise()}static vt(){if(!dd())return!1;if(P1.St())return!0;const e=sd(),t=P1.Vt(e),n=0<t&&t<10,r=P1.Dt(e),i=0<r&&r<4.5;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||n||i)}static St(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Ct)}static xt(e,t){return e.store(t)}static Vt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static Dt(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async Nt(s){return this.db||(MR("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=e=>{var t=e.target.result;n(t)},i.onblocked=()=>{r(new O1(s,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{var t=e.target.error;"VersionError"===t.name?r(new BR(qR.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===t.name?r(new BR(qR.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+t)):r(new O1(s,t))},i.onupgradeneeded=e=>{MR("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;this.Pt.kt(t,i.transaction,e.oldVersion,this.version).next(()=>{MR("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.Mt&&(this.db.onversionchange=e=>this.Mt(e)),this.db}Ot(t){this.Mt=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(e,t,n,r){var i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.Nt(e);const t=x1.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.bt(),e)).catch(e=>(t.abort(e),R1.reject(e))).toPromise();return s.catch(()=>{}),await t.Rt,s}catch(e){const t="FirebaseError"!==e.name&&s<3;if(MR("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class D1{constructor(e){this.$t=e,this.Ft=!1,this.Bt=null}get isDone(){return this.Ft}get Lt(){return this.Bt}set cursor(e){this.$t=e}done(){this.Ft=!0}qt(e){this.Bt=e}delete(){return F1(this.$t.delete())}}class O1 extends BR{constructor(e,t){super(qR.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function M1(e){return"IndexedDbTransactionError"===e.name}class L1{constructor(e){this.store=e}put(e,t){let n;return n=void 0!==t?(MR("SimpleDb","PUT",this.store.name,e,t),this.store.put(t,e)):(MR("SimpleDb","PUT",this.store.name,"<auto-key>",e),this.store.put(e)),F1(n)}add(e){return MR("SimpleDb","ADD",this.store.name,e,e),F1(this.store.add(e))}get(t){return F1(this.store.get(t)).next(e=>(MR("SimpleDb","GET",this.store.name,t,e=void 0===e?null:e),e))}delete(e){return MR("SimpleDb","DELETE",this.store.name,e),F1(this.store.delete(e))}count(){return MR("SimpleDb","COUNT",this.store.name),F1(this.store.count())}Ut(e,n){var t=this.options(e,n);if(t.index||"function"!=typeof this.store.getAll){const e=this.cursor(t),n=[];return this.Kt(e,(e,t)=>{n.push(t)}).next(()=>n)}{const e=this.store.getAll(t.range);return new R1((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}}Gt(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new R1((t,n)=>{r.onerror=e=>{n(e.target.error)},r.onsuccess=e=>{t(e.target.result)}})}Qt(e,t){MR("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.jt=!1;var r=this.cursor(n);return this.Kt(r,(e,t,n)=>n.delete())}Wt(e,t){let n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.Kt(r,t)}zt(i){const e=this.cursor({});return new R1((n,r)=>{e.onerror=e=>{var t=j1(e.target.error);r(t)},e.onsuccess=e=>{const t=e.target.result;t?i(t.primaryKey,t.value).next(e=>{e?t.continue():n()}):n()}})}Kt(e,s){const o=[];return new R1((i,t)=>{e.onerror=e=>{t(e.target.error)},e.onsuccess=e=>{const t=e.target.result;if(t){const n=new D1(t),r=s(t.primaryKey,t.value,n);if(r instanceof R1){const e=r.catch(e=>(n.done(),R1.reject(e)));o.push(e)}n.isDone?i():null===n.Lt?t.continue():t.continue(n.Lt)}else i()}}).next(()=>R1.waitFor(o))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.jt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function F1(e){return new R1((n,r)=>{e.onsuccess=e=>{var t=e.target.result;n(t)},e.onerror=e=>{var t=j1(e.target.error);r(t)}})}let U1=!1;function j1(e){const t=P1.Vt(sd());if(12.2<=t&&t<13){const t="An internal error was encountered in the Indexed Database server";if(0<=e.message.indexOf(t)){const e=new BR("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return U1||(U1=!0,setTimeout(()=>{throw e},0)),e}}return e}class V1 extends N1{constructor(e,t){super(),this.Ht=e,this.currentSequenceNumber=t}}function q1(e,t){var n=e;return P1.xt(n.Ht,t)}class B1{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){var n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&JP(i,e,n[r])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&XP(t,e,this.localWriteTime);for(const n of this.mutations)n.key.isEqual(e.key)&&XP(n,e,this.localWriteTime)}applyToLocalDocumentSet(r){this.mutations.forEach(e=>{const t=r.get(e.key),n=t;this.applyToLocalView(n),t.isValidDocument()||n.convertToNoDocument(ix.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),TD())}isEqual(e){return this.batchId===e.batchId&&tx(this.mutations,e.mutations,(e,t)=>ZP(e,t))&&tx(this.baseMutations,e.baseMutations,(e,t)=>ZP(e,t))}}class $1{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){VR(e.mutations.length===n.length);let r=bD;var i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new $1(e,t,n,r)}}class K1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class W1{constructor(e,t,n,r,i=ix.min(),s=ix.min(),o=fx.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new W1(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new W1(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new W1(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class z1{constructor(e){this.Jt=e}}function H1(e,t){let n;if(t.document)n=QD(e.Jt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Sx.fromSegments(t.noDocument.path),r=X1(t.noDocument.readTime);n=Wx.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return jR();{const e=Sx.fromSegments(t.unknownDocument.path),i=X1(t.unknownDocument.version);n=Wx.newUnknownDocument(e,i)}}return t.readTime&&n.setReadTime(Y1(t.readTime)),n}function G1(e,t){var n,r=t.key.path.popLast().toArray(),i=Q1(t.readTime);if(t.isFoundDocument()){var s={name:BD(n=e.Jt,(e=t).key),fields:e.data.value.mapValue.fields,updateTime:FD(n,e.version.toTimestamp())};return{document:s,hasCommittedMutations:t.hasCommittedMutations,readTime:i,parentPath:r}}if(t.isNoDocument()){const o=t.key.path.toArray(),a=t.hasCommittedMutations;return{noDocument:{path:o,readTime:J1(t.version)},hasCommittedMutations:a,readTime:i,parentPath:r}}return t.isUnknownDocument()?{unknownDocument:{path:t.key.path.toArray(),version:J1(t.version)},hasCommittedMutations:!0,readTime:i,parentPath:r}:jR()}function Q1(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Y1(e){var t=new rx(e[0],e[1]);return ix.fromTimestamp(t)}function J1(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function X1(e){var t=new rx(e.seconds,e.nanoseconds);return ix.fromTimestamp(t)}function Z1(t,e){const n=(e.baseMutations||[]).map(e=>JD(t.Jt,e));for(let s=0;s<e.mutations.length-1;++s){const n=e.mutations[s];if(s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform){const r=e.mutations[s+1];n.updateTransforms=r.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(e=>JD(t.Jt,e)),i=rx.fromMillis(e.localWriteTimeMs);return new B1(e.batchId,i,n,r)}function eO(e){var t,n=X1(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?X1(e.lastLimboFreeSnapshotVersion):ix.min();let i;return i=void 0!==e.query.documents?(VR(1===(t=e.query).documents.length),kP(_P(WD(t.documents[0])))):kP(e1(e.query)),new W1(i,e.targetId,0,e.lastListenSequenceNumber,n,r,fx.fromBase64String(e.resumeToken))}function tO(e,t){var n=J1(t.snapshotVersion),r=J1(t.lastLimboFreeSnapshotVersion),i=(nP(t.target)?XD:ZD)(e.Jt,t.target),s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:eP(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nO(e){var t=e1({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?CP(t,t.limit,"L"):t}function rO(e,t){return new K1(t.largestBatchId,JD(e.Jt,t.overlayMutation))}function iO(e,t){var n=t.path.lastSegment();return[e,o1(t.path.popLast()),n]}class sO{getBundleMetadata(e,t){return oO(e).get(t).next(e=>{if(e)return{id:(t=e).bundleId,createTime:X1(t.createTime),version:t.version};var t})}saveBundleMetadata(e,t){return oO(e).put({bundleId:(n=t).id,createTime:J1(jD(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return aO(e).get(t).next(e=>{if(e)return{name:(t=e).name,query:nO(t.bundledQuery),readTime:X1(t.readTime)};var t})}saveNamedQuery(e,t){return aO(e).put({name:(t=t).name,readTime:J1(jD(t.readTime)),bundledQuery:t.bundledQuery})}}function oO(e){return q1(e,"bundles")}function aO(e){return q1(e,"namedQueries")}class cO{constructor(e,t){this.M=e,this.userId=t}static Yt(e,t){var n=t.uid||"";return new cO(e,n)}getOverlay(e,t){return lO(e).get(iO(this.userId,t)).next(e=>e?rO(this.M,e):null)}saveOverlays(r,i,e){const s=[];return e.forEach((e,t)=>{var n=new K1(i,t);s.push(this.Xt(r,n))}),R1.waitFor(s)}removeOverlaysForBatchId(n,e,r){const t=new Set;e.forEach(e=>t.add(o1(e.getCollectionPath())));const i=[];return t.forEach(e=>{var t=IDBKeyRange.bound([this.userId,e,r],[this.userId,e,r+1],!1,!0);i.push(lO(n).Qt("collectionPathOverlayIndex",t))}),R1.waitFor(i)}getOverlaysForCollection(e,t,n){const r=wD(),i=o1(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return lO(e).Ut("collectionPathOverlayIndex",s).next(e=>{for(const t of e){const e=rO(this.M,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,i){const s=wD();let o;var r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return lO(e).Wt({index:"collectionGroupOverlayIndex",range:r},(e,t,n)=>{const r=rO(this.M,t);s.size()<i||r.largestBatchId===o?(s.set(r.getKey(),r),o=r.largestBatchId):n.done()}).next(()=>s)}Xt(e,t){return lO(e).put(function(e,t,n){var[,r,i]=iO(t,n.mutation.key);return{userId:t,collectionPath:r,documentId:i,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:YD(e.Jt,n.mutation)}}(this.M,this.userId,t))}}function lO(e){return q1(e,"documentOverlays")}class uO{constructor(){}Zt(e,t){this.te(e,t),t.ee()}te(e,t){var n,r;"nullValue"in e?this.ne(t,5):"booleanValue"in e?(this.ne(t,10),t.se(e.booleanValue?1:0)):"integerValue"in e?(this.ne(t,15),t.se(mx(e.integerValue))):"doubleValue"in e?(n=mx(e.doubleValue),isNaN(n)?this.ne(t,13):(this.ne(t,15),Tx(n)?t.se(0):t.se(n))):"timestampValue"in e?(r=e.timestampValue,this.ne(t,20),"string"==typeof r?t.ie(r):(t.ie(`${r.seconds||""}`),t.se(r.nanos||0))):"stringValue"in e?(this.re(e.stringValue,t),this.oe(t)):"bytesValue"in e?(this.ne(t,30),t.ae(vx(e.bytesValue)),this.oe(t)):"referenceValue"in e?this.ue(e.referenceValue,t):"geoPointValue"in e?(r=e.geoPointValue,this.ne(t,45),t.se(r.latitude||0),t.se(r.longitude||0)):"mapValue"in e?qx(e)?this.ne(t,Number.MAX_SAFE_INTEGER):(this.ce(e.mapValue,t),this.oe(t)):"arrayValue"in e?(this.he(e.arrayValue,t),this.oe(t)):jR()}re(e,t){this.ne(t,25),this.le(e,t)}le(e,t){t.ie(e)}ce(e,t){var n=e.fields||{};this.ne(t,55);for(const e of Object.keys(n))this.re(e,t),this.te(n[e],t)}he(e,t){var n=e.values||[];this.ne(t,50);for(const e of n)this.te(e,t)}ue(e,t){this.ne(t,37),Sx.fromName(e).path.forEach(e=>{this.ne(t,60),this.le(e,t)})}ne(e,t){e.se(t)}oe(e){e.se(2)}}function hO(e){var t=64-function(e){let t=0;for(let r=0;r<8;++r){var n=function(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}(255&e[r]);if(t+=n,8!==n)break}return t}(e);return Math.ceil(t/8)}uO.fe=new uO;class dO{constructor(){this.buffer=new Uint8Array(1024),this.position=0}de(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this._e(n.value),n=t.next();this.we()}me(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.ge(n.value),n=t.next();this.ye()}pe(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this._e(e);else if(e<2048)this._e(960|e>>>6),this._e(128|63&e);else if(t<"\ud800"||"\udbff"<t)this._e(480|e>>>12),this._e(128|63&e>>>6),this._e(128|63&e);else{const e=t.codePointAt(0);this._e(240|e>>>18),this._e(128|63&e>>>12),this._e(128|63&e>>>6),this._e(128|63&e)}}this.we()}Ie(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.ge(e);else if(e<2048)this.ge(960|e>>>6),this.ge(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.ge(480|e>>>12),this.ge(128|63&e>>>6),this.ge(128|63&e);else{const e=t.codePointAt(0);this.ge(240|e>>>18),this.ge(128|63&e>>>12),this.ge(128|63&e>>>6),this.ge(128|63&e)}}this.ye()}Te(e){var t=this.Ee(e),n=hO(t);this.Ae(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Re(e){var t=this.Ee(e),n=hO(t);this.Ae(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}be(){this.Pe(255),this.Pe(255)}Ve(){this.ve(255),this.ve(255)}reset(){this.position=0}seed(e){this.Ae(e.length),this.buffer.set(e,this.position),this.position+=e.length}Se(){return this.buffer.slice(0,this.position)}Ee(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}_e(e){var t=255&e;0==t?(this.Pe(0),this.Pe(255)):255==t?(this.Pe(255),this.Pe(0)):this.Pe(t)}ge(e){var t=255&e;0==t?(this.ve(0),this.ve(255)):255==t?(this.ve(255),this.ve(0)):this.ve(e)}we(){this.Pe(0),this.Pe(1)}ye(){this.ve(0),this.ve(1)}Pe(e){this.Ae(1),this.buffer[this.position++]=e}ve(e){this.Ae(1),this.buffer[this.position++]=~e}Ae(e){var t=e+this.position;if(!(t<=this.buffer.length)){let e=2*this.buffer.length;e<t&&(e=t);const n=new Uint8Array(e);n.set(this.buffer),this.buffer=n}}}class fO{constructor(e){this.De=e}ae(e){this.De.de(e)}ie(e){this.De.pe(e)}se(e){this.De.Te(e)}ee(){this.De.be()}}class pO{constructor(e){this.De=e}ae(e){this.De.me(e)}ie(e){this.De.Ie(e)}se(e){this.De.Re(e)}ee(){this.De.Ve()}}class gO{constructor(){this.De=new dO,this.Ce=new fO(this.De),this.xe=new pO(this.De)}seed(e){this.De.seed(e)}Ne(e){return 0===e?this.Ce:this.xe}Se(){return this.De.Se()}reset(){this.De.reset()}}class mO{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}ke(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new mO(this.indexId,this.documentKey,this.arrayValue,n)}}function vO(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=yO(e.arrayValue,t.arrayValue),0!==n?n:(n=yO(e.directionalValue,t.directionalValue),0!==n?n:Sx.comparator(e.documentKey,t.documentKey)))}function yO(e,t){for(let r=0;r<e.length&&r<t.length;++r){var n=e[r]-t[r];if(0!=n)return n}return e.length-t.length}class _O{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Me=e.orderBy,this.Oe=[];for(const t of e.filters){const e=t;e.S()?this.$e=e:this.Oe.push(e)}}Fe(e){var t=Hx(e);if(void 0!==t&&!this.Be(t))return!1;var n=Gx(e);let r=0,i=0;for(;r<n.length&&this.Be(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.$e){const e=n[r];if(!this.Le(this.$e,e)||!this.qe(this.Me[i++],e))return!1;++r}for(;r<n.length;++r){const e=n[r];if(i>=this.Me.length||!this.qe(this.Me[i++],e))return!1}return!0}Be(e){for(const t of this.Oe)if(this.Le(t,e))return!0;return!1}Le(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind==n}qe(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class wO{constructor(){this.Ue=new bO}addToCollectionParentIndex(e,t){return this.Ue.add(t),R1.resolve()}getCollectionParents(e,t){return R1.resolve(this.Ue.getEntries(t))}addFieldIndex(e,t){return R1.resolve()}deleteFieldIndex(e,t){return R1.resolve()}getDocumentsMatchingTarget(e,t){return R1.resolve(null)}getFieldIndex(e,t){return R1.resolve(null)}getFieldIndexes(e,t){return R1.resolve([])}getNextCollectionGroupToUpdate(e){return R1.resolve(null)}updateCollectionGroup(e,t,n){return R1.resolve()}updateIndexEntries(e,t){return R1.resolve()}}class bO{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new gD(lx.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new gD(lx.comparator)).toArray()}}const IO=new Uint8Array(0);class TO{constructor(e){this.user=e,this.Ke=new bO,this.Ge=new hD(e=>eP(e),(e,t)=>tP(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(this.Ke.has(t))return R1.resolve();var n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.Ke.add(t)});r={collectionId:n,parent:o1(r)};return EO(e).put(r)}getCollectionParents(e,n){const r=[],t=IDBKeyRange.bound([n,""],[nx(n),""],!1,!0);return EO(e).Ut(t).next(e=>{for(const t of e){if(t.collectionId!==n)break;r.push(c1(t.parent))}return r})}addFieldIndex(e,t){const n=kO(e),r={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};return delete r.indexId,n.add(r).next()}deleteFieldIndex(e,t){const n=kO(e),r=CO(e),i=SO(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,l){const u=SO(e);let n=!0;const r=new Map;return R1.forEach(this.Qe(l),t=>this.getFieldIndex(e,t).next(e=>{n=n&&!!e,r.set(t,e)})).next(()=>{if(n){let c=TD();return R1.forEach(r,(e,t)=>{MR("IndexedDbIndexManager",`Using index ${a=e,`id=${a.indexId}|cg=${a.collectionGroup}|f=${a.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`} to execute ${eP(l)}`);var n=function(e,t){var n=Hx(t);if(void 0===n)return null;for(const t of rP(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(t,e),r=function(e,t){const n=new Map;for(const r of Gx(t))for(const t of rP(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(t,e),i=function(t){const i=[];let s=!0;for(const a of Gx(e)){let n,r=!0;for(const i of rP(t,a.fieldPath)){let e,t=!0;switch(i.op){case"<":case"<=":e="nullValue"in(o=i.value)?Cx:"booleanValue"in o?{booleanValue:!1}:"integerValue"in o||"doubleValue"in o?{doubleValue:NaN}:"timestampValue"in o?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in o?{stringValue:""}:"bytesValue"in o?{bytesValue:""}:"referenceValue"in o?Ox(bx.empty(),Sx.empty()):"geoPointValue"in o?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in o?{arrayValue:{}}:"mapValue"in o?{mapValue:{}}:jR();break;case"==":case"in":case">=":e=i.value;break;case">":e=i.value,t=!1;break;case"!=":case"not-in":e=Cx}Bx(n,e)===e&&(n=e,r=t)}if(null!==t.startAt)for(let e=0;e<t.orderBy.length;++e)if(t.orderBy[e].field.isEqual(a.fieldPath)){const s=t.startAt.position[e];Bx(n,s)===s&&(n=s,r=t.startAt.inclusive);break}if(void 0===n)return null;i.push(n),s=s&&r}var o;return new fP(i,s)}(t),s=function(t){const i=[];let s=!0;for(const a of Gx(e)){let n,r=!0;for(const i of rP(t,a.fieldPath)){let e,t=!0;switch(i.op){case">=":case">":e="nullValue"in(o=i.value)?{booleanValue:!1}:"booleanValue"in o?{doubleValue:NaN}:"integerValue"in o||"doubleValue"in o?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in o?{stringValue:""}:"stringValue"in o?{bytesValue:""}:"bytesValue"in o?Ox(bx.empty(),Sx.empty()):"referenceValue"in o?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in o?{arrayValue:{}}:"arrayValue"in o?{mapValue:{}}:"mapValue"in o?kx:jR(),t=!1;break;case"==":case"in":case"<=":e=i.value;break;case"<":e=i.value,t=!1;break;case"!=":case"not-in":e=kx}$x(n,e)===e&&(n=e,r=t)}if(null!==t.endAt)for(let e=0;e<t.orderBy.length;++e)if(t.orderBy[e].field.isEqual(a.fieldPath)){const s=t.endAt.position[e];$x(n,s)===s&&(n=s,r=t.endAt.inclusive);break}if(void 0===n)return null;i.push(n),s=s&&r}var o;return new fP(i,s)}(t),o=this.je(e,t,i),a=this.je(e,t,s),r=this.We(e,t,r),r=this.ze(e.indexId,n,o,!!i&&i.inclusive,a,!!s&&s.inclusive,r);return R1.forEach(r,e=>u.Gt(e,l.limit).next(e=>{e.forEach(e=>{c=c.add(new Sx(c1(e.documentKey)))})}))}).next(()=>c)}return R1.resolve(null)})}Qe(e){var t;return(t=this.Ge.get(e))||(this.Ge.set(e,t=[e]),t)}ze(t,e,n,r,i,s,o){const a=(null!=e?e.length:1)*Math.max(null!=n?n.length:1,null!=i?i.length:1),c=a/(null!=e?e.length:1),l=[];for(let u=0;u<a;++u){const a=e?this.He(e[u/c]):IO,h=n?this.Je(t,a,n[u%c],r):this.Ye(t),d=i?this.Xe(t,a,i[u%c],s):this.Ye(t+1);l.push(...this.createRange(h,d,o.map(e=>this.Je(t,a,e,!0))))}return l}Je(e,t,n,r){const i=new mO(e,Sx.empty(),t,n);return r?i:i.ke()}Xe(e,t,n,r){const i=new mO(e,Sx.empty(),t,n);return r?i.ke():i}Ye(e){return new mO(e,Sx.empty(),IO,IO)}getFieldIndex(e,t){const n=new _O(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{const t=e.filter(e=>n.Fe(e));return t.sort((e,t)=>t.fields.length-e.fields.length),0<t.length?t[0]:null})}Ze(e,t){const n=new gO;for(const i of Gx(e)){const e=t.data.field(i.fieldPath);if(null==e)return null;var r=n.Ne(i.kind);uO.fe.Zt(e,r)}return n.Se()}He(e){const t=new gO;return uO.fe.Zt(e,t.Ne(0)),t.Se()}We(e,t,n){if(null===n)return[];let r=[];r.push(new gO);let i=0;for(const s of Gx(e)){const e=n[i++];for(const n of r)if(this.tn(t,s.fieldPath)&&Lx(e))r=this.en(r,s,e);else{const t=n.Ne(s.kind);uO.fe.Zt(e,t)}}return this.nn(r)}je(e,t,n){return null==n?null:this.We(e,t,n.position)}nn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Se();return t}en(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new gO;r.seed(n.Se()),uO.fe.Zt(e,r.Ne(t.kind)),i.push(r)}return i}tn(e,t){return!!e.filters.find(e=>e instanceof iP&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=kO(e),r=CO(e);return(t?n.Ut("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.Ut()).next(e=>{const s=[];return R1.forEach(e,i=>r.get([i.indexId,this.uid]).next(e=>{var t,n,r;s.push((t=i,n=(e=e)?new Yx(e.sequenceNumber,new Jx(X1(e.readTime),new Sx(c1(e.documentKey)),e.largestBatchId)):Yx.empty(),r=t.fields.map(([e,t])=>new Qx(hx.fromServerFormat(e),t)),new zx(t.indexId,t.collectionGroup,r,n)))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!=n?n:ex(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=kO(e),s=CO(e);return this.sn(e).next(r=>i.Ut("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(e=>R1.forEach(e,e=>s.put(function(e,t,n){return{indexId:e,uid:t.uid||"",sequenceNumber:r,readTime:J1(n.readTime),documentKey:o1(n.documentKey.path),largestBatchId:n.largestBatchId}}(e.indexId,this.user,n)))))}updateIndexEntries(i,e){const n=new Map;return R1.forEach(e,(t,r)=>{var e=n.get(t.collectionGroup);return(e?R1.resolve(e):this.getFieldIndexes(i,t.collectionGroup)).next(e=>(n.set(t.collectionGroup,e),R1.forEach(e,n=>this.rn(i,t,n).next(e=>{var t=this.on(r,n);return e.isEqual(t)?R1.resolve():this.an(i,r,e,t)}))))})}un(e,t,n){return SO(e).put({indexId:n.indexId,uid:this.uid,arrayValue:n.arrayValue,directionalValue:n.directionalValue,documentKey:o1(t.key.path)})}cn(e,t,n){return SO(e).delete([n.indexId,this.uid,n.arrayValue,n.directionalValue,o1(t.key.path)])}rn(e,n,r){const t=SO(e);let i=new gD(vO);return t.Wt({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,o1(n.path)])},(e,t)=>{i=i.add(new mO(r.indexId,n,t.arrayValue,t.directionalValue))}).next(()=>i)}on(e,t){let n=new gD(vO);var r=this.Ze(t,e);if(null==r)return n;const i=Hx(t);if(null!=i){var s=e.data.field(i.fieldPath);if(Lx(s))for(const i of s.arrayValue.values||[])n=n.add(new mO(t.indexId,e.key,this.He(i),r))}else n=n.add(new mO(t.indexId,e.key,IO,r));return n}an(t,n,l,e){MR("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const r=[];return function(e,n,r,i){var s=l.getIterator(),o=e.getIterator();let a=vD(s),c=vD(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:0<r&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=vD(o)):t?(i(a),a=vD(s)):(a=vD(s),c=vD(o))}}(e,vO,e=>{r.push(this.un(t,n,e))},e=>{r.push(this.cn(t,n,e))}),R1.waitFor(r)}sn(e){let r=1;return CO(e).Wt({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,t,n)=>{n.done(),r=t.sequenceNumber+1}).next(()=>r)}createRange(e,t,n){n=n.sort((e,t)=>vO(e,t)).filter((e,t,n)=>!t||0!==vO(e,n[t-1]));const r=[];r.push(e);for(const i of n){const n=vO(i,e),s=vO(i,t);if(0===n)r[0]=e.ke();else if(0<n&&s<0)r.push(i),r.push(i.ke());else if(0<s)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2)i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,""],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,""]));return i}}function EO(e){return q1(e,"collectionParents")}function SO(e){return q1(e,"indexEntries")}function kO(e){return q1(e,"indexConfiguration")}function CO(e){return q1(e,"indexState")}const AO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class NO{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new NO(e,NO.DEFAULT_COLLECTION_PERCENTILE,NO.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function RO(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Wt({range:o},(e,t,n)=>(a++,n.delete()));s.push(c.next(()=>{VR(1===a)}));const l=[];for(const e of n.mutations){const r=h1(t,e.key.path,n.batchId);s.push(i.delete(r)),l.push(e.key)}return R1.waitFor(s).next(()=>l)}function xO(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw jR();t=e.noDocument}return JSON.stringify(t).length}NO.DEFAULT_COLLECTION_PERCENTILE=10,NO.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,NO.DEFAULT=new NO(41943040,NO.DEFAULT_COLLECTION_PERCENTILE,NO.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),NO.DISABLED=new NO(-1,0,0);class PO{constructor(e,t,n,r){this.userId=e,this.M=t,this.indexManager=n,this.referenceDelegate=r,this.hn={}}static Yt(e,t,n,r){VR(""!==e.uid);var i=e.isAuthenticated()?e.uid:"";return new PO(i,t,n,r)}checkEmpty(e){let r=!0;var t=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return OO(e).Wt({index:"userMutationsIndex",range:t},(e,t,n)=>{r=!1,n.done()}).next(()=>r)}addMutationBatch(u,h,d,f){const p=MO(u),g=OO(u);return g.add({}).next(e=>{VR("number"==typeof e);const t=new B1(e,h,d,f),n=(i=this.M,s=this.userId,o=t,a=o.baseMutations.map(e=>YD(i.Jt,e)),c=o.mutations.map(e=>YD(i.Jt,e)),{userId:s,batchId:o.batchId,localWriteTimeMs:o.localWriteTime.toMillis(),baseMutations:a,mutations:c}),r=[];var i,s,o,a,c;let l=new gD((e,t)=>ex(e.canonicalString(),t.canonicalString()));for(const u of f){const h=h1(this.userId,u.key.path,e);l=l.add(u.key.path.popLast()),r.push(g.put(n)),r.push(p.put(h,d1))}return l.forEach(e=>{r.push(this.indexManager.addToCollectionParentIndex(u,e))}),u.addOnCommittedListener(()=>{this.hn[e]=t.keys()}),R1.waitFor(r).next(()=>t)})}lookupMutationBatch(e,t){return OO(e).get(t).next(e=>e?(VR(e.userId===this.userId),Z1(this.M,e)):null)}ln(e,n){return this.hn[n]?R1.resolve(this.hn[n]):this.lookupMutationBatch(e,n).next(e=>{if(e){var t=e.keys();return this.hn[n]=t}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,n=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return OO(e).Wt({index:"userMutationsIndex",range:n},(e,t,n)=>{t.userId===this.userId&&(VR(t.batchId>=r),i=Z1(this.M,t)),n.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return OO(e).Wt({index:"userMutationsIndex",range:t,reverse:!0},(e,t,n)=>{r=t.batchId,n.done()}).next(()=>r)}getAllMutationBatches(e){var t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return OO(e).Ut("userMutationsIndex",t).next(e=>e.map(e=>Z1(this.M,e)))}getAllMutationBatchesAffectingDocumentKey(o,a){const e=u1(this.userId,a.path),t=IDBKeyRange.lowerBound(e),c=[];return MO(o).Wt({range:t},(e,t,n)=>{var[r,i,s]=e,i=c1(i);if(r===this.userId&&a.path.isEqual(i))return OO(o).get(s).next(e=>{if(!e)throw jR();VR(e.userId===this.userId),c.push(Z1(this.M,e))});n.done()}).next(()=>c)}getAllMutationBatchesAffectingDocumentKeys(t,e){let a=new gD(ex);const n=[];return e.forEach(o=>{var e=u1(this.userId,o.path),e=IDBKeyRange.lowerBound(e),e=MO(t).Wt({range:e},(e,t,n)=>{var[r,i,s]=e,i=c1(i);r===this.userId&&o.path.isEqual(i)?a=a.add(s):n.done()});n.push(e)}),R1.waitFor(n).next(()=>this.fn(t,a))}getAllMutationBatchesAffectingQuery(e,t){const o=t.path,a=o.length+1,n=u1(this.userId,o),r=IDBKeyRange.lowerBound(n);let c=new gD(ex);return MO(e).Wt({range:r},(e,t,n)=>{var[r,i,s]=e,i=c1(i);r===this.userId&&o.isPrefixOf(i)?i.length===a&&(c=c.add(s)):n.done()}).next(()=>this.fn(e,c))}fn(t,e){const n=[],r=[];return e.forEach(e=>{r.push(OO(t).get(e).next(e=>{if(null===e)throw jR();VR(e.userId===this.userId),n.push(Z1(this.M,e))}))}),R1.waitFor(r).next(()=>n)}removeMutationBatch(t,n){return RO(t.Ht,this.userId,n).next(e=>(t.addOnCommittedListener(()=>{this.dn(n.batchId)}),R1.forEach(e,e=>this.referenceDelegate.markPotentiallyOrphaned(t,e))))}dn(e){delete this.hn[e]}performConsistencyCheck(n){return this.checkEmpty(n).next(e=>{if(!e)return R1.resolve();var t=IDBKeyRange.lowerBound([this.userId]);const r=[];return MO(n).Wt({range:t},(e,t,n)=>{if(e[0]===this.userId){const t=c1(e[1]);r.push(t)}else n.done()}).next(()=>{VR(0===r.length)})})}containsKey(e,t){return DO(e,this.userId,t)}_n(e){return LO(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function DO(e,s,t){const n=u1(s,t.path),o=n[1],r=IDBKeyRange.lowerBound(n);let a=!1;return MO(e).Wt({range:r,jt:!0},(e,t,n)=>{var[r,i]=e;r===s&&i===o&&(a=!0),n.done()}).next(()=>a)}function OO(e){return q1(e,"mutations")}function MO(e){return q1(e,"documentMutations")}function LO(e){return q1(e,"mutationQueues")}class FO{constructor(e){this.wn=e}next(){return this.wn+=2,this.wn}static mn(){return new FO(0)}static gn(){return new FO(-1)}}class UO{constructor(e,t){this.referenceDelegate=e,this.M=t}allocateTargetId(n){return this.yn(n).next(e=>{const t=new FO(e.highestTargetId);return e.highestTargetId=t.next(),this.pn(n,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.yn(e).next(e=>ix.fromTimestamp(new rx(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.yn(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,n,r){return this.yn(t).next(e=>(e.highestListenSequenceNumber=n,r&&(e.lastRemoteSnapshotVersion=r.toTimestamp()),n>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=n),this.pn(t,e)))}addTargetData(t,n){return this.In(t,n).next(()=>this.yn(t).next(e=>(e.targetCount+=1,this.Tn(n,e),this.pn(t,e))))}updateTargetData(e,t){return this.In(e,t)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>jO(t).delete(e.targetId)).next(()=>this.yn(t)).next(e=>(VR(0<e.targetCount),--e.targetCount,this.pn(t,e)))}removeTargets(r,i,s){let o=0;const a=[];return jO(r).Wt((e,t)=>{var n=eO(t);n.sequenceNumber<=i&&null===s.get(n.targetId)&&(o++,a.push(this.removeTargetData(r,n)))}).next(()=>R1.waitFor(a)).next(()=>o)}forEachTarget(e,r){return jO(e).Wt((e,t)=>{var n=eO(t);r(n)})}yn(e){return VO(e).get("targetGlobalKey").next(e=>(VR(null!==e),e))}pn(e,t){return VO(e).put("targetGlobalKey",t)}In(e,t){return jO(e).put(tO(this.M,t))}Tn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.yn(e).next(e=>e.targetCount)}getTargetData(e,i){var t=eP(i),t=IDBKeyRange.bound([t,Number.NEGATIVE_INFINITY],[t,Number.POSITIVE_INFINITY]);let s=null;return jO(e).Wt({range:t,index:"queryTargetsIndex"},(e,t,n)=>{var r=eO(t);tP(i,r.target)&&(s=r,n.done())}).next(()=>s)}addMatchingKeys(n,e,r){const i=[],s=qO(n);return e.forEach(e=>{var t=o1(e.path);i.push(s.put({targetId:r,path:t})),i.push(this.referenceDelegate.addReference(n,r,e))}),R1.waitFor(i)}removeMatchingKeys(n,e,r){const i=qO(n);return R1.forEach(e,e=>{var t=o1(e.path);return R1.waitFor([i.delete([r,t]),this.referenceDelegate.removeReference(n,r,e)])})}removeMatchingKeysForTargetId(e,t){const n=qO(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=qO(e);let i=TD();return r.Wt({range:n,jt:!0},(e,t,n)=>{var r=c1(e[1]),r=new Sx(r);i=i.add(r)}).next(()=>i)}containsKey(e,t){var n=o1(t.path),n=IDBKeyRange.bound([n],[nx(n)],!1,!0);let r=0;return qO(e).Wt({index:"documentTargetsIndex",jt:!0,range:n},([e],t,n)=>{0!==e&&(r++,n.done())}).next(()=>0<r)}Et(e,t){return jO(e).get(t).next(e=>e?eO(e):null)}}function jO(e){return q1(e,"targets")}function VO(e){return q1(e,"targetGlobal")}function qO(e){return q1(e,"targetDocuments")}async function BO(e){if(e.code!==qR.FAILED_PRECONDITION||e.message!==A1)throw e;MR("LocalStore","Unexpectedly lost primary lease")}function $O([e,t],[n,r]){var i=ex(e,n);return 0===i?ex(t,r):i}class KO{constructor(e){this.En=e,this.buffer=new gD($O),this.An=0}Rn(){return++this.An}bn(e){var t=[e,this.Rn()];if(this.buffer.size<this.En)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();$O(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class WO{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.Pn=!1,this.Vn=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.vn(e)}stop(){this.Vn&&(this.Vn.cancel(),this.Vn=null)}get started(){return null!==this.Vn}vn(e){var t=this.Pn?3e5:6e4;MR("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.Vn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Vn=null,this.Pn=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){M1(e)?MR("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await BO(e)}await this.vn(e)})}}class zO{constructor(e,t){this.Sn=e,this.params=t}calculateTargetCount(e,t){return this.Sn.Dn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return R1.resolve(XR.A);const n=new KO(t);return this.Sn.forEachTarget(e,e=>n.bn(e.sequenceNumber)).next(()=>this.Sn.Cn(e,e=>n.bn(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Sn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Sn.removeOrphanedDocuments(e,t)}collect(t,n){return-1===this.params.cacheSizeCollectionThreshold?(MR("LruGarbageCollector","Garbage collection skipped; disabled"),R1.resolve(AO)):this.getCacheSize(t).next(e=>e<this.params.cacheSizeCollectionThreshold?(MR("LruGarbageCollector",`Garbage collection skipped; Cache size ${e} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),AO):this.xn(t,n))}getCacheSize(e){return this.Sn.getCacheSize(e)}xn(t,n){let r,i,s,o,a,c,l;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(i=e>this.params.maximumSequenceNumbersToCollect?(MR("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${e}`),this.params.maximumSequenceNumbersToCollect):e,o=Date.now(),this.nthSequenceNumber(t,i))).next(e=>(r=e,a=Date.now(),this.removeTargets(t,r,n))).next(e=>(s=e,c=Date.now(),this.removeOrphanedDocuments(t,r))).next(e=>(l=Date.now(),OR()<=Kh.DEBUG&&MR("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-u}ms\n\tDetermined least recently used ${i} in `+(a-o)+"ms\n"+`\tRemoved ${s} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(l-c)+"ms\n"+`Total Duration: ${l-u}ms`),R1.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:e})))}}class HO{constructor(e,t){this.db=e,this.garbageCollector=(e=this,t=t,new zO(e,t))}Dn(e){const n=this.Nn(e);return this.db.getTargetCache().getTargetCount(e).next(t=>n.next(e=>t+e))}Nn(e){let t=0;return this.Cn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Cn(e,n){return this.kn(e,(e,t)=>n(t))}addReference(e,t,n){return GO(e,n)}removeReference(e,t,n){return GO(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return GO(e,t)}Mn(t,n){let r=!1;return LO(t).zt(e=>DO(t,e,n).next(e=>(e&&(r=!0),R1.resolve(!e)))).next(()=>r)}removeOrphanedDocuments(n,r){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.kn(n,(t,e)=>{if(e<=r){const r=this.Mn(n,t).next(e=>{if(!e)return o++,i.getEntry(n,t).next(()=>(i.removeEntry(t,ix.min()),qO(n).delete([0,o1(t.path)])))});s.push(r)}}).next(()=>R1.waitFor(s)).next(()=>i.apply(n)).next(()=>o)}removeTarget(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return GO(e,t)}kn(e,r){const t=qO(e);let i,s=XR.A;return t.Wt({index:"documentTargetsIndex"},([e],{path:t,sequenceNumber:n})=>{0===e?(s!==XR.A&&r(new Sx(c1(i)),s),s=n,i=t):s=XR.A}).next(()=>{s!==XR.A&&r(new Sx(c1(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function GO(e,t){return qO(e).put((e=e.currentSequenceNumber,{targetId:0,path:o1(t.path),sequenceNumber:e}))}class QO{constructor(){this.changes=new hD(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wx.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?R1.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class YO{constructor(e){this.M=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return ZO(e).put(eM(t),n)}removeEntry(e,t){const n=ZO(e),r=eM(t);return n.delete(r)}updateMetadata(t,n){return this.getMetadata(t).next(e=>(e.byteSize+=n,this.On(t,e)))}getEntry(e,t){return ZO(e).get(eM(t)).next(e=>this.$n(t,e))}Fn(e,t){return ZO(e).get(eM(t)).next(e=>({document:this.$n(t,e),size:xO(e)}))}getEntries(e,t){let r=yD;return this.Bn(e,t,(e,t)=>{var n=this.$n(e,t);r=r.insert(e,n)}).next(()=>r)}Ln(e,t){let r=yD,i=new dD(Sx.comparator);return this.Bn(e,t,(e,t)=>{var n=this.$n(e,t);r=r.insert(e,n),i=i.insert(e,xO(t))}).next(()=>({documents:r,qn:i}))}Bn(e,t,i){if(t.isEmpty())return R1.resolve();const n=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),s=t.getIterator();let o=s.getNext();return ZO(e).Wt({range:n},(e,t,n)=>{for(var r=Sx.fromSegments(e);o&&Sx.comparator(o,r)<0;)i(o,null),o=s.getNext();o&&o.isEqual(r)&&(i(o,t),o=s.hasNext()?s.getNext():null),o?n.qt(o.path.toArray()):n.done()}).next(()=>{for(;o;)i(o,null),o=s.hasNext()?s.getNext():null})}getAll(e,i,t){let s=yD;const o=i.length+1,n={};if(t.isEqual(ix.min())){const e=i.toArray();n.range=IDBKeyRange.lowerBound(e)}else{const e=i.toArray(),s=Q1(t);n.range=IDBKeyRange.lowerBound([e,s],!0),n.index="collectionReadTimeIndex"}return ZO(e).Wt(n,(e,t,n)=>{var r;e.length===o&&(r=this.$n(Sx.fromSegments(e),t),i.isPrefixOf(r.key.path)?s=s.insert(r.key,r):n.done())}).next(()=>s)}newChangeBuffer(e){return new JO(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return XO(e).get("remoteDocumentGlobalKey").next(e=>(VR(!!e),e))}On(e,t){return XO(e).put("remoteDocumentGlobalKey",t)}$n(e,t){if(t){const e=H1(this.M,t);if(!e.isNoDocument()||!e.version.isEqual(ix.min()))return e}return Wx.newInvalidDocument(e)}}class JO extends QO{constructor(e,t){super(),this.Un=e,this.trackRemovals=t,this.Kn=new hD(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(s){const o=[];let a=0,c=new gD((e,t)=>ex(e.canonicalString(),t.canonicalString()));return this.changes.forEach((e,t)=>{var n=this.Kn.get(e);if(t.isValidDocument()){var r=G1(this.Un.M,t);c=c.add(e.path.popLast());var i=xO(r);a+=i-n,o.push(this.Un.addEntry(s,e,r))}else if(a-=n,this.trackRemovals){const a=G1(this.Un.M,t.convertToNoDocument(ix.min()));o.push(this.Un.addEntry(s,e,a))}else o.push(this.Un.removeEntry(s,e))}),c.forEach(e=>{o.push(this.Un.indexManager.addToCollectionParentIndex(s,e))}),o.push(this.Un.updateMetadata(s,a)),R1.waitFor(o)}getFromCache(e,t){return this.Un.Fn(e,t).next(e=>(this.Kn.set(t,e.size),e.document))}getAllFromCache(e,t){return this.Un.Ln(e,t).next(({documents:e,qn:t})=>(t.forEach((e,t)=>{this.Kn.set(e,t)}),e))}}function XO(e){return q1(e,"remoteDocumentGlobal")}function ZO(e){return q1(e,"remoteDocuments")}function eM(e){return e.path.toArray()}class tM{constructor(e){this.M=e}kt(t,n,e,r){const i=new x1("createOrUpgrade",n);var s;e<1&&1<=r&&(t.createObjectStore("owner"),(s=t).createObjectStore("mutationQueues",{keyPath:"userId"}),s.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",l1,{unique:!0}),s.createObjectStore("documentMutations"),nM(t),t.createObjectStore("remoteDocuments"));let o=R1.resolve();return e<3&&3<=r&&(0!==e&&((s=t).deleteObjectStore("targetDocuments"),s.deleteObjectStore("targets"),s.deleteObjectStore("targetGlobal"),nM(t)),o=o.next(()=>function(){const e=i.store("targetGlobal"),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ix.min().toTimestamp(),targetCount:0};return e.put("targetGlobalKey",t)}())),e<4&&4<=r&&(0!==e&&(o=o.next(()=>function(r,i){return i.store("mutations").Ut().next(e=>{r.deleteObjectStore("mutations"),r.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",l1,{unique:!0});const t=i.store("mutations"),n=e.map(e=>t.put(e));return R1.waitFor(n)})}(t,i))),o=o.next(()=>{t.createObjectStore("clientMetadata",{keyPath:"clientId"})})),e<5&&5<=r&&(o=o.next(()=>this.Gn(i))),e<6&&6<=r&&(o=o.next(()=>(t.createObjectStore("remoteDocumentGlobal"),this.Qn(i)))),e<7&&7<=r&&(o=o.next(()=>this.jn(i))),e<8&&8<=r&&(o=o.next(()=>this.Wn(t,i))),e<9&&9<=r&&(o=o.next(()=>{var e;(e=t).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),function(){const e=n.objectStore("remoteDocuments");e.createIndex("readTimeIndex","readTime",{unique:!1}),e.createIndex("collectionReadTimeIndex",f1,{unique:!1})}()})),e<10&&10<=r&&(o=o.next(()=>this.zn(i))),e<11&&11<=r&&(o=o.next(()=>{t.createObjectStore("bundles",{keyPath:"bundleId"}),t.createObjectStore("namedQueries",{keyPath:"name"})})),e<12&&12<=r&&(o=o.next(()=>{!function(){const e=t.createObjectStore("documentOverlays",{keyPath:I1});e.createIndex("collectionPathOverlayIndex",T1,{unique:!1}),e.createIndex("collectionGroupOverlayIndex",E1,{unique:!1})}()})),e<13&&13<=r&&(o=o.next(()=>{var e;(e=t).createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:y1}).createIndex("sequenceNumberIndex",_1,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:w1}).createIndex("documentKeyIndex",b1,{unique:!1})})),o}Qn(t){let n=0;return t.store("remoteDocuments").Wt((e,t)=>{n+=xO(t)}).next(()=>{var e={byteSize:n};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",e)})}Gn(r){const e=r.store("mutationQueues"),t=r.store("mutations");return e.Ut().next(e=>R1.forEach(e,n=>{var e=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return t.Ut("userMutationsIndex",e).next(e=>R1.forEach(e,e=>{VR(e.userId===n.userId);var t=Z1(this.M,e);return RO(r,n.userId,t).next(()=>{})}))}))}jn(e){const o=e.store("targetDocuments"),t=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return t.Wt((e,t)=>{const n=new lx(e),r=[0,o1(n)];s.push(o.get(r).next(e=>e?R1.resolve():(e=>o.put({targetId:0,path:o1(e),sequenceNumber:i.highestListenSequenceNumber}))(n)))}).next(()=>R1.waitFor(s))})}Wn(e,t){e.createObjectStore("collectionParents",{keyPath:v1});const n=t.store("collectionParents"),r=new bO,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:o1(r)})}};return t.store("remoteDocuments").Wt({jt:!0},(e,t)=>{const n=new lx(e);return i(n.popLast())}).next(()=>t.store("documentMutations").Wt({jt:!0},([,e],t)=>{const n=c1(e);return i(n.popLast())}))}zn(e){const r=e.store("targets");return r.Wt((e,t)=>{var n=eO(t),n=tO(this.M,n);return r.put(n)})}}function nM(e){e.createObjectStore("targetDocuments",{keyPath:g1}).createIndex("documentTargetsIndex",m1,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",p1,{unique:!0}),e.createObjectStore("targetGlobal")}const rM="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class iM{constructor(e,t,n,r,i,s,o,a,c,l,u=12){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Hn=i,this.window=s,this.document=o,this.Jn=c,this.Yn=l,this.Xn=u,this.Zn=null,this.ts=!1,this.isPrimary=!1,this.networkEnabled=!0,this.es=null,this.inForeground=!1,this.ns=null,this.ss=null,this.rs=Number.NEGATIVE_INFINITY,this.os=e=>Promise.resolve(),!iM.vt())throw new BR(qR.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new HO(this,r),this.us=t+"main",this.M=new z1(a),this.cs=new P1(this.us,this.Xn,new tM(this.M)),this.hs=new UO(this.referenceDelegate,this.M),this.ls=(a=this.M,new YO(a)),this.fs=new sO,this.window&&this.window.localStorage?this.ds=this.window.localStorage:(this.ds=null,!1===l&&LR("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this._s().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new BR(qR.FAILED_PRECONDITION,rM);return this.ws(),this.gs(),this.ys(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hs.getHighestSequenceNumber(e))}).then(e=>{this.Zn=new XR(e,this.Jn)}).then(()=>{this.ts=!0}).catch(e=>(this.cs&&this.cs.close(),Promise.reject(e)))}ps(t){return this.os=async e=>{if(this.started)return t(e)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.cs.Ot(async e=>{null===e.newVersion&&await t()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Hn.enqueueAndForget(async()=>{this.started&&await this._s()}))}_s(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>oM(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Is(t).next(e=>{e||(this.isPrimary=!1,this.Hn.enqueueRetryable(()=>this.os(!1)))})}).next(()=>this.Ts(t)).next(e=>this.isPrimary&&!e?this.Es(t).next(()=>!1):!!e&&this.As(t).next(()=>!0))).catch(e=>{if(M1(e))return MR("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return MR("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hn.enqueueRetryable(()=>this.os(e)),this.isPrimary=e})}Is(e){return sM(e).get("owner").next(e=>R1.resolve(this.Rs(e)))}bs(e){return oM(e).delete(this.clientId)}async Ps(){if(this.isPrimary&&!this.Vs(this.rs,18e5)){this.rs=Date.now();var e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const r=q1(e,"clientMetadata");return r.Ut().next(e=>{const t=this.vs(e,18e5),n=e.filter(e=>-1===t.indexOf(e));return R1.forEach(n,e=>r.delete(e.clientId)).next(()=>n)})}).catch(()=>[]);if(this.ds)for(const t of e)this.ds.removeItem(this.Ss(t.clientId))}}ys(){this.ss=this.Hn.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this._s().then(()=>this.Ps()).then(()=>this.ys()))}Rs(e){return!!e&&e.ownerId===this.clientId}Ts(t){return this.Yn?R1.resolve(!0):sM(t).get("owner").next(e=>{if(null!==e&&this.Vs(e.leaseTimestampMs,5e3)&&!this.Ds(e.ownerId)){if(this.Rs(e)&&this.networkEnabled)return!0;if(!this.Rs(e)){if(!e.allowTabSynchronization)throw new BR(qR.FAILED_PRECONDITION,rM);return!1}}return!(!this.networkEnabled||!this.inForeground)||oM(t).Ut().next(e=>void 0===this.vs(e,5e3).find(e=>{if(this.clientId!==e.clientId){var t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&MR("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ts=!1,this.Cs(),this.ss&&(this.ss.cancel(),this.ss=null),this.xs(),this.Ns(),await this.cs.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new V1(e,XR.A);return this.Es(t).next(()=>this.bs(t))}),this.cs.close(),this.ks()}vs(e,t){return e.filter(e=>this.Vs(e.updateTimeMs,t)&&!this.Ds(e.clientId))}Ms(){return this.runTransaction("getActiveClients","readonly",e=>oM(e).Ut().next(e=>this.vs(e,18e5).map(e=>e.clientId)))}get started(){return this.ts}getMutationQueue(e,t){return PO.Yt(e,this.M,t,this.referenceDelegate)}getTargetCache(){return this.hs}getRemoteDocumentCache(){return this.ls}getIndexManager(e){return new TO(e)}getDocumentOverlayCache(e){return cO.Yt(this.M,e)}getBundleCache(){return this.fs}runTransaction(t,n,r){MR("IndexedDbPersistence","Starting transaction:",t);var e,i="readonly"===n?"readonly":"readwrite",e=13===(e=this.Xn)?C1:12===e?k1:11===e?S1:void jR();let s;return this.cs.runTransaction(t,i,e,e=>(s=new V1(e,this.Zn?this.Zn.next():XR.A),"readwrite-primary"===n?this.Is(s).next(e=>!!e||this.Ts(s)).next(e=>{if(!e)throw LR(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Hn.enqueueRetryable(()=>this.os(!1)),new BR(qR.FAILED_PRECONDITION,A1);return r(s)}).next(e=>this.As(s).next(()=>e)):this.Os(s).next(()=>r(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Os(e){return sM(e).get("owner").next(e=>{if(null!==e&&this.Vs(e.leaseTimestampMs,5e3)&&!this.Ds(e.ownerId)&&!this.Rs(e)&&!(this.Yn||this.allowTabSynchronization&&e.allowTabSynchronization))throw new BR(qR.FAILED_PRECONDITION,rM)})}As(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return sM(e).put("owner",t)}static vt(){return P1.vt()}Es(e){const t=sM(e);return t.get("owner").next(e=>this.Rs(e)?(MR("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R1.resolve())}Vs(e,t){var n=Date.now();return!(e<n-t||n<e&&(LR(`Detected an update time that is in the future: ${e} > ${n}`),1))}ws(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ns=()=>{this.Hn.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this._s()))},this.document.addEventListener("visibilitychange",this.ns),this.inForeground="visible"===this.document.visibilityState)}xs(){this.ns&&(this.document.removeEventListener("visibilitychange",this.ns),this.ns=null)}gs(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.es=()=>{this.Cs(),!ad()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hn.enterRestrictedMode(!0),this.Hn.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.es))}Ns(){this.es&&(this.window.removeEventListener("pagehide",this.es),this.es=null)}Ds(e){var t;try{var n=null!==(null===(t=this.ds)||void 0===t?void 0:t.getItem(this.Ss(e)));return MR("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return LR("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Cs(){if(this.ds)try{this.ds.setItem(this.Ss(this.clientId),String(Date.now()))}catch(e){LR("Failed to set zombie client id.",e)}}ks(){if(this.ds)try{this.ds.removeItem(this.Ss(this.clientId))}catch(e){}}Ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function sM(e){return q1(e,"owner")}function oM(e){return q1(e,"clientMetadata")}function aM(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class cM{constructor(e,t){this.progress=e,this.$s=t}}class lM{constructor(e,t,n){this.ls=e,this.Fs=t,this.indexManager=n}Bs(t,n){return this.Fs.getAllMutationBatchesAffectingDocumentKey(t,n).next(e=>this.Ls(t,n,e))}Ls(e,t,n){return this.ls.getEntry(e,t).next(e=>{for(const t of n)t.applyToLocalView(e);return e})}qs(e,n){e.forEach((e,t)=>{for(const e of n)e.applyToLocalView(t)})}Us(t,e){return this.ls.getEntries(t,e).next(e=>this.Ks(t,e).next(()=>e))}Ks(e,t){return this.Fs.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>this.qs(t,e))}Gs(e,t,n){return r=t,Sx.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Qs(e,t.path):EP(t)?this.js(e,t,n):this.Ws(e,t,n);var r}Qs(e,t){return this.Bs(e,new Sx(t)).next(e=>{let t=_D;return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}js(r,i,s){const o=i.collectionGroup;let a=_D;return this.indexManager.getCollectionParents(r,o).next(e=>R1.forEach(e,e=>{var t,n=(t=i,e=e.child(o),new vP(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt));return this.Ws(r,n,s).next(e=>{e.forEach((e,t)=>{a=a.insert(e,t)})})}).next(()=>a))}Ws(t,n,e){let i;return this.ls.getAll(t,n.path,e).next(e=>(i=e,this.Fs.getAllMutationBatchesAffectingQuery(t,n))).next(t=>{for(const r of t)for(const t of r.mutations){var n=t.key;let e=i.get(n);null==e&&(e=Wx.newInvalidDocument(n),i=i.insert(n,e)),XP(t,e,r.localWriteTime),e.isFoundDocument()||(i=i.remove(n))}}).next(()=>(i.forEach((e,t)=>{xP(n,t)||(i=i.remove(e))}),i))}}class uM{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.zs=n,this.Hs=r}static Js(e,t){let n=TD(),r=TD();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new uM(e,t.fromCache,n,r)}}class hM{Ys(e){this.Xs=e}Gs(t,r,i,s){return 0===(e=r).filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())||i.isEqual(ix.min())?this.Zs(t,r):this.Xs.Us(t,s).next(e=>{const n=this.ti(r,e);return(wP(r)||bP(r))&&this.ei(r.limitType,n,s,i)?this.Zs(t,r):(OR()<=Kh.DEBUG&&MR("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),RP(r)),this.Xs.Gs(t,r,i).next(t=>(n.forEach(e=>{t=t.insert(e.key,e)}),t)))});var e}ti(n,e){let r=new gD(PP(n));return e.forEach((e,t)=>{xP(n,t)&&(r=r.add(t))}),r}ei(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||0<i.version.compareTo(r))}Zs(e,t){return OR()<=Kh.DEBUG&&MR("QueryEngine","Using full collection scan to execute query:",RP(t)),this.Xs.Gs(e,t,ix.min())}}class dM{constructor(e,t,n,r){this.persistence=e,this.ni=t,this.M=r,this.si=new dD(ex),this.ii=new hD(e=>eP(e),tP),this.ri=ix.min(),this.oi=e.getRemoteDocumentCache(),this.hs=e.getTargetCache(),this.fs=e.getBundleCache(),this.ai(n)}ai(e){this.indexManager=this.persistence.getIndexManager(e),this.Fs=this.persistence.getMutationQueue(e,this.indexManager),this.ui=new lM(this.oi,this.Fs,this.indexManager),this.oi.setIndexManager(this.indexManager),this.ni.Ys(this.ui)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.si))}}function fM(e,t,n,r){return new dM(e,t,n,r)}async function pM(e,t){const o=e;return o.persistence.runTransaction("Handle user change","readonly",i=>{let s;return o.Fs.getAllMutationBatches(i).next(e=>(s=e,o.ai(t),o.Fs.getAllMutationBatches(i))).next(e=>{const t=[],n=[];let r=TD();for(const i of s){t.push(i.batchId);for(const e of i.mutations)r=r.add(e.key)}for(const i of e){n.push(i.batchId);for(const e of i.mutations)r=r.add(e.key)}return o.ui.Us(i,r).next(e=>({ci:e,removedBatchIds:t,addedBatchIds:n}))})})}function gM(e){const t=e;return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hs.getLastRemoteSnapshotVersion(e))}function mM(e,l){const u=e,h=l.snapshotVersion;let d=u.si;return u.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const e=u.oi.newChangeBuffer({trackRemovals:!0});d=u.si;const c=[];l.targetChanges.forEach((t,n)=>{const r=d.get(n);if(r){c.push(u.hs.removeMatchingKeys(a,t.removedDocuments,n).next(()=>u.hs.addMatchingKeys(a,t.addedDocuments,n)));let e=r.withSequenceNumber(a.currentSequenceNumber);var i,s,o;l.targetMismatches.has(n)?e=e.withResumeToken(fx.EMPTY_BYTE_STRING,ix.min()).withLastLimboFreeSnapshotVersion(ix.min()):0<t.resumeToken.approximateByteSize()&&(e=e.withResumeToken(t.resumeToken,h)),d=d.insert(n,e),i=r,s=e,o=t,0!==i.resumeToken.approximateByteSize()&&!(3e8<=s.snapshotVersion.toMicroseconds()-i.snapshotVersion.toMicroseconds()||0<o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size)||c.push(u.hs.updateTargetData(a,e))}});let t=yD;if(l.documentUpdates.forEach(e=>{l.resolvedLimboDocuments.has(e)&&c.push(u.persistence.referenceDelegate.updateLimboDocument(a,e))}),c.push(vM(a,e,l.documentUpdates).next(e=>{t=e})),!h.isEqual(ix.min())){const l=u.hs.getLastRemoteSnapshotVersion(a).next(e=>u.hs.setTargetsMetadata(a,a.currentSequenceNumber,h));c.push(l)}return R1.waitFor(c).next(()=>e.apply(a)).next(()=>u.ui.Ks(a,t)).next(()=>t)}).then(e=>(u.si=d,e))}function vM(e,s,t){let n=TD();return t.forEach(e=>n=n.add(e)),s.getEntries(e,n).next(r=>{let i=yD;return t.forEach((e,t)=>{const n=r.get(e);t.isNoDocument()&&t.version.isEqual(ix.min())?(s.removeEntry(e,t.readTime),i=i.insert(e,t)):!n.isValidDocument()||0<t.version.compareTo(n.version)||0===t.version.compareTo(n.version)&&n.hasPendingWrites?(s.addEntry(t),i=i.insert(e,t)):MR("LocalStore","Ignoring outdated watch update for ",e,". Current version:",n.version," Watch version:",t.version)}),i})}function yM(e,r){const i=e;return i.persistence.runTransaction("Allocate target","readwrite",t=>{let n;return i.hs.getTargetData(t,r).next(e=>e?(n=e,R1.resolve(n)):i.hs.allocateTargetId(t).next(e=>(n=new W1(r,e,0,t.currentSequenceNumber),i.hs.addTargetData(t,n).next(()=>n))))}).then(e=>{var t=i.si.get(e.targetId);return(null===t||0<e.snapshotVersion.compareTo(t.snapshotVersion))&&(i.si=i.si.insert(e.targetId,e),i.ii.set(r,e.targetId)),e})}async function _M(e,t,n){const r=e,i=r.si.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!M1(e))throw e;MR("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.si=r.si.remove(t),r.ii.delete(i.target)}function wM(e,n,r){const i=e;let s=ix.min(),o=TD();return i.persistence.runTransaction("Execute query","readonly",t=>function(e,t,n){const r=e,i=r.ii.get(n);return void 0!==i?R1.resolve(r.si.get(i)):r.hs.getTargetData(t,n)}(i,t,kP(n)).next(e=>{if(e)return s=e.lastLimboFreeSnapshotVersion,i.hs.getMatchingKeysForTargetId(t,e.targetId).next(e=>{o=e})}).next(()=>i.ni.Gs(t,n,r?s:ix.min(),r?o:TD())).next(e=>({documents:e,hi:o})))}function bM(e,t){const n=e,r=n.hs,i=n.si.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.Et(e,t).next(e=>e?e.target:null))}function IM(e){const n=e;return n.persistence.runTransaction("Get new document changes","readonly",e=>function(e,t,n){const r=e;let i=yD,s=Q1(n);const o=ZO(t),a=IDBKeyRange.lowerBound(s,!0);return o.Wt({index:"readTimeIndex",range:a},(e,t)=>{var n=H1(r.M,t);i=i.insert(n.key,n),s=t.readTime}).next(()=>({$s:i,readTime:Y1(s)}))}(n.oi,e,n.ri)).then(({$s:e,readTime:t})=>(n.ri=t,e))}class TM{constructor(e){this.M=e,this._i=new Map,this.wi=new Map}getBundleMetadata(e,t){return R1.resolve(this._i.get(t))}saveBundleMetadata(e,t){return this._i.set(t.id,{id:t.id,version:t.version,createTime:jD(t.createTime)}),R1.resolve()}getNamedQuery(e,t){return R1.resolve(this.wi.get(t))}saveNamedQuery(e,t){return this.wi.set(t.name,{name:(t=t).name,query:nO(t.bundledQuery),readTime:jD(t.readTime)}),R1.resolve()}}class EM{constructor(){this.overlays=new dD(Sx.comparator),this.mi=new Map}getOverlay(e,t){return R1.resolve(this.overlays.get(t))}saveOverlays(n,r,e){return e.forEach((e,t)=>{this.Xt(n,r,t)}),R1.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.mi.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.mi.delete(n)),R1.resolve()}getOverlaysForCollection(e,t,n){const r=wD(),i=t.length+1,s=new Sx(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return R1.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new dD((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=wD(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=wD(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return R1.resolve(o)}Xt(t,n,r){if(null!==r){var i=this.overlays.get(r.key);if(null!==i){const t=this.mi.get(i.largestBatchId).delete(r.key);this.mi.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(r.key,new K1(n,r));let e=this.mi.get(n);void 0===e&&(e=TD(),this.mi.set(n,e)),this.mi.set(n,e.add(r.key))}}}class SM{constructor(){this.gi=new gD(kM.yi),this.pi=new gD(kM.Ii)}isEmpty(){return this.gi.isEmpty()}addReference(e,t){var n=new kM(e,t);this.gi=this.gi.add(n),this.pi=this.pi.add(n)}Ti(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Ei(new kM(e,t))}Ai(e,t){e.forEach(e=>this.removeReference(e,t))}Ri(e){const t=new Sx(new lx([])),n=new kM(t,e),r=new kM(t,e+1),i=[];return this.pi.forEachInRange([n,r],e=>{this.Ei(e),i.push(e.key)}),i}bi(){this.gi.forEach(e=>this.Ei(e))}Ei(e){this.gi=this.gi.delete(e),this.pi=this.pi.delete(e)}Pi(e){var t=new Sx(new lx([])),n=new kM(t,e),t=new kM(t,e+1);let r=TD();return this.pi.forEachInRange([n,t],e=>{r=r.add(e.key)}),r}containsKey(e){var t=new kM(e,0),t=this.gi.firstAfterOrEqual(t);return null!==t&&e.isEqual(t.key)}}class kM{constructor(e,t){this.key=e,this.Vi=t}static yi(e,t){return Sx.comparator(e.key,t.key)||ex(e.Vi,t.Vi)}static Ii(e,t){return ex(e.Vi,t.Vi)||Sx.comparator(e.key,t.key)}}class CM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.Fs=[],this.vi=1,this.Si=new gD(kM.yi)}checkEmpty(e){return R1.resolve(0===this.Fs.length)}addMutationBatch(e,t,n,r){var i=this.vi;this.vi++,0<this.Fs.length&&this.Fs[this.Fs.length-1];var s=new B1(i,t,n,r);this.Fs.push(s);for(const t of r)this.Si=this.Si.add(new kM(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return R1.resolve(s)}lookupMutationBatch(e,t){return R1.resolve(this.Di(t))}getNextMutationBatchAfterBatchId(e,t){var n=this.Ci(t+1),n=n<0?0:n;return R1.resolve(this.Fs.length>n?this.Fs[n]:null)}getHighestUnacknowledgedBatchId(){return R1.resolve(0===this.Fs.length?-1:this.vi-1)}getAllMutationBatches(e){return R1.resolve(this.Fs.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new kM(t,0),r=new kM(t,Number.POSITIVE_INFINITY),i=[];return this.Si.forEachInRange([n,r],e=>{var t=this.Di(e.Vi);i.push(t)}),R1.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new gD(ex);return t.forEach(e=>{var t=new kM(e,0),n=new kM(e,Number.POSITIVE_INFINITY);this.Si.forEachInRange([t,n],e=>{r=r.add(e.Vi)})}),R1.resolve(this.xi(r))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Sx.isDocumentKey(i)||(i=i.child(""));var s=new kM(new Sx(i),0);let o=new gD(ex);return this.Si.forEachWhile(e=>{var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Vi)),!0)},s),R1.resolve(this.xi(o))}xi(e){const n=[];return e.forEach(e=>{var t=this.Di(e);null!==t&&n.push(t)}),n}removeMutationBatch(n,r){VR(0===this.Ni(r.batchId,"removed")),this.Fs.shift();let i=this.Si;return R1.forEach(r.mutations,e=>{var t=new kM(e.key,r.batchId);return i=i.delete(t),this.referenceDelegate.markPotentiallyOrphaned(n,e.key)}).next(()=>{this.Si=i})}dn(e){}containsKey(e,t){var n=new kM(t,0),n=this.Si.firstAfterOrEqual(n);return R1.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.Fs.length,R1.resolve()}Ni(e,t){return this.Ci(e)}Ci(e){return 0===this.Fs.length?0:e-this.Fs[0].batchId}Di(e){var t=this.Ci(e);return t<0||t>=this.Fs.length?null:this.Fs[t]}}class AM{constructor(e){this.ki=e,this.docs=new dD(Sx.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ki(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return R1.resolve(n?n.document.mutableCopy():Wx.newInvalidDocument(t))}getEntries(e,t){let n=yD;return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Wx.newInvalidDocument(e))}),R1.resolve(n)}getAll(e,t,n){let r=yD;const i=new Sx(t.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||i.readTime.compareTo(n)<=0||(r=r.insert(i.key,i.mutableCopy()))}return R1.resolve(r)}Mi(e,t){return R1.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new NM(this)}getSize(e){return R1.resolve(this.size)}}class NM extends QO{constructor(e){super(),this.Un=e}applyChanges(n){const r=[];return this.changes.forEach((e,t)=>{t.isValidDocument()?r.push(this.Un.addEntry(n,t)):this.Un.removeEntry(e)}),R1.waitFor(r)}getFromCache(e,t){return this.Un.getEntry(e,t)}getAllFromCache(e,t){return this.Un.getEntries(e,t)}}class RM{constructor(e){this.persistence=e,this.Oi=new hD(e=>eP(e),tP),this.lastRemoteSnapshotVersion=ix.min(),this.highestTargetId=0,this.$i=0,this.Fi=new SM,this.targetCount=0,this.Bi=FO.mn()}forEachTarget(e,n){return this.Oi.forEach((e,t)=>n(t)),R1.resolve()}getLastRemoteSnapshotVersion(e){return R1.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R1.resolve(this.$i)}allocateTargetId(e){return this.highestTargetId=this.Bi.next(),R1.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$i&&(this.$i=t),R1.resolve()}In(e){this.Oi.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Bi=new FO(t),this.highestTargetId=t),e.sequenceNumber>this.$i&&(this.$i=e.sequenceNumber)}addTargetData(e,t){return this.In(t),this.targetCount+=1,R1.resolve()}updateTargetData(e,t){return this.In(t),R1.resolve()}removeTargetData(e,t){return this.Oi.delete(t.target),this.Fi.Ri(t.targetId),--this.targetCount,R1.resolve()}removeTargets(n,r,i){let s=0;const o=[];return this.Oi.forEach((e,t)=>{t.sequenceNumber<=r&&null===i.get(t.targetId)&&(this.Oi.delete(e),o.push(this.removeMatchingKeysForTargetId(n,t.targetId)),s++)}),R1.waitFor(o).next(()=>s)}getTargetCount(e){return R1.resolve(this.targetCount)}getTargetData(e,t){var n=this.Oi.get(t)||null;return R1.resolve(n)}addMatchingKeys(e,t,n){return this.Fi.Ti(t,n),R1.resolve()}removeMatchingKeys(t,e,n){this.Fi.Ai(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(e=>{i.push(r.markPotentiallyOrphaned(t,e))}),R1.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Fi.Ri(t),R1.resolve()}getMatchingKeysForTargetId(e,t){var n=this.Fi.Pi(t);return R1.resolve(n)}containsKey(e,t){return R1.resolve(this.Fi.containsKey(t))}}class xM{constructor(e,t){this.Li={},this.overlays={},this.Zn=new XR(0),this.ts=!1,this.ts=!0,this.referenceDelegate=e(this),this.hs=new RM(this),this.indexManager=new wO,this.ls=(e=e=>this.referenceDelegate.qi(e),new AM(e)),this.M=new z1(t),this.fs=new TM(this.M)}start(){return Promise.resolve()}shutdown(){return this.ts=!1,Promise.resolve()}get started(){return this.ts}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new EM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Li[e.toKey()];return n||(n=new CM(t,this.referenceDelegate),this.Li[e.toKey()]=n),n}getTargetCache(){return this.hs}getRemoteDocumentCache(){return this.ls}getBundleCache(){return this.fs}runTransaction(e,t,n){MR("MemoryPersistence","Starting transaction:",e);const r=new PM(this.Zn.next());return this.referenceDelegate.Ui(),n(r).next(e=>this.referenceDelegate.Ki(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Gi(t,n){return R1.or(Object.values(this.Li).map(e=>()=>e.containsKey(t,n)))}}class PM extends N1{constructor(e){super(),this.currentSequenceNumber=e}}class DM{constructor(e){this.persistence=e,this.Qi=new SM,this.ji=null}static Wi(e){return new DM(e)}get zi(){if(this.ji)return this.ji;throw jR()}addReference(e,t,n){return this.Qi.addReference(n,t),this.zi.delete(n.toString()),R1.resolve()}removeReference(e,t,n){return this.Qi.removeReference(n,t),this.zi.add(n.toString()),R1.resolve()}markPotentiallyOrphaned(e,t){return this.zi.add(t.toString()),R1.resolve()}removeTarget(e,t){this.Qi.Ri(t.targetId).forEach(e=>this.zi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.zi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ui(){this.ji=new Set}Ki(n){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R1.forEach(this.zi,e=>{const t=Sx.fromPath(e);return this.Hi(n,t).next(e=>{e||r.removeEntry(t,ix.min())})}).next(()=>(this.ji=null,r.apply(n)))}updateLimboDocument(e,t){return this.Hi(e,t).next(e=>{e?this.zi.delete(t.toString()):this.zi.add(t.toString())})}qi(e){return 0}Hi(e,t){return R1.or([()=>R1.resolve(this.Qi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gi(e,t)])}}function OM(e,t){return`firestore_clients_${e}_${t}`}function MM(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function LM(e,t){return`firestore_targets_${e}_${t}`}class FM{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ji(e,t,n){var r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new BR(r.error.code,r.error.message))),s?new FM(e,t,r.state,i):(LR("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class UM{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ji(e,t){var n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new BR(n.error.code,n.error.message))),i?new UM(e,n.state,r):(LR("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class jM{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){var n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ED;for(let s=0;r&&s<n.activeTargetIds.length;++s)r=Ex(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new jM(e,i):(LR("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class VM{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){var t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new VM(t.clientId,t.onlineState):(LR("SharedClientState",`Failed to parse online state: ${e}`),null)}}class qM{constructor(){this.activeTargetIds=ED}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BM{constructor(e,t,n,r,i){this.window=e,this.Hn=t,this.persistenceKey=n,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new dD(ex),this.started=!1,this.ir=[];var s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=OM(this.persistenceKey,this.tr),this.ar=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new qM),this.ur=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.cr=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=`firestore_bundle_loaded_${this.persistenceKey}`,this.window.addEventListener("storage",this.er)}static vt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ms();for(const n of e)if(n!==this.tr){const e=this.getItem(OM(this.persistenceKey,n));var t;!e||(t=jM.Ji(n,e))&&(this.sr=this.sr.insert(t.clientId,t))}this._r();const n=this.storage.getItem(this.lr);if(n){const e=this.wr(n);e&&this.mr(e)}for(const e of this.ir)this.nr(e);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ar,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(n){let r=!1;return this.sr.forEach((e,t)=>{t.activeTargetIds.has(n)&&(r=!0)}),r}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,n){this.yr(e,t,n),this.pr(e)}addLocalQueryTarget(e){let t="not-current";var n;return this.isActiveQueryTarget(e)&&(!(n=this.storage.getItem(LM(this.persistenceKey,e)))||(n=UM.Ji(e,n))&&(t=n.state)),this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(LM(this.persistenceKey,e))}updateQueryState(e,t,n){this.Tr(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.pr(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(){this.Ar()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){var t=this.storage.getItem(e);return MR("SharedClientState","READ",e,t),t}setItem(e,t){MR("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){MR("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const r=e;r.storageArea===this.storage&&(MR("SharedClientState","EVENT",r.key,r.newValue),r.key!==this.rr?this.Hn.enqueueRetryable(async()=>{if(this.started){if(null!==r.key)if(this.ur.test(r.key)){if(null==r.newValue){var e=this.Rr(r.key);return this.br(e,null)}e=this.Pr(r.key,r.newValue);if(e)return this.br(e.clientId,e)}else if(this.cr.test(r.key)){if(null!==r.newValue){var t=this.Vr(r.key,r.newValue);if(t)return this.vr(t)}}else if(this.hr.test(r.key)){if(null!==r.newValue){t=this.Sr(r.key,r.newValue);if(t)return this.Dr(t)}}else if(r.key===this.lr){if(null!==r.newValue){var n=this.wr(r.newValue);if(n)return this.mr(n)}}else if(r.key===this.ar){n=function(e){let t=XR.A;if(null!=e)try{var n=JSON.parse(e);VR("number"==typeof n),t=n}catch(e){LR("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(r.newValue);n!==XR.A&&this.sequenceNumberHandler(n)}else if(r.key===this.dr)return this.syncEngine.Cr()}else this.ir.push(r)}):LR("Received WebStorage notification for local change. Another client might have garbage-collected our state"))}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,n){const r=new FM(this.currentUser,e,t,n),i=MM(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}pr(e){var t=MM(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){var t={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(t))}Tr(e,t,n){const r=LM(this.persistenceKey,e),i=new UM(e,t,n);this.setItem(r,i.Yi())}Ar(){this.setItem(this.dr,"value-not-used")}Rr(e){var t=this.ur.exec(e);return t?t[1]:null}Pr(e,t){var n=this.Rr(e);return jM.Ji(n,t)}Vr(e,t){var n=this.cr.exec(e),r=Number(n[1]),n=void 0!==n[2]?n[2]:null;return FM.Ji(new xR(n),r,t)}Sr(e,t){var n=this.hr.exec(e),n=Number(n[1]);return UM.Ji(n,t)}wr(e){return VM.Ji(e)}async vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Nr(e.batchId,e.state,e.error);MR("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.kr(e.targetId,e.state,e.error)}br(e,t){const n=t?this.sr.insert(e,t):this.sr.remove(e),r=this.gr(this.sr),i=this.gr(n),s=[],o=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||o.push(e)}),this.syncEngine.Mr(s,o).then(()=>{this.sr=n})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=ED;return e.forEach((e,t)=>{n=n.unionWith(t.activeTargetIds)}),n}}class $M{constructor(){this.Or=new qM,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Or.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Or.Zi(e)}isLocalQueryTarget(e){return this.Or.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Or.activeTargetIds}isActiveQueryTarget(e){return this.Or.activeTargetIds.has(e)}start(){return this.Or=new qM,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class KM{Fr(e){}shutdown(){}}class WM{constructor(){this.Br=()=>this.Lr(),this.qr=()=>this.Ur(),this.Kr=[],this.Gr()}Fr(e){this.Kr.push(e)}shutdown(){window.removeEventListener("online",this.Br),window.removeEventListener("offline",this.qr)}Gr(){window.addEventListener("online",this.Br),window.addEventListener("offline",this.qr)}Lr(){MR("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Kr)e(0)}Ur(){MR("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Kr)e(1)}static vt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const zM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class HM{constructor(e){this.Qr=e.Qr,this.jr=e.jr}Wr(e){this.zr=e}Hr(e){this.Jr=e}onMessage(e){this.Yr=e}close(){this.jr()}send(e){this.Qr(e)}Xr(){this.zr()}Zr(e){this.Jr(e)}eo(e){this.Yr(e)}}class GM extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.no=t+"://"+e.host,this.so="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}io(t,e,n,r,i){const s=this.ro(t,e);MR("RestConnection","Sending: ",s,n);var o={};return this.oo(o,r,i),this.ao(t,s,o,n).then(e=>(MR("RestConnection","Received: ",e),e),e=>{throw FR("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e})}uo(e,t,n,r,i){return this.io(e,t,n,r,i)}oo(n,e,t){n["X-Goog-Api-Client"]="gl-js/ fire/"+PR,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,t)=>n[t]=e),t&&t.headers.forEach((e,t)=>n[t]=e)}ro(e,t){var n=zM[e];return`${this.no}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}ao(a,t,n,r){return new Promise((i,s)=>{const o=new NR;o.listenOnce(TR.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case IR.NO_ERROR:var e=o.getResponseJson();MR("Connection","XHR received:",JSON.stringify(e)),i(e);break;case IR.TIMEOUT:MR("Connection",'RPC "'+a+'" timed out'),s(new BR(qR.DEADLINE_EXCEEDED,"Request time out"));break;case IR.HTTP_ERROR:var t,n=o.getStatus();if(MR("Connection",'RPC "'+a+'" failed with status:',n,"response text:",o.getResponseText()),0<n){const a=o.getResponseJson().error;a&&a.status&&a.message?(r=a.status.toLowerCase().replace(/_/g,"-"),t=0<=Object.values(qR).indexOf(r)?r:qR.UNKNOWN,s(new BR(t,a.message))):s(new BR(qR.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new BR(qR.UNAVAILABLE,"Connection failed."));break;default:jR()}}finally{MR("Connection",'RPC "'+a+'" completed.')}var r});var e=JSON.stringify(r);o.send(t,"POST",e,n,15)})}co(e,t,n){const r=[this.no,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=new gR,s=bR(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new CR({})),this.oo(o.initMessageHeaders,t,n),od()||ld()||0<=sd().indexOf("Electron/")||ud()||0<=sd().indexOf("MSAppHost/")||cd()||(o.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");MR("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let l=!1,u=!1;const h=new HM({Qr:e=>{u?MR("Connection","Not sending because WebChannel is closed:",e):(l||(MR("Connection","Opening WebChannel transport."),c.open(),l=!0),MR("Connection","WebChannel sending:",e),c.send(e))},jr:()=>c.close()}),d=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return d(c,AR.EventType.OPEN,()=>{u||MR("Connection","WebChannel transport opened.")}),d(c,AR.EventType.CLOSE,()=>{u||(u=!0,MR("Connection","WebChannel transport closed"),h.Zr())}),d(c,AR.EventType.ERROR,e=>{u||(u=!0,FR("Connection","WebChannel transport errored:",e),h.Zr(new BR(qR.UNAVAILABLE,"The operation could not be completed")))}),d(c,AR.EventType.MESSAGE,n=>{if(!u){var e=n.data[0];VR(!!e);var r=e.error||(null===(r=e[0])||void 0===r?void 0:r.error);if(r){MR("Connection","WebChannel received error:",r);const n=r.status;let e=function(e){var t=wR[e];if(void 0!==t)return uD(t)}(n),t=r.message;void 0===e&&(e=qR.INTERNAL,t="Unknown error status: "+n+" with message "+r.message),u=!0,h.Zr(new BR(e,t)),c.close()}else MR("Connection","WebChannel received:",e),h.eo(e)}}),d(s,ER.STAT_EVENT,e=>{e.stat===SR?MR("Connection","Detected buffering proxy"):e.stat===kR&&MR("Connection","Detected no buffering proxy")}),setTimeout(()=>{h.Xr()},0),h}}function QM(){return"undefined"!=typeof window?window:null}function YM(){return"undefined"!=typeof document?document:null}function JM(e){return new LD(e,!0)}class XM{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Hn=e,this.timerId=t,this.ho=n,this.lo=r,this.fo=i,this._o=0,this.wo=null,this.mo=Date.now(),this.reset()}reset(){this._o=0}yo(){this._o=this.fo}po(e){this.cancel();var t=Math.floor(this._o+this.Io()),n=Math.max(0,Date.now()-this.mo),r=Math.max(0,t-n);0<r&&MR("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this._o} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.wo=this.Hn.enqueueAfterDelay(this.timerId,r,()=>(this.mo=Date.now(),e())),this._o*=this.lo,this._o<this.ho&&(this._o=this.ho),this._o>this.fo&&(this._o=this.fo)}To(){null!==this.wo&&(this.wo.skipDelay(),this.wo=null)}cancel(){null!==this.wo&&(this.wo.cancel(),this.wo=null)}Io(){return(Math.random()-.5)*this._o}}class ZM{constructor(e,t,n,r,i,s,o,a){this.Hn=e,this.Eo=n,this.Ao=r,this.Ro=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.bo=0,this.Po=null,this.Vo=null,this.stream=null,this.vo=new XM(e,t)}So(){return 1===this.state||5===this.state||this.Do()}Do(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Co()}async stop(){this.So()&&await this.close(0)}xo(){this.state=0,this.vo.reset()}No(){this.Do()&&null===this.Po&&(this.Po=this.Hn.enqueueAfterDelay(this.Eo,6e4,()=>this.ko()))}Mo(e){this.Oo(),this.stream.send(e)}async ko(){if(this.Do())return this.close(0)}Oo(){this.Po&&(this.Po.cancel(),this.Po=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,t){this.Oo(),this.$o(),this.vo.cancel(),this.bo++,4!==e?this.vo.reset():t&&t.code===qR.RESOURCE_EXHAUSTED?(LR(t.toString()),LR("Using maximum backoff delay to prevent overloading the backend."),this.vo.yo()):t&&t.code===qR.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Fo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Hr(t)}Fo(){}auth(){this.state=1;const e=this.Bo(this.bo),n=this.bo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,t])=>{this.bo===n&&this.Lo(e,t)},t=>{e(()=>{var e=new BR(qR.UNKNOWN,"Fetching auth token failed: "+t.message);return this.qo(e)})})}Lo(e,t){const n=this.Bo(this.bo);this.stream=this.Uo(e,t),this.stream.Wr(()=>{n(()=>(this.state=2,this.Vo=this.Hn.enqueueAfterDelay(this.Ao,1e4,()=>(this.Do()&&(this.state=3),Promise.resolve())),this.listener.Wr()))}),this.stream.Hr(e=>{n(()=>this.qo(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Co(){this.state=5,this.vo.po(async()=>{this.state=0,this.start()})}qo(e){return MR("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Bo(t){return e=>{this.Hn.enqueueAndForget(()=>this.bo===t?e():(MR("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eL extends ZM{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.M=i}Uo(e,t){return this.Ro.co("Listen",e,t)}onMessage(e){this.vo.reset();var t=function(e,t){let n;if("targetChange"in t){t.targetChange;var r="NO_CHANGE"===(f=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===f?1:"REMOVE"===f?2:"CURRENT"===f?3:"RESET"===f?4:jR(),i=t.targetChange.targetIds||[],s=(f=t.targetChange.resumeToken,e.N?(VR(void 0===f||"string"==typeof f),fx.fromBase64String(f||"")):(VR(void 0===f||f instanceof Uint8Array),fx.fromUint8Array(f||new Uint8Array))),o=t.targetChange.cause,a=o&&(a=void 0===(f=o).code?qR.UNKNOWN:uD(f.code),new BR(a,f.message||""));n=new ND(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var a=$D(e,c.document.name),l=jD(c.document.updateTime),u=new Kx({mapValue:{fields:c.document.fields}}),l=Wx.newFoundDocument(a,l,u),u=c.targetIds||[],c=c.removedTargetIds||[];n=new CD(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;u=t.documentDelete;u.document;c=$D(e,u.document),l=u.readTime?jD(u.readTime):ix.min(),l=Wx.newNoDocument(c,l),u=u.removedTargetIds||[];n=new CD([],u,l.key,l)}else if("documentRemove"in t){t.documentRemove;var h=t.documentRemove;h.document;var d=$D(e,h.document),h=h.removedTargetIds||[];n=new CD([],h,d,null)}else{if(!("filter"in t))return jR();{t.filter;const e=t.filter;e.targetId;h=e.count||0,d=new cD(h),h=e.targetId;n=new AD(h,d)}}var a,f;return n}(this.M,e),n=function(e){if(!("targetChange"in e))return ix.min();var t=e.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?jD(t.readTime):ix.min()}(e);return this.listener.Ko(t,n)}Go(e){const t={};t.database=zD(this.M),t.addTarget=function(e,t){let n;var r=t.target;return n=nP(r)?{documents:XD(e,r)}:{query:ZD(e,r)},n.targetId=t.targetId,0<t.resumeToken.approximateByteSize()?n.resumeToken=UD(e,t.resumeToken):0<t.snapshotVersion.compareTo(ix.min())&&(n.readTime=FD(e,t.snapshotVersion.toTimestamp())),n}(this.M,e);var n,r,r=(this.M,n=e,null==(r=function(){switch(n.purpose){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return jR()}}())?null:{"goog-listen-tags":r});r&&(t.labels=r),this.Mo(t)}Qo(e){const t={};t.database=zD(this.M),t.removeTarget=e,this.Mo(t)}}class tL extends ZM{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.M=i,this.jo=!1}get Wo(){return this.jo}start(){this.jo=!1,this.lastStreamToken=void 0,super.start()}Fo(){this.jo&&this.zo([])}Uo(e,t){return this.Ro.co("Write",e,t)}onMessage(e){if(VR(!!e.streamToken),this.lastStreamToken=e.streamToken,this.jo){this.vo.reset();var t=(r=e.writeResults,i=e.commitTime,r&&0<r.length?(VR(void 0!==i),r.map(e=>function(e,t){let n=e.updateTime?jD(e.updateTime):jD(t);return n.isEqual(ix.min())&&(n=jD(t)),new HP(n,e.transformResults||[])}(e,i))):[]),n=jD(e.commitTime);return this.listener.Ho(n,t)}var r,i;return VR(!e.writeResults||0===e.writeResults.length),this.jo=!0,this.listener.Jo()}Yo(){const e={};e.database=zD(this.M),this.Mo(e)}zo(e){var t={streamToken:this.lastStreamToken,writes:e.map(e=>YD(this.M,e))};this.Mo(t)}}class nL extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.Ro=n,this.M=r,this.Xo=!1}Zo(){if(this.Xo)throw new BR(qR.FAILED_PRECONDITION,"The client has already been terminated.")}io(n,r,i){return this.Zo(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,t])=>this.Ro.io(n,r,i,e,t)).catch(e=>{throw"FirebaseError"===e.name?(e.code===qR.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new BR(qR.UNKNOWN,e.toString())})}uo(n,r,i){return this.Zo(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,t])=>this.Ro.uo(n,r,i,e,t)).catch(e=>{throw"FirebaseError"===e.name?(e.code===qR.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new BR(qR.UNKNOWN,e.toString())})}terminate(){this.Xo=!0}}class rL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ta=0,this.ea=null,this.na=!0}sa(){0===this.ta&&(this.ia("Unknown"),this.ea=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ea=null,this.ra("Backend didn't respond within 10 seconds."),this.ia("Offline"),Promise.resolve())))}oa(e){"Online"===this.state?this.ia("Unknown"):(this.ta++,1<=this.ta&&(this.aa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ia("Offline")))}set(e){this.aa(),this.ta=0,"Online"===e&&(this.na=!1),this.ia(e)}ia(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){var t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.na?(LR(t),this.na=!1):MR("OnlineStateTracker",t)}aa(){null!==this.ea&&(this.ea.cancel(),this.ea=null)}}class iL{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.ua=[],this.ca=new Map,this.ha=new Set,this.la=[],this.fa=i,this.fa.Fr(e=>{n.enqueueAndForget(async()=>{fL(this)&&(MR("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=e;t.ha.add(4),await oL(t),t.da.set("Unknown"),t.ha.delete(4),await sL(t)}(this))})}),this.da=new rL(n,r)}}async function sL(e){if(fL(e))for(const t of e.la)await t(!0)}async function oL(e){for(const t of e.la)await t(!1)}function aL(e,t){const n=e;n.ca.has(t.targetId)||(n.ca.set(t.targetId,t),dL(n)?hL(n):IL(n).Do()&&lL(n,t))}function cL(e,t){const n=e,r=IL(n);n.ca.delete(t),r.Do()&&uL(n,t),0===n.ca.size&&(r.Do()?r.No():fL(n)&&n.da.set("Unknown"))}function lL(e,t){e._a.Z(t.targetId),IL(e).Go(t)}function uL(e,t){e._a.Z(t),IL(e).Qo(t)}function hL(t){t._a=new xD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.ca.get(e)||null}),IL(t).start(),t.da.sa()}function dL(e){return fL(e)&&!IL(e).So()&&0<e.ca.size}function fL(e){return 0===e.ha.size}function pL(e){e._a=void 0}async function gL(e,t,n){if(!M1(t))throw t;e.ha.add(1),await oL(e),e.da.set("Offline"),n=n||(()=>gM(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{MR("RemoteStore","Retrying IndexedDB access"),await n(),e.ha.delete(1),await sL(e)})}function mL(t,n){return n().catch(e=>gL(t,e,n))}async function vL(e){const t=e,n=TL(t);let r=0<t.ua.length?t.ua[t.ua.length-1].batchId:-1;for(;fL(i=t)&&i.ua.length<10;)try{const e=await function(e,t){const n=e;return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.Fs.getNextMutationBatchAfterBatchId(e,t)))}(t.localStore,r);if(null===e){0===t.ua.length&&n.No();break}r=e.batchId,function(e,t){e.ua.push(t);const n=TL(e);n.Do()&&n.Wo&&n.zo(t.mutations)}(t,e)}catch(e){await gL(t,e)}var i;yL(t)&&_L(t)}function yL(e){return fL(e)&&!TL(e).So()&&0<e.ua.length}function _L(e){TL(e).start()}async function wL(e,t){const n=e;n.asyncQueue.verifyOperationInProgress(),MR("RemoteStore","RemoteStore received new credentials");var r=fL(n);n.ha.add(3),await oL(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.ha.delete(3),await sL(n)}async function bL(e,t){const n=e;t?(n.ha.delete(2),await sL(n)):(n.ha.add(2),await oL(n),n.da.set("Unknown"))}function IL(t){return t.wa||(t.wa=function(e,t,n){const r=e;return r.Zo(),new eL(t,r.Ro,r.authCredentials,r.appCheckCredentials,r.M,n)}(t.datastore,t.asyncQueue,{Wr:(async function(n){n.ca.forEach((e,t)=>{lL(n,e)})}).bind(null,t),Hr:(async function(e,t){pL(e),dL(e)?(e.da.oa(t),hL(e)):e.da.set("Unknown")}).bind(null,t),Ko:(async function(e,r,t){if(e.da.set("Online"),r instanceof ND&&2===r.state&&r.cause)try{await async function(e){var t=r.cause;for(const n of r.targetIds)e.ca.has(n)&&(await e.remoteSyncer.rejectListen(n,t),e.ca.delete(n),e._a.removeTarget(n))}(e)}catch(t){MR("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),t),await gL(e,t)}else if(r instanceof CD?e._a.at(r):r instanceof AD?e._a._t(r):e._a.ht(r),!t.isEqual(ix.min()))try{const r=await gM(e.localStore);0<=t.compareTo(r)&&await function(r,i){const e=r._a.yt(i);return e.targetChanges.forEach((e,t)=>{if(0<e.resumeToken.approximateByteSize()){const n=r.ca.get(t);n&&r.ca.set(t,n.withResumeToken(e.resumeToken,i))}}),e.targetMismatches.forEach(e=>{const t=r.ca.get(e);var n;t&&(r.ca.set(e,t.withResumeToken(fx.EMPTY_BYTE_STRING,t.snapshotVersion)),uL(r,e),n=new W1(t.target,e,1,t.sequenceNumber),lL(r,n))}),r.remoteSyncer.applyRemoteEvent(e)}(e,t)}catch(r){MR("RemoteStore","Failed to raise snapshot:",r),await gL(e,r)}}).bind(null,t)}),t.la.push(async e=>{e?(t.wa.xo(),dL(t)?hL(t):t.da.set("Unknown")):(await t.wa.stop(),pL(t))})),t.wa}function TL(t){return t.ma||(t.ma=function(e,t,n){const r=e;return r.Zo(),new tL(t,r.Ro,r.authCredentials,r.appCheckCredentials,r.M,n)}(t.datastore,t.asyncQueue,{Wr:(async function(e){TL(e).Yo()}).bind(null,t),Hr:(async function(e,t){t&&TL(e).Wo&&await async function(e,t){if(lD(n=t.code)&&n!==qR.ABORTED){const n=e.ua.shift();TL(e).xo(),await mL(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await vL(e)}var n}(e,t),yL(e)&&_L(e)}).bind(null,t),Jo:(async function(e){const t=TL(e);for(const n of e.ua)t.zo(n.mutations)}).bind(null,t),Ho:(async function(e,t,n){const r=e.ua.shift(),i=$1.from(r,t,n);await mL(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await vL(e)}).bind(null,t)}),t.la.push(async e=>{e?(t.ma.xo(),await vL(t)):(await t.ma.stop(),0<t.ua.length&&(MR("RemoteStore",`Stopping write stream with ${t.ua.length} pending writes`),t.ua=[]))})),t.ma}class EL{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new $R,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new EL(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new BR(qR.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function SL(e,t){if(LR("AsyncQueue",`${t}: ${e}`),M1(e))return new BR(qR.UNAVAILABLE,`${t}: ${e}`);throw e}class kL{constructor(n){this.comparator=n?(e,t)=>n(e,t)||Sx.comparator(e.key,t.key):(e,t)=>Sx.comparator(e.key,t.key),this.keyedMap=_D,this.sortedSet=new dD(this.comparator)}static emptySet(e){return new kL(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(n){this.sortedSet.inorderTraversal((e,t)=>(n(e),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof kL))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(e,t){const n=new kL;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class CL{constructor(){this.ga=new dD(Sx.comparator)}track(e){var t=e.doc.key,n=this.ga.get(t);!n||0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):jR()}ya(){const n=[];return this.ga.inorderTraversal((e,t)=>{n.push(t)}),n}}class AL{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new AL(e,t,kL.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&AP(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class NL{constructor(){this.pa=void 0,this.listeners=[]}}class RL{constructor(){this.queries=new hD(e=>NP(e),AP),this.onlineState="Unknown",this.Ia=new Set}}async function xL(e,t){const n=e,r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new NL),i)try{s.pa=await n.onListen(r)}catch(e){const n=SL(e,`Initialization of query '${RP(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.Ta(n.onlineState),!s.pa||t.Ea(s.pa)&&DL(n)}async function PL(e,t){const n=e,r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);0<=e&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function DL(e){e.Ia.forEach(e=>{e.next()})}class OL{constructor(e,t,n){this.query=e,this.Aa=t,this.Ra=!1,this.ba=null,this.onlineState="Unknown",this.options=n||{}}Ea(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new AL(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Ra?this.Pa(e)&&(this.Aa.next(e),t=!0):this.Va(e,this.onlineState)&&(this.va(e),t=!0),this.ba=e,t}onError(e){this.Aa.error(e)}Ta(e){this.onlineState=e;let t=!1;return this.ba&&!this.Ra&&this.Va(this.ba,e)&&(this.va(this.ba),t=!0),t}Va(e,t){return!e.fromCache||!(this.options.Sa&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}Pa(e){if(0<e.docChanges.length)return!0;var t=this.ba&&this.ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}va(e){e=AL.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Ra=!0,this.Aa.next(e)}}class ML{constructor(e,t){this.payload=e,this.byteLength=t}Da(){return"metadata"in this.payload}}class LL{constructor(e){this.M=e}li(e){return $D(this.M,e)}fi(e){return e.metadata.exists?QD(this.M,e.document,!1):Wx.newNoDocument(this.li(e.metadata.name),this.di(e.metadata.readTime))}di(e){return jD(e)}}class FL{constructor(e,t,n){this.Ca=e,this.localStore=t,this.M=n,this.queries=[],this.documents=[],this.progress=UL(e)}xa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Na(e){const t=new Map,n=new LL(this.M);for(const i of e)if(i.metadata.queries){const e=n.li(i.metadata.name);for(const n of i.metadata.queries){var r=(t.get(n)||TD()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=e;let s=TD(),o=yD;for(const e of n){const n=t.li(e.metadata.name);e.document&&(s=s.add(n));const l=t.fi(e);l.setReadTime(t.di(e.metadata.readTime)),o=o.insert(n,l)}const a=i.oi.newChangeBuffer({trackRemovals:!0}),c=await yM(i,(r=r,kP(_P(lx.fromString(`__bundle__/docs/${r}`)))));return i.persistence.runTransaction("Apply bundle documents","readwrite",t=>vM(t,a,o).next(e=>(a.apply(t),e)).next(e=>i.hs.removeMatchingKeysForTargetId(t,c.targetId).next(()=>i.hs.addMatchingKeys(t,s,c.targetId)).next(()=>i.ui.Ks(t,e)).next(()=>e)))}(this.localStore,new LL(this.M),this.documents,this.Ca.id),t=this.Na(this.documents);for(const e of this.queries)await async function(e,n,r=TD()){const i=await yM(e,kP(nO(n.bundledQuery))),s=e;return s.persistence.runTransaction("Save named query","readwrite",e=>{var t=jD(n.readTime);if(0<=i.snapshotVersion.compareTo(t))return s.fs.saveNamedQuery(e,n);t=i.withResumeToken(fx.EMPTY_BYTE_STRING,t);return s.si=s.si.insert(t.targetId,t),s.hs.updateTargetData(e,t).next(()=>s.hs.removeMatchingKeysForTargetId(e,i.targetId)).next(()=>s.hs.addMatchingKeys(e,r,i.targetId)).next(()=>s.fs.saveNamedQuery(e,n))})}(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",new cM(Object.assign({},this.progress),e)}}function UL(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class jL{constructor(e){this.key=e}}class VL{constructor(e){this.key=e}}class qL{constructor(e,t){this.query=e,this.ka=t,this.Ma=null,this.current=!1,this.Oa=TD(),this.mutatedKeys=TD(),this.$a=PP(e),this.Fa=new kL(this.$a)}get Ba(){return this.ka}La(e,t){const a=t?t.qa:new CL,c=(t||this).Fa;let l=(t||this).mutatedKeys,u=c,h=!1;const d=wP(this.query)&&c.size===this.query.limit?c.last():null,f=bP(this.query)&&c.size===this.query.limit?c.first():null;if(e.inorderTraversal((e,t)=>{const n=c.get(e),r=xP(this.query,t)?t:null,i=!!n&&this.mutatedKeys.has(n.key),s=!!r&&(r.hasLocalMutations||this.mutatedKeys.has(r.key)&&r.hasCommittedMutations);let o=!1;n&&r?n.data.isEqual(r.data)?i!==s&&(a.track({type:3,doc:r}),o=!0):this.Ua(n,r)||(a.track({type:2,doc:r}),o=!0,(d&&0<this.$a(r,d)||f&&this.$a(r,f)<0)&&(h=!0)):!n&&r?(a.track({type:0,doc:r}),o=!0):n&&!r&&(a.track({type:1,doc:n}),o=!0,(d||f)&&(h=!0)),o&&(l=r?(u=u.add(r),s?l.add(e):l.delete(e)):(u=u.delete(e),l.delete(e)))}),wP(this.query)||bP(this.query))for(;u.size>this.query.limit;){const e=wP(this.query)?u.last():u.first();u=u.delete(e.key),l=l.delete(e.key),a.track({type:1,doc:e})}return{Fa:u,qa:a,ei:h,mutatedKeys:l}}Ua(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){var r=this.Fa;this.Fa=e.Fa,this.mutatedKeys=e.mutatedKeys;const i=e.qa.ya();i.sort((e,t)=>function(e,t){var n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jR()}};return n(e)-n(t)}(e.type,t.type)||this.$a(e.doc,t.doc)),this.Ka(n);var s=t?this.Ga():[],o=0===this.Oa.size&&this.current?1:0,a=o!==this.Ma;return this.Ma=o,0!==i.length||a?{snapshot:new AL(this.query,e.Fa,r,i,e.mutatedKeys,0==o,a,!1),Qa:s}:{Qa:s}}Ta(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Fa:this.Fa,qa:new CL,mutatedKeys:this.mutatedKeys,ei:!1},!1)):{Qa:[]}}ja(e){return!this.ka.has(e)&&!!this.Fa.has(e)&&!this.Fa.get(e).hasLocalMutations}Ka(e){e&&(e.addedDocuments.forEach(e=>this.ka=this.ka.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.ka=this.ka.delete(e)),this.current=e.current)}Ga(){if(!this.current)return[];const t=this.Oa;this.Oa=TD(),this.Fa.forEach(e=>{this.ja(e.key)&&(this.Oa=this.Oa.add(e.key))});const n=[];return t.forEach(e=>{this.Oa.has(e)||n.push(new VL(e))}),this.Oa.forEach(e=>{t.has(e)||n.push(new jL(e))}),n}Wa(e){this.ka=e.hi,this.Oa=TD();var t=this.La(e.documents);return this.applyChanges(t,!0)}za(){return AL.fromInitialDocuments(this.query,this.Fa,this.mutatedKeys,0===this.Ma)}}class BL{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class $L{constructor(e){this.key=e,this.Ha=!1}}class KL{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ja={},this.Ya=new hD(e=>NP(e),AP),this.Xa=new Map,this.Za=new Set,this.tu=new dD(Sx.comparator),this.eu=new Map,this.nu=new SM,this.su={},this.iu=new Map,this.ru=FO.gn(),this.onlineState="Unknown",this.ou=void 0}get isPrimaryClient(){return!0===this.ou}}async function WL(n,e,t,r){n.au=(e,s,t)=>async function(e,t,n){let r=t.view.La(s);r.ei&&(r=await wM(e.localStore,t.query,!1).then(({documents:e})=>t.view.La(e,r)));var i=n&&n.targetChanges.get(t.targetId),i=t.view.applyChanges(r,e.isPrimaryClient,i);return eF(e,t.targetId,i.Qa),i.snapshot}(n,e,t);const i=await wM(n.localStore,e,!0),s=new qL(e,i.hi),o=s.La(i.documents),a=kD.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),c=s.applyChanges(o,n.isPrimaryClient,a);eF(n,t,c.Qa);var l=new BL(e,t,s);return n.Ya.set(e,l),n.Xa.has(t)?n.Xa.get(t).push(e):n.Xa.set(t,[e]),c.snapshot}async function zL(e,t,n){const r=aF(e);try{const e=await function(e,r){const i=e,s=rx.now(),t=r.reduce((e,t)=>e.add(t.key),TD());let o;return i.persistence.runTransaction("Locally write mutations","readwrite",n=>i.ui.Us(n,t).next(e=>{o=e;const t=[];for(const n of r){const r=function(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=FP(r.transform,e||null);null!=i&&(null==n&&(n=Kx.empty()),n.set(r.field,i))}return n||null}(n,o.get(n.key));null!=r&&t.push(new nD(n.key,r,function r(e){const i=[];return ox(e.fields,(e,t)=>{const n=new hx([e]);if(jx(t)){const e=r(t.mapValue).fields;if(0===e.length)i.push(n);else for(const t of e)i.push(n.child(t))}else i.push(n)}),new dx(i)}(r.value.mapValue),GP.exists(!0)))}return i.Fs.addMutationBatch(n,s,t,r)})).then(e=>(e.applyToLocalDocumentSet(o),{batchId:e.batchId,changes:o}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.su[e.currentUser.toKey()];r=r||new dD(ex),r=r.insert(t,n),e.su[e.currentUser.toKey()]=r}(r,e.batchId,n),await nF(r,e.changes),await vL(r.remoteStore)}catch(e){const t=SL(e,"Failed to persist write");n.reject(t)}}async function HL(e,t){const r=e;try{const e=await mM(r.localStore,t);t.targetChanges.forEach((e,t)=>{const n=r.eu.get(t);n&&(VR(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),0<e.addedDocuments.size?n.Ha=!0:0<e.modifiedDocuments.size?VR(n.Ha):0<e.removedDocuments.size&&(VR(n.Ha),n.Ha=!1))}),await nF(r,e,t)}catch(e){await BO(e)}}function GL(r,i,e){const t=r;if(t.isPrimaryClient&&0===e||!t.isPrimaryClient&&1===e){const r=[];t.Ya.forEach((e,t)=>{var n=t.view.Ta(i);n.snapshot&&r.push(n.snapshot)}),function(e,n){const t=e;t.onlineState=n;let r=!1;t.queries.forEach((e,t)=>{for(const e of t.listeners)e.Ta(n)&&(r=!0)}),r&&DL(t)}(t.eventManager,i),r.length&&t.Ja.Ko(r),t.onlineState=i,t.isPrimaryClient&&t.sharedClientState.setOnlineState(i)}}async function QL(e,t){const n=e,r=t.batch.batchId;try{const e=await function(e,r){const i=e;return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const t=r.batch.keys(),n=i.oi.newChangeBuffer({trackRemovals:!0});return function(e,t,r,i){const s=r.batch,n=s.keys();let o=R1.resolve();return n.forEach(n=>{o=o.next(()=>i.getEntry(t,n)).next(e=>{var t=r.docVersions.get(n);VR(null!==t),e.version.compareTo(t)<0&&(s.applyToRemoteDocument(e,r),e.isValidDocument()&&(e.setReadTime(r.commitVersion),i.addEntry(e)))})}),o.next(()=>e.Fs.removeMutationBatch(t,s))}(i,e,r,n).next(()=>n.apply(e)).next(()=>i.Fs.performConsistencyCheck(e)).next(()=>i.ui.Us(e,t))})}(n.localStore,t);JL(n,r,null),YL(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await nF(n,e)}catch(e){await BO(e)}}function YL(e,t){(e.iu.get(t)||[]).forEach(e=>{e.resolve()}),e.iu.delete(t)}function JL(e,t,n){const r=e;let i=r.su[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.su[r.currentUser.toKey()]=i}}function XL(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Xa.get(e))t.Ya.delete(r),n&&t.Ja.uu(r,n);t.Xa.delete(e),t.isPrimaryClient&&t.nu.Ri(e).forEach(e=>{t.nu.containsKey(e)||ZL(t,e)})}function ZL(e,t){e.Za.delete(t.path.canonicalString());var n=e.tu.get(t);null!==n&&(cL(e.remoteStore,n),e.tu=e.tu.remove(t),e.eu.delete(n),tF(e))}function eF(e,t,n){for(const r of n)r instanceof jL?(e.nu.addReference(r.key,t),function(e,t){const n=t.key,r=n.path.canonicalString();e.tu.get(n)||e.Za.has(r)||(MR("SyncEngine","New document in limbo: "+n),e.Za.add(r),tF(e))}(e,r)):r instanceof VL?(MR("SyncEngine","Document no longer in limbo: "+r.key),e.nu.removeReference(r.key,t),e.nu.containsKey(r.key)||ZL(e,r.key)):jR()}function tF(e){for(;0<e.Za.size&&e.tu.size<e.maxConcurrentLimboResolutions;){var t=e.Za.values().next().value;e.Za.delete(t);var n=new Sx(lx.fromString(t)),t=e.ru.next();e.eu.set(t,new $L(n)),e.tu=e.tu.insert(n,t),aL(e.remoteStore,new W1(kP(_P(n.path)),t,2,XR.A))}}async function nF(e,t,r){const i=e,s=[],o=[],a=[];i.Ya.isEmpty()||(i.Ya.forEach((e,n)=>{a.push(i.au(n,t,r).then(e=>{var t;e&&(i.isPrimaryClient&&i.sharedClientState.updateQueryState(n.targetId,e.fromCache?"not-current":"current"),s.push(e),t=uM.Js(n.targetId,e),o.push(t))}))}),await Promise.all(a),i.Ja.Ko(s),await async function(e,t){const r=e;try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",n=>R1.forEach(t,t=>R1.forEach(t.zs,e=>r.persistence.referenceDelegate.addReference(n,t.targetId,e)).next(()=>R1.forEach(t.Hs,e=>r.persistence.referenceDelegate.removeReference(n,t.targetId,e)))))}catch(e){if(!M1(e))throw e;MR("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=r.si.get(t),n=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(n);r.si=r.si.insert(t,i)}}}(i.localStore,o))}async function rF(r,e){const i=r;if(oF(i),aF(i),!0===e&&!0!==i.ou){const r=i.sharedClientState.getAllActiveQueryTargets(),e=await iF(i,r.toArray());i.ou=!0,await bL(i.remoteStore,!0);for(const r of e)aL(i.remoteStore,r)}else if(!1===e&&!1!==i.ou){const r=[];let n=Promise.resolve();i.Xa.forEach((e,t)=>{i.sharedClientState.isLocalQueryTarget(t)?r.push(t):n=n.then(()=>(XL(i,t),_M(i.localStore,t,!0))),cL(i.remoteStore,t)}),await n,await iF(i,r),function(){const n=i;n.eu.forEach((e,t)=>{cL(n.remoteStore,t)}),n.nu.bi(),n.eu=new Map,n.tu=new dD(Sx.comparator)}(),i.ou=!1,await bL(i.remoteStore,!1)}}async function iF(t,n){const r=t,i=[],s=[];for(const t of n){let e;const u=r.Xa.get(t);if(u&&0!==u.length){e=await yM(r.localStore,kP(u[0]));for(const t of u){const n=r.Ya.get(t),u=(o=r,a=n,l=c=void 0,l=await wM((c=o).localStore,a.query,!0),l=a.view.Wa(l),c.isPrimaryClient&&eF(c,a.targetId,l.Qa),await l);u.snapshot&&s.push(u.snapshot)}}else{const u=await bM(r.localStore,t);e=await yM(r.localStore,u),await WL(r,sF(u),t,!1)}i.push(e)}var o,a,c,l;return r.Ja.Ko(s),i}function sF(e){return yP(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function oF(e){const t=e;return t.remoteStore.remoteSyncer.applyRemoteEvent=HL.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=(function(e,t){const n=e,r=n.eu.get(t);if(r&&r.Ha)return TD().add(r.key);{let e=TD();const r=n.Xa.get(t);if(!r)return e;for(const t of r){const r=n.Ya.get(t);e=e.unionWith(r.view.Ba)}return e}}).bind(null,t),t.remoteStore.remoteSyncer.rejectListen=(async function(e,t,n){const r=e;r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.eu.get(t),s=i&&i.key;if(s){let e=new dD(Sx.comparator);e=e.insert(s,Wx.newNoDocument(s,ix.min()));const n=TD().add(s),i=new SD(ix.min(),new Map,new gD(ex),e,n);await HL(r,i),r.tu=r.tu.remove(s),r.eu.delete(t),tF(r)}else await _M(r.localStore,t,!1).then(()=>XL(r,t,n)).catch(BO)}).bind(null,t),t.Ja.Ko=(function(e,t){const n=e;let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Ea(e)&&(r=!0);i.pa=e}}r&&DL(n)}).bind(null,t.eventManager),t.Ja.uu=(function(e,t,n){const r=e,i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}).bind(null,t.eventManager),t}function aF(e){const t=e;return t.remoteStore.remoteSyncer.applySuccessfulWrite=QL.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=(async function(e,t,n){const r=e;try{const e=await function(e,r){const i=e;return i.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let n;return i.Fs.lookupMutationBatch(t,r).next(e=>(VR(null!==e),n=e.keys(),i.Fs.removeMutationBatch(t,e))).next(()=>i.Fs.performConsistencyCheck(t)).next(()=>i.ui.Us(t,n))})}(r.localStore,t);JL(r,t,n),YL(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await nF(r,e)}catch(n){await BO(n)}}).bind(null,t),t}class cF{constructor(){this.synchronizeTabs=!1}async initialize(e){this.M=JM(e.databaseInfo.databaseId),this.sharedClientState=this.hu(e),this.persistence=this.lu(e),await this.persistence.start(),this.gcScheduler=this.fu(e),this.localStore=this.du(e)}fu(e){return null}du(e){return fM(this.persistence,new hM,e.initialUser,this.M)}lu(e){return new xM(DM.Wi,this.M)}hu(e){return new $M}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class lF extends cF{constructor(e,t,n){super(),this._u=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await async function(e){const t=e;return t.persistence.runTransaction("Synchronize last document change read time","readonly",t=>function(){const e=ZO(t);let r=ix.min();return e.Wt({index:"readTimeIndex",reverse:!0},(e,t,n)=>{t.readTime&&(r=Y1(t.readTime)),n.done()}).next(()=>r)}()).then(e=>{t.ri=e})}(this.localStore),await this._u.initialize(this,e),await aF(this._u.syncEngine),await vL(this._u.remoteStore),await this.persistence.ps(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve()))}du(e){return fM(this.persistence,new hM,e.initialUser,this.M)}fu(e){var t=this.persistence.referenceDelegate.garbageCollector;return new WO(t,e.asyncQueue)}lu(e){var t=aM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?NO.withCacheSize(this.cacheSizeBytes):NO.DEFAULT;return new iM(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,QM(),YM(),this.M,this.sharedClientState,!!this.forceOwnership)}hu(e){return new $M}}class uF extends lF{constructor(e,t){super(e,t,!1),this._u=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);var t=this._u.syncEngine;this.sharedClientState instanceof BM&&(this.sharedClientState.syncEngine={Nr:(async function(e,t,n,r){var i=e,s=await function(e,n){const r=e,i=r.Fs;return r.persistence.runTransaction("Lookup mutation documents","readonly",t=>i.ln(t,n).next(e=>e?r.ui.Us(t,e):R1.resolve(null)))}(i.localStore,t);null!==s?("pending"===n?await vL(i.remoteStore):"acknowledged"===n||"rejected"===n?(JL(i,t,r||null),YL(i,t),i.localStore.Fs.dn(t)):jR(),await nF(i,s)):MR("SyncEngine","Cannot apply mutation batch with id: "+t)}).bind(null,t),kr:(async function(e,t,n,r){const i=e;if(i.ou)MR("SyncEngine","Ignoring unexpected query state notification.");else if(i.Xa.has(t))switch(n){case"current":case"not-current":{const e=await IM(i.localStore),r=SD.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await nF(i,e,r);break}case"rejected":await _M(i.localStore,t,!0),XL(i,t,r);break;default:jR()}}).bind(null,t),Mr:(async function(e,t,n){const r=oF(e);if(r.ou){for(const e of t)if(r.Xa.has(e))MR("SyncEngine","Adding an already active target "+e);else{const t=await bM(r.localStore,e),n=await yM(r.localStore,t);await WL(r,sF(t),n.targetId,!1),aL(r.remoteStore,n)}for(const e of n)r.Xa.has(e)&&await _M(r.localStore,e,!1).then(()=>{cL(r.remoteStore,e),XL(r,e)}).catch(BO)}}).bind(null,t),Ms:(function(e){return e.localStore.persistence.Ms()}).bind(null,t),Cr:(async function(e){const t=e;return IM(t.localStore).then(e=>nF(t,e))}).bind(null,t)},await this.sharedClientState.start()),await this.persistence.ps(async e=>{await rF(this._u.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())})}hu(e){var t=QM();if(!BM.vt(t))throw new BR(qR.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=aM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new BM(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class hF{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>GL(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=(async function(e,t){const n=e;if(!n.currentUser.isEqual(t)){MR("SyncEngine","User change. New user:",t.toKey());const r=await pM(n.localStore,t);n.currentUser=t,(e=n).iu.forEach(e=>{e.forEach(e=>{e.reject(new BR(qR.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.iu.clear(),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await nF(n,r.ci)}}).bind(null,this.syncEngine),await bL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new RL}createDatastore(e){var t,n,r,i,s=JM(e.databaseInfo.databaseId),t=(t=e.databaseInfo,new GM(t));return n=e.authCredentials,r=e.appCheckCredentials,i=t,e=s,new nL(n,r,i,e)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>GL(this.syncEngine,e,0),s=new(WM.vt()?WM:KM),new iL(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new KL(e,t,n,r,i,s);return o&&(a.ou=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=e;MR("RemoteStore","RemoteStore shutting down."),t.ha.add(5),await oL(t),t.fa.shutdown(),t.da.set("Unknown")}(this.remoteStore)}}function dF(t,n=10240){let r=0;return{async read(){if(r<t.byteLength){var e={value:t.slice(r,r+n),done:!1};return r+=n,e}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}class fF{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.wu(this.observer.next,e)}error(e){this.observer.error?this.wu(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}mu(){this.muted=!0}wu(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class pF{constructor(e,t){this.gu=e,this.M=t,this.metadata=new $R,this.buffer=new Uint8Array,this.yu=new TextDecoder("utf-8"),this.pu().then(e=>{e&&e.Da()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.payload)}`))},e=>this.metadata.reject(e))}close(){return this.gu.cancel()}async getMetadata(){return this.metadata.promise}async cu(){return await this.getMetadata(),this.pu()}async pu(){var e=await this.Iu();if(null===e)return null;var t=this.yu.decode(e),n=Number(t);isNaN(n)&&this.Tu(`length string (${t}) is not valid number`);t=await this.Eu(n);return new ML(JSON.parse(t),e.length+n)}Au(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Iu(){for(;this.Au()<0&&!await this.Ru(););if(0===this.buffer.length)return null;var e=this.Au();e<0&&this.Tu("Reached the end of bundle when a length string is expected.");var t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Eu(e){for(;this.buffer.length<e;)await this.Ru()&&this.Tu("Reached the end of bundle when more is expected.");var t=this.yu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Tu(e){throw this.gu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ru(){var e=await this.gu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class gF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new BR(qR.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const r=e,n=zD(r.M)+"/documents",i={documents:t.map(e=>BD(r.M,e))},s=await r.uo("BatchGetDocuments",n,i),o=new Map;s.forEach(e=>{const t=(n=r.M,"found"in(e=e)?function(e,t){VR(!!t.found),t.found.name,t.found.updateTime;var n=$D(e,t.found.name),r=jD(t.found.updateTime),i=new Kx({mapValue:{fields:t.found.fields}});return Wx.newFoundDocument(n,r,i)}(n,e):"missing"in e?function(e,t){VR(!!t.missing),VR(!!t.readTime);var n=$D(e,t.missing),r=jD(t.readTime);return Wx.newNoDocument(n,r)}(n,e):jR());var n;o.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{var t=o.get(e.toString());VR(!!t),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new oD(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const t=this.readVersions;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((e,t)=>{var n=Sx.fromPath(t);this.mutations.push(new aD(n,this.precondition(n)))}),await async function(e,t){const n=e,r=zD(n.M)+"/documents",i={writes:t.map(e=>YD(n.M,e))};await n.io("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw jR();t=ix.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new BR(qR.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?GP.updateTime(t):GP.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return GP.exists(!0);if(t.isEqual(ix.min()))throw new BR(qR.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return GP.updateTime(t)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class mF{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.bu=5,this.vo=new XM(this.asyncQueue,"transaction_retry")}run(){--this.bu,this.Pu()}Pu(){this.vo.po(async()=>{const t=new gF(this.datastore),e=this.Vu(t);e&&e.then(e=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(e)}).catch(e=>{this.vu(e)}))}).catch(e=>{this.vu(e)})})}Vu(e){try{var t=this.updateFunction(e);return!Ix(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}vu(e){0<this.bu&&this.Su(e)?(--this.bu,this.asyncQueue.enqueueAndForget(()=>(this.Pu(),Promise.resolve()))):this.deferred.reject(e)}Su(e){if("FirebaseError"!==e.name)return!1;var t=e.code;return"aborted"===t||"failed-precondition"===t||!lD(t)}}class vF{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=xR.UNAUTHENTICATED,this.clientId=ZR.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{MR("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(MR("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new BR(qR.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const n=new $R;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),n.resolve()}catch(e){var t=SL(e,"Failed to shutdown persistence");n.reject(t)}}),n.promise}}async function yF(e,t){e.asyncQueue.verifyOperationInProgress(),MR("FirestoreClient","Initializing OfflineComponentProvider");var n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await pM(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}async function _F(e,n){e.asyncQueue.verifyOperationInProgress();var t=await wF(e);MR("FirestoreClient","Initializing OnlineComponentProvider");var r=await e.getConfiguration();await n.initialize(t,r),e.setCredentialChangeListener(e=>wL(n.remoteStore,e)),e.setAppCheckTokenChangeListener((e,t)=>wL(n.remoteStore,t)),e.onlineComponents=n}async function wF(e){return e.offlineComponents||(MR("FirestoreClient","Using default OfflineComponentProvider"),await yF(e,new cF)),e.offlineComponents}async function bF(e){return e.onlineComponents||(MR("FirestoreClient","Using default OnlineComponentProvider"),await _F(e,new hF)),e.onlineComponents}function IF(e){return wF(e).then(e=>e.persistence)}function TF(e){return wF(e).then(e=>e.localStore)}function EF(e){return bF(e).then(e=>e.remoteStore)}function SF(e){return bF(e).then(e=>e.syncEngine)}async function kF(e){const t=await bF(e),n=t.eventManager;return n.onListen=(async function(e,t){const n=oF(e);let r,i;const s=n.Ya.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.za();else{const e=await yM(n.localStore,kP(t));n.isPrimaryClient&&aL(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await WL(n,t,r,"current"===s)}return i}).bind(null,t.syncEngine),n.onUnlisten=(async function(e,t){const n=e,r=n.Ya.get(t),i=n.Xa.get(r.targetId);if(1<i.length)return n.Xa.set(r.targetId,i.filter(e=>!AP(e,t))),void n.Ya.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await _M(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),cL(n.remoteStore,r.targetId),XL(n,r.targetId)}).catch(BO)):(XL(n,r.targetId),await _M(n.localStore,r.targetId,!0))}).bind(null,t.syncEngine),n}function CF(e,t,n={}){const r=new $R;return e.asyncQueue.enqueueAndForget(async()=>function(n,r,i,s,o){const e=new fF({next:e=>{r.enqueueAndForget(()=>PL(n,a));var t=e.docs.has(i);!t&&e.fromCache?o.reject(new BR(qR.UNAVAILABLE,"Failed to get document because the client is offline.")):t&&e.fromCache&&s&&"server"===s.source?o.reject(new BR(qR.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(e)},error:e=>o.reject(e)}),a=new OL(_P(i.path),e,{includeMetadataChanges:!0,Sa:!0});return xL(n,a)}(await kF(e),e.asyncQueue,t,n,r)),r.promise}function AF(e,t,n={}){const r=new $R;return e.asyncQueue.enqueueAndForget(async()=>function(t,n,e,r,i){const s=new fF({next:e=>{n.enqueueAndForget(()=>PL(t,o)),e.fromCache&&"server"===r.source?i.reject(new BR(qR.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(e)},error:e=>i.reject(e)}),o=new OL(e,s,{includeMetadataChanges:!0,Sa:!0});return xL(t,o)}(await kF(e),e.asyncQueue,t,n,r)),r.promise}function NF(e,t,n,r){const i=(n=n,t=JM(t),s="string"==typeof n?(new TextEncoder).encode(n):n,n=function(e){if(e instanceof Uint8Array)return dF(e,void 0);if(e instanceof ArrayBuffer)return dF(new Uint8Array(e),void 0);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(s),t=t,new pF(n,t));var s;e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){const r=e;!async function(t,n,r){try{var i=await n.getMetadata();if(await function(e,t){const n=e,r=jD(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.fs.getBundleMetadata(e,t.id)).then(e=>!!e&&0<=e.createTime.compareTo(r))}(t.localStore,i))return await n.close(),void r._completeWith({taskState:"Success",documentsLoaded:i.totalDocuments,bytesLoaded:i.totalBytes,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes});r._updateProgress(UL(i));const o=new FL(i,t.localStore,n.M);let e=await n.cu();for(;e;){const t=await o.xa(e);t&&r._updateProgress(t),e=await n.cu()}var s=await o.complete();await nF(t,s.$s,void 0),await function(e,t){const n=e;return n.persistence.runTransaction("Save bundle","readwrite",e=>n.fs.saveBundleMetadata(e,t))}(t.localStore,i),r._completeWith(s.progress)}catch(t){FR("SyncEngine",`Loading bundle failed with ${t}`),r._failWith(t)}}(r,t,n).then(()=>{r.sharedClientState.notifyBundleLoaded()})}(await SF(e),i,r)})}const RF=new Map;function xF(e,t,n){if(!n)throw new BR(qR.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function PF(e,t,n,r){if(!0===t&&!0===r)throw new BR(qR.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function DF(e){if(!Sx.isDocumentKey(e))throw new BR(qR.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function OF(e){if(Sx.isDocumentKey(e))throw new BR(qR.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function MF(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":jR();if(e instanceof Array)return"an array";var t=(e=e).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}function LF(e,t){if((e="_delegate"in e?e._delegate:e)instanceof t)return e;if(t.name===e.constructor.name)throw new BR(qR.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=MF(e);throw new BR(qR.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}function FF(e,t){if(t<=0)throw new BR(qR.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class UF{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new BR(qR.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new BR(qR.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,PF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jF{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new UF({}),this._settingsFrozen=!1,e instanceof bx?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new BR(qR.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bx(e.options.projectId)}(e))}get app(){if(!this._app)throw new BR(qR.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new BR(qR.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new UF(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new WR;switch(e.type){case"gapi":var t=e.client;return VR(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new QR(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new BR(qR.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=RF.get(e);t&&(MR("ComponentProvider","Removing Datastore"),RF.delete(e),t.terminate())}(this),Promise.resolve()}}class VF{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new BF(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new VF(this.firestore,e,this._key)}}class qF{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new qF(this.firestore,e,this._query)}}class BF extends qF{constructor(e,t,n){super(e,t,_P(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new VF(this.firestore,null,new Sx(e))}withConverter(e){return new BF(this.firestore,e,this._path)}}function $F(e,t,...n){if(e=Kd(e),xF("collection","path",t),e instanceof jF){var r=lx.fromString(t,...n);return OF(r),new BF(e,null,r)}if(!(e instanceof VF||e instanceof BF))throw new BR(qR.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");r=e._path.child(lx.fromString(t,...n));return OF(r),new BF(e.firestore,null,r)}function KF(e,t,...n){if(e=Kd(e),xF("doc","path",t=1===arguments.length?ZR.R():t),e instanceof jF){var r=lx.fromString(t,...n);return DF(r),new VF(e,null,new Sx(r))}if(!(e instanceof VF||e instanceof BF))throw new BR(qR.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");r=e._path.child(lx.fromString(t,...n));return DF(r),new VF(e.firestore,e instanceof BF?e.converter:null,new Sx(r))}function WF(e,t){return e=Kd(e),t=Kd(t),(e instanceof VF||e instanceof BF)&&(t instanceof VF||t instanceof BF)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function zF(e,t){return e=Kd(e),t=Kd(t),e instanceof qF&&t instanceof qF&&e.firestore===t.firestore&&AP(e._query,t._query)&&e.converter===t.converter}class HF{constructor(){this.Du=Promise.resolve(),this.Cu=[],this.xu=!1,this.Nu=[],this.ku=null,this.Mu=!1,this.Ou=!1,this.$u=[],this.vo=new XM(this,"async_queue_retry"),this.Fu=()=>{var e=YM();e&&MR("AsyncQueue","Visibility state changed to "+e.visibilityState),this.vo.To()};const e=YM();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Fu)}get isShuttingDown(){return this.xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Bu(),this.Lu(e)}enterRestrictedMode(e){if(!this.xu){this.xu=!0,this.Ou=e||!1;const t=YM();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Fu)}}enqueue(e){if(this.Bu(),this.xu)return new Promise(()=>{});const t=new $R;return this.Lu(()=>this.xu&&this.Ou?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Cu.push(e),this.qu()))}async qu(){if(0!==this.Cu.length){try{await this.Cu[0](),this.Cu.shift(),this.vo.reset()}catch(e){if(!M1(e))throw e;MR("AsyncQueue","Operation failed with retryable error: "+e)}0<this.Cu.length&&this.vo.po(()=>this.qu())}}Lu(e){var t=this.Du.then(()=>(this.Mu=!0,e().catch(e=>{throw this.ku=e,this.Mu=!1,LR("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Mu=!1,e))));return this.Du=t}enqueueAfterDelay(e,t,n){this.Bu(),-1<this.$u.indexOf(e)&&(t=0);var r=EL.createAndSchedule(this,e,t,n,e=>this.Uu(e));return this.Nu.push(r),r}Bu(){this.ku&&jR()}verifyOperationInProgress(){}async Ku(){for(var e;await(e=this.Du),e!==this.Du;);}Gu(e){for(const t of this.Nu)if(t.timerId===e)return!0;return!1}Qu(t){return this.Ku().then(()=>{this.Nu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const e of this.Nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Ku()})}ju(e){this.$u.push(e)}Uu(e){var t=this.Nu.indexOf(e);this.Nu.splice(t,1)}}function GF(e){return function(e){if("object"==typeof e&&null!==e){var t=e;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return 1}}(e)}class QF{constructor(){this._progressObserver={},this._taskCompletionResolver=new $R,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}var YF,JF,XF,ZF;class eU extends jF{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new HF,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||nU(this),this._firestoreClient.terminate()}}function tU(e){return e._firestoreClient||nU(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function nU(e){var t,n,r,i,s,o=e._freezeSettings(),o=(n=e._databaseId,r=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",i=e._persistenceKey,s=o,new wx(n,r,i,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams));e._firestoreClient=new vF(e._authCredentials,e._appCheckCredentials,e._queue,o)}function rU(e,n,r){const i=new $R;return e.asyncQueue.enqueue(async()=>{try{await yF(e,r),await _F(e,n),i.resolve()}catch(e){if(!("FirebaseError"===(t=e).name?t.code===qR.FAILED_PRECONDITION||t.code===qR.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),i.reject(e)}var t}).then(()=>i.promise)}function iU(e){return function(e){const t=new $R;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t){const n=e;fL(n.remoteStore)||MR("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(){const t=n.localStore;return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.Fs.getHighestUnacknowledgedBatchId(e))}();if(-1===e)return void t.resolve();const r=n.iu.get(e)||[];r.push(t),n.iu.set(e,r)}catch(e){const n=SL(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await SF(e),t)),t.promise}(tU(e=LF(e,eU)))}function sU(e){return(n=tU(e=LF(e,eU))).asyncQueue.enqueue(async()=>{const e=await IF(n),t=await EF(n);return e.setNetworkEnabled(!0),function(){const e=t;return e.ha.delete(0),sL(e)}()});var n}function oU(e){return(n=tU(e=LF(e,eU))).asyncQueue.enqueue(async()=>{const e=await IF(n),t=await EF(n);return e.setNetworkEnabled(!1),async function(){const e=t;e.ha.add(0),await oL(e),e.da.set("Offline")}()});var n}function aU(t,e){return n=tU(t=LF(t,eU)),r=e,n.asyncQueue.enqueue(async()=>function(e,t){const n=e;return n.persistence.runTransaction("Get named query","readonly",e=>n.fs.getNamedQuery(e,t))}(await TF(n),r)).then(e=>e?new qF(t,null,e.query):null);var n,r}function cU(e){if(e._initialized||e._terminated)throw new BR(qR.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class lU{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new BR(qR.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hx(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class uU{constructor(e){this._byteString=e}static fromBase64String(e){try{return new uU(fx.fromBase64String(e))}catch(e){throw new BR(qR.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new uU(fx.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class hU{constructor(e){this._methodName=e}}class dU{constructor(e,t){if(!isFinite(e)||e<-90||90<e)throw new BR(qR.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new BR(qR.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ex(this._lat,e._lat)||ex(this._long,e._long)}}const fU=/^__.*__$/;class pU{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new nD(e,this.data,this.fieldMask,t,this.fieldTransforms):new tD(e,this.data,t,this.fieldTransforms)}}class gU{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new nD(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function mU(e){switch(e){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw jR()}}class vU{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.M=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Wu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get zu(){return this.settings.zu}Hu(e){return new vU(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.M,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ju(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Hu({path:n,Yu:!1});return r.Xu(e),r}Zu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Hu({path:n,Yu:!1});return r.Wu(),r}tc(e){return this.Hu({path:void 0,Yu:!0})}ec(e){return FU(e,this.settings.methodName,this.settings.nc||!1,this.path,this.settings.sc)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Wu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Xu(this.path.get(e))}Xu(e){if(0===e.length)throw this.ec("Document fields must not be empty");if(mU(this.zu)&&fU.test(e))throw this.ec('Document fields cannot begin and end with "__"')}}class yU{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.M=n||JM(e)}ic(e,t,n,r=!1){return new vU({zu:e,methodName:t,sc:n,path:hx.emptyPath(),Yu:!1,nc:r},this.databaseId,this.M,this.ignoreUndefinedProperties)}}function _U(e){var t=e._freezeSettings(),n=JM(e._databaseId);return new yU(e._databaseId,!!t.ignoreUndefinedProperties,n)}function wU(e,t,n,r,i,s={}){const o=e.ic(s.merge||s.mergeFields?2:0,t,n,i);DU("Data must be an object, but it was:",o,r);var a=xU(r,o);let c,l;if(s.merge)c=new dx(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=OU(t,r,n);if(!o.contains(i))throw new BR(qR.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);UU(e,i)||e.push(i)}c=new dx(e),l=o.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,l=o.fieldTransforms;return new pU(new Kx(a),c,l)}class bU extends hU{_toFieldTransform(e){if(2!==e.zu)throw 1===e.zu?e.ec(`${this._methodName}() can only appear at the top level of your update data`):e.ec(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bU}}function IU(e,t,n){return new vU({zu:3,sc:t.settings.sc,methodName:e._methodName,Yu:n},t.databaseId,t.M,t.ignoreUndefinedProperties)}class TU extends hU{_toFieldTransform(e){return new zP(e.path,new UP)}isEqual(e){return e instanceof TU}}class EU extends hU{constructor(e,t){super(e),this.rc=t}_toFieldTransform(e){const t=IU(this,e,!0),n=this.rc.map(e=>RU(e,t)),r=new jP(n);return new zP(e.path,r)}isEqual(e){return this===e}}class SU extends hU{constructor(e,t){super(e),this.rc=t}_toFieldTransform(e){const t=IU(this,e,!0),n=this.rc.map(e=>RU(e,t)),r=new qP(n);return new zP(e.path,r)}isEqual(e){return this===e}}class kU extends hU{constructor(e,t){super(e),this.oc=t}_toFieldTransform(e){var t=new $P(e.M,MP(e.M,this.oc));return new zP(e.path,t)}isEqual(e){return this===e}}function CU(e,i,s,t){const o=e.ic(1,i,s);DU("Data must be an object, but it was:",o,t);const a=[],c=Kx.empty();ox(t,(e,t)=>{var n=LU(i,e,s);t=Kd(t);var r=o.Zu(n);if(t instanceof bU)a.push(n);else{const e=RU(t,r);null!=e&&(a.push(n),c.set(n,e))}});var n=new dx(a);return new gU(c,n,o.fieldTransforms)}function AU(e,t,n,r,i,s){const o=e.ic(1,t,n),a=[OU(t,r,n)],c=[i];if(s.length%2!=0)throw new BR(qR.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(OU(t,s[f])),c.push(s[f+1]);const l=[],u=Kx.empty();for(let p=a.length-1;0<=p;--p)if(!UU(l,a[p])){const t=a[p];var h=Kd(h=c[p]);const r=o.Zu(t);if(h instanceof bU)l.push(t);else{const e=RU(h,r);null!=e&&(l.push(t),u.set(t,e))}}var d=new dx(l);return new gU(u,d,o.fieldTransforms)}function NU(e,t,n,r=!1){return RU(n,e.ic(r?4:3,t))}function RU(s,e){if(PU(s=Kd(s)))return DU("Unsupported field value:",e,s),xU(s,e);if(s instanceof hU)return function(e,t){if(!mU(t.zu))throw t.ec(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.ec(`${e._methodName}() is not currently supported inside arrays`);var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(s,e),null;if(void 0===s&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.Yu&&4!==e.zu)throw e.ec("Nested arrays are not supported");return function(t){const n=[];let r=0;for(const i of s){let e=RU(i,t.tc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e)}return function(e,t){if(null===(e=Kd(s)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return MP(t.M,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=rx.fromDate(e);return{timestampValue:FD(t.M,n)}}if(e instanceof rx){n=new rx(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:FD(t.M,n)}}if(e instanceof dU)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof uU)return{bytesValue:UD(t.M,e._byteString)};if(e instanceof VF){const r=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(r))throw t.ec(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:VD(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ec(`Unsupported field value: ${MF(e)}`)}(0,e)}function xU(e,r){const i={};return ax(e)?r.path&&0<r.path.length&&r.fieldMask.push(r.path):ox(e,(e,t)=>{var n=RU(t,r.Ju(e));null!=n&&(i[e]=n)}),{mapValue:{fields:i}}}function PU(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof rx||e instanceof dU||e instanceof uU||e instanceof VF||e instanceof hU)}function DU(e,t,n){if(!PU(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=MF(n);throw"an object"===r?t.ec(e+" a custom object"):t.ec(e+" "+r)}var i}function OU(e,t,n){if((t=Kd(t))instanceof lU)return t._internalPath;if("string"==typeof t)return LU(e,t);throw FU("Field path arguments must be of type string or ",e,!1,void 0,n)}const MU=new RegExp("[~\\*/\\[\\]]");function LU(t,n,r){if(0<=n.search(MU))throw FU(`Invalid field path (${n}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new lU(...n.split("."))._internalPath}catch(e){throw FU(`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function FU(e,t,n,r,i){var s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new BR(qR.INVALID_ARGUMENT,a+e+c)}function UU(e,t){return e.some(e=>e.isEqual(t))}class jU{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new VF(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){var e=new VU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){var t=this._document.data.field(qU("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class VU extends jU{data(){return super.data()}}function qU(e,t){return"string"==typeof t?LU(e,t):(t instanceof lU?t:t._delegate)._internalPath}class BU{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $U extends jU{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){var t=new KU(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){var n=this._document.data.field(qU("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class KU extends $U{data(e={}){return super.data(e)}}class WU{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new BU(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,n){this._snapshot.docs.forEach(e=>{t.call(n,new KU(this._firestore,this._userDataWriter,e.key,e,new BU(this._snapshot.mutatedKeys.has(e.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){var t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new BR(qR.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,t){if(s._snapshot.oldDocs.isEmpty()){let t=0;return s._snapshot.docChanges.map(e=>({type:"added",doc:new KU(s._firestore,s._userDataWriter,e.doc.key,e.doc,new BU(s._snapshot.mutatedKeys.has(e.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:t++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(e=>t||3!==e.type).map(e=>{var t=new KU(s._firestore,s._userDataWriter,e.doc.key,e.doc,new BU(s._snapshot.mutatedKeys.has(e.doc.key),s._snapshot.fromCache),s.query.converter);let n=-1,r=-1;return 0!==e.type&&(n=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(i=i.add(e.doc),r=i.indexOf(e.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jR()}}(e.type),doc:t,oldIndex:n,newIndex:r}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function zU(e,t){return e instanceof $U&&t instanceof $U?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof WU&&t instanceof WU&&e._firestore===t._firestore&&zF(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function HU(e){if(bP(e)&&0===e.explicitOrderBy.length)throw new BR(qR.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class GU{}function QU(e,...t){for(const n of t)e=n._apply(e);return e}class YU extends GU{constructor(e,t,n){super(),this.ac=e,this.uc=t,this.cc=n,this.type="where"}_apply(e){var t=_U(e.firestore),t=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new BR(qR.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){rj(o,s);const t=[];for(const n of o)t.push(nj(r,e,n));a={arrayValue:{values:t}}}else a=nj(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||rj(o,s),a=NU(n,t,o,"in"===s||"not-in"===s);var c=iP.create(i,s,a);return function(e,t){if(t.S()){const r=TP(e);if(null!==r&&!r.isEqual(t.field))throw new BR(qR.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${t.field.toString()}'`);var n=IP(e);null!==n&&ij(0,t.field,n)}const r=function(e,t){for(const n of e.filters)if(0<=t.indexOf(n.op))return n.op;return null}(e,function(){switch(t.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===t.op?new BR(qR.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new BR(qR.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}(e,c),c}(e._query,"where",t,e.firestore._databaseId,this.ac,this.uc,this.cc);return new qF(e.firestore,e.converter,(e=e._query,t=e.filters.concat([t]),new vP(e.path,e.collectionGroup,e.explicitOrderBy.slice(),t,e.limit,e.limitType,e.startAt,e.endAt)))}}class JU extends GU{constructor(e,t){super(),this.ac=e,this.hc=t,this.type="orderBy"}_apply(e){var t=function(e,t,n){if(null!==e.startAt)throw new BR(qR.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new BR(qR.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i=new pP(t,n);return n=i,null!==IP(e=e)||null!==(r=TP(e))&&ij(0,r,n.field),i}(e._query,this.ac,this.hc);return new qF(e.firestore,e.converter,(e=e._query,t=e.explicitOrderBy.concat([t]),new vP(e.path,e.collectionGroup,t,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))}}class XU extends GU{constructor(e,t,n){super(),this.type=e,this.lc=t,this.fc=n}_apply(e){return new qF(e.firestore,e.converter,CP(e._query,this.lc,this.fc))}}class ZU extends GU{constructor(e,t,n){super(),this.type=e,this.dc=t,this._c=n}_apply(e){var t,n=tj(e,this.type,this.dc,this._c);return new qF(e.firestore,e.converter,(t=e._query,e=n,new vP(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))}}class ej extends GU{constructor(e,t,n){super(),this.type=e,this.dc=t,this._c=n}_apply(e){var t,n=tj(e,this.type,this.dc,this._c);return new qF(e.firestore,e.converter,(t=e._query,e=n,new vP(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))}}function tj(e,t,n,r){if(n[0]=Kd(n[0]),n[0]instanceof jU)return function(e,t,n,r,i){if(!r)throw new BR(qR.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of SP(e))if(n.field.isKeyField())s.push(Ox(t,r.key));else{const e=r.data.field(n.field);if(yx(e))throw new BR(qR.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new BR(qR.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new fP(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=_U(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new BR(qR.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let c=0;c<i.length;c++){const l=i[c];if(o[c].field.isKeyField()){if("string"!=typeof l)throw new BR(qR.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof l}`);if(!EP(e)&&-1!==l.indexOf("/"))throw new BR(qR.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${l}' contains a slash.`);const n=e.path.child(lx.fromString(l));if(!Sx.isDocumentKey(n))throw new BR(qR.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new Sx(n);a.push(Ox(t,i))}else{const e=NU(n,r,l);a.push(e)}}return new fP(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}function nj(e,t,n){if("string"==typeof(n=Kd(n))){if(""===n)throw new BR(qR.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!EP(t)&&-1!==n.indexOf("/"))throw new BR(qR.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);var r=t.path.child(lx.fromString(n));if(!Sx.isDocumentKey(r))throw new BR(qR.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ox(e,new Sx(r))}if(n instanceof VF)return Ox(e,n._key);throw new BR(qR.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${MF(n)}.`)}function rj(e,t){if(!Array.isArray(e)||0===e.length)throw new BR(qR.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(10<e.length)throw new BR(qR.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function ij(e,t,n){if(!n.isEqual(t))throw new BR(qR.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class sj{convertValue(e,t="none"){switch(Ax(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mx(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vx(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw jR()}}convertObject(e,n){const r={};return ox(e.fields,(e,t)=>{r[e]=this.convertValue(t,n)}),r}convertGeoPoint(e){return new dU(mx(e.latitude),mx(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":var n=function e(t){var n=t.mapValue.fields.__previous_value__;return yx(n)?e(n):n}(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(_x(e));default:return null}}convertTimestamp(e){var t=gx(e);return new rx(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=lx.fromString(e);VR(s1(n));const r=new bx(n.get(1),n.get(3)),i=new Sx(n.popFirst(5));return r.isEqual(t)||LR(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function oj(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}class aj extends sj{constructor(e){super(),this.firestore=e}convertBytes(e){return new uU(e)}convertReference(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new VF(this.firestore,null,t)}}class cj{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=_U(e)}set(e,t,n){this._verifyNotCommitted();const r=lj(e,this._firestore),i=oj(r.converter,t,n),s=wU(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,GP.none())),this}update(e,t,n,...r){this._verifyNotCommitted();var i=lj(e,this._firestore);let s;return s="string"==typeof(t=Kd(t))||t instanceof lU?AU(this._dataReader,"WriteBatch.update",i._key,t,n,r):CU(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,GP.exists(!0))),this}delete(e){this._verifyNotCommitted();var t=lj(e,this._firestore);return this._mutations=this._mutations.concat(new oD(t._key,GP.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new BR(qR.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function lj(e,t){if((e=Kd(e)).firestore!==t)throw new BR(qR.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class uj extends sj{constructor(e){super(),this.firestore=e}convertBytes(e){return new uU(e)}convertReference(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new VF(this.firestore,null,t)}}function hj(t){t=LF(t,VF);const n=LF(t.firestore,eU),e=tU(n),r=new uj(n);return function(e,t){const n=new $R;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const i=await function(t){const n=e;return n.persistence.runTransaction("read document","readonly",e=>n.ui.Bs(e,t))}(t);i.isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new BR(qR.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){var r=SL(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await TF(e),t,n)),n.promise}(e,t._key).then(e=>new $U(n,r,t._key,e,new BU(null!==e&&e.hasLocalMutations,!0),t.converter))}function dj(t){t=LF(t,qF);const n=LF(t.firestore,eU),e=tU(n),r=new uj(n);return function(e,t){const n=new $R;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const i=await wM(e,t,!0),s=new qL(t,i.hi),o=s.La(i.documents),a=s.applyChanges(o,!1);n.resolve(a.snapshot)}catch(e){var r=SL(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await TF(e),t,n)),n.promise}(e,t._query).then(e=>new WU(n,r,t,e))}function fj(e,t,n){e=LF(e,VF);var r=LF(e.firestore,eU),i=oj(e.converter,t,n);return vj(r,[wU(_U(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,GP.none())])}function pj(e,t,n,...r){e=LF(e,VF);var i=LF(e.firestore,eU),s=_U(i);let o;return o="string"==typeof(t=Kd(t))||t instanceof lU?AU(s,"updateDoc",e._key,t,n,r):CU(s,"updateDoc",e._key,t),vj(i,[o.toMutation(e._key,GP.exists(!0))])}function gj(t,...n){var e;t=Kd(t);let r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||GF(n[i])||(r=n[i],i++);var s={includeMetadataChanges:r.includeMetadataChanges};if(GF(n[i])){const t=n[i];n[i]=null===(e=t.next)||void 0===e?void 0:e.bind(t),n[i+1]=null===(e=t.error)||void 0===e?void 0:e.bind(t),n[i+2]=null===(e=t.complete)||void 0===e?void 0:e.bind(t)}let o,a,c;if(t instanceof VF)a=LF(t.firestore,eU),c=_P(t._key.path),o={next:e=>{n[i]&&n[i](yj(a,t,e))},error:n[i+1],complete:n[i+2]};else{const l=LF(t,qF);a=LF(l.firestore,eU),c=l._query;const u=new uj(a);o={next:e=>{n[i]&&n[i](new WU(a,u,l,e))},error:n[i+1],complete:n[i+2]},HU(t._query)}return function(e,t,n,r){const i=new fF(r),s=new OL(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>xL(await kF(e),s)),()=>{i.mu(),e.asyncQueue.enqueueAndForget(async()=>PL(await kF(e),s))}}(tU(a),c,s,o)}function mj(e,t){return function(e,t){const n=new fF(t);return e.asyncQueue.enqueueAndForget(async()=>function(e,t){e.Ia.add(t),t.next()}(await kF(e),n)),()=>{n.mu(),e.asyncQueue.enqueueAndForget(async()=>function(e,t){e.Ia.delete(t)}(await kF(e),n))}}(tU(e=LF(e,eU)),GF(t)?t:{next:t})}function vj(e,t){return function(e,t){const n=new $R;return e.asyncQueue.enqueueAndForget(async()=>zL(await SF(e),t,n)),n.promise}(tU(e),t)}function yj(e,t,n){var r=n.docs.get(t._key),i=new uj(e);return new $U(e,i,t._key,r,new BU(n.hasPendingWrites,n.fromCache),t.converter)}class _j extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=_U(e)}get(e){const n=lj(e,this._firestore),r=new aj(this._firestore);return this._transaction.lookup([n._key]).then(e=>{if(!e||1!==e.length)return jR();const t=e[0];if(t.isFoundDocument())return new jU(this._firestore,r,t.key,t,n.converter);if(t.isNoDocument())return new jU(this._firestore,r,n._key,null,n.converter);throw jR()})}set(e,t,n){var r=lj(e,this._firestore),i=oj(r.converter,t,n),i=wU(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,i),this}update(e,t,n,...r){var i=lj(e,this._firestore),s="string"==typeof(t=Kd(t))||t instanceof lU?AU(this._dataReader,"Transaction.update",i._key,t,n,r):CU(this._dataReader,"Transaction.update",i._key,t);return this._transaction.update(i._key,s),this}delete(e){var t=lj(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=lj(e,this._firestore),n=new uj(this._firestore);return super.get(e).then(e=>new $U(this._firestore,n,t._key,e._document,new BU(!1,!1),t.converter))}}function wj(t,n){return function(t,n){const r=new $R;return t.asyncQueue.enqueueAndForget(async()=>{var e=await bF(t).then(e=>e.datastore);new mF(t.asyncQueue,e,n,r).run()}),r.promise}(tU(t=LF(t,eU)),e=>n(new _j(t,e)))}z=Rf,PR=z,kf(new Wd("firestore",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=new eU(n,new HR(e.getProvider("auth-internal")),new JR(e.getProvider("app-check-internal")));return t=Object.assign({useFetchStreams:!0},t),r._setSettings(t),r},"PUBLIC")),Of(RR,"3.4.5",void 0),Of(RR,"3.4.5","esm2017");function bj(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new BR("invalid-argument",`Invalid options passed to function ${e}(): You cannot `+'specify both "merge" and "mergeFields".');return t}function Ij(){if("undefined"==typeof Uint8Array)throw new BR("unimplemented","Uint8Arrays are not available in this environment.")}function Tj(){if("undefined"==typeof atob)throw new BR("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Ej{constructor(e){this._delegate=e}static fromBase64String(e){return Tj(),new Ej(uU.fromBase64String(e))}static fromUint8Array(e){return Ij(),new Ej(uU.fromUint8Array(e))}toBase64(){return Tj(),this._delegate.toBase64()}toUint8Array(){return Ij(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Sj(e){return function(e,t){if("object"!=typeof e||null===e)return;var n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return 1;return}(e,["next","error","complete"])}class kj{enableIndexedDbPersistence(e,t){return function(e,t){cU(e=LF(e,eU));var n=tU(e),r=e._freezeSettings(),i=new hF;return rU(n,i,new lF(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){cU(e=LF(e,eU));var t=tU(e),n=e._freezeSettings(),r=new hF;return rU(t,r,new uF(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new BR(qR.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new $R;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!P1.vt())return Promise.resolve();var t=e+"main";await P1.delete(t)}(aM(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}(e._delegate)}}class Cj{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof bx||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||FR("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function(n,e,t,r={}){var i;const s=(n=LF(n,jF))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&FR("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let e,t;if("string"==typeof r.mockUserToken)e=r.mockUserToken,t=xR.MOCK_USER;else{e=id(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new BR(qR.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t=new xR(s)}n._authCredentials=new zR(new KR(e,t))}}(this._delegate,e,t,n)}enableNetwork(){return sU(this._delegate)}disableNetwork(){return oU(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,PF("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return iU(this._delegate)}onSnapshotsInSync(e){return mj(this._delegate,e)}get app(){if(!this._appCompat)throw new BR("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new qj(this,$F(this._delegate,e))}catch(e){throw Dj(e,"collection()","Firestore.collection()")}}doc(e){try{return new Pj(this,KF(this._delegate,e))}catch(e){throw Dj(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Uj(this,function(e,t){if(e=LF(e,jF),xF("collectionGroup","collection id",t),0<=t.indexOf("/"))throw new BR(qR.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qF(e,null,(t=t,new vP(lx.emptyPath(),t)))}(this._delegate,e))}catch(e){throw Dj(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return wj(this._delegate,e=>t(new Nj(this,e)))}batch(){return tU(this._delegate),new Rj(new cj(this._delegate,e=>vj(this._delegate,e)))}loadBundle(e){return t=this._delegate,e=e,n=tU(t=LF(t,eU)),r=new QF,NF(n,t._databaseId,e,r),r;var t,n,r}namedQuery(e){return aU(this._delegate,e).then(e=>e?new Uj(this,e):null)}}class Aj extends sj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ej(new uU(e))}convertReference(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return Pj.forKey(t,this.firestore,null)}}class Nj{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Aj(e)}get(e){const t=Bj(e);return this._delegate.get(t).then(e=>new Lj(this._firestore,new $U(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter)))}set(e,t,n){var r=Bj(e);return n?(bj("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){var i=Bj(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){var t=Bj(e);return this._delegate.delete(t),this}}class Rj{constructor(e){this._delegate=e}set(e,t,n){var r=Bj(e);return n?(bj("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){var i=Bj(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){var t=Bj(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class xj{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){var n=new KU(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Fj(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=xj.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new xj(e,new Aj(e),t),r.set(t,i)),i}}xj.INSTANCES=new WeakMap;class Pj{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Aj(e)}static forPath(e,t,n){if(e.length%2!=0)throw new BR("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+`${e.canonicalString()} has ${e.length}`);return new Pj(t,new VF(t._delegate,n,new Sx(e)))}static forKey(e,t,n){return new Pj(t,new VF(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new qj(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new qj(this.firestore,$F(this._delegate,e))}catch(e){throw Dj(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Kd(e))instanceof VF&&WF(this._delegate,e)}set(e,t){t=bj("DocumentReference.set",t);try{return t?fj(this._delegate,e,t):fj(this._delegate,e)}catch(e){throw Dj(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?pj(this._delegate,e):pj(this._delegate,e,t,...n)}catch(e){throw Dj(e,"updateDoc()","DocumentReference.update()")}}delete(){return vj(LF((e=this._delegate).firestore,eU),[new oD(e._key,GP.none())]);var e}onSnapshot(...e){var t=Oj(e),n=Mj(e,e=>new Lj(this.firestore,new $U(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)));return gj(this._delegate,t,n)}get(e){let t;return t=("cache"===(null==e?void 0:e.source)?hj:"server"===(null==e?void 0:e.source)?function(t){t=LF(t,VF);const n=LF(t.firestore,eU);return CF(tU(n),t._key,{source:"server"}).then(e=>yj(n,t,e))}:function(t){t=LF(t,VF);const n=LF(t.firestore,eU);return CF(tU(n),t._key).then(e=>yj(n,t,e))})(this._delegate),t.then(e=>new Lj(this.firestore,new $U(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)))}withConverter(e){return new Pj(this.firestore,e?this._delegate.withConverter(xj.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Dj(e,t,n){return e.message=e.message.replace(t,n),e}function Oj(e){for(const t of e)if("object"==typeof t&&!Sj(t))return t;return{}}function Mj(e,t){var n;let r;return r=Sj(e[0])?e[0]:Sj(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{r.next&&r.next(t(e))},error:null===(n=r.error)||void 0===n?void 0:n.bind(r),complete:null===(n=r.complete)||void 0===n?void 0:n.bind(r)}}class Lj{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Pj(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return zU(this._delegate,e._delegate)}}class Fj extends Lj{data(e){var t=this._delegate.data(e);return void 0!==t||jR(),t}}class Uj{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Aj(e)}where(e,t,n){try{return new Uj(this.firestore,QU(this._delegate,(r=n,i=t,s=qU("where",e),new YU(s,i,r))))}catch(e){throw Dj(e,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,s}orderBy(e,t){try{return new Uj(this.firestore,QU(this._delegate,([n,r="asc"]=[e,t],i=r,s=qU("orderBy",n),new JU(s,i))))}catch(e){throw Dj(e,/(orderBy|where)\(\)/,"Query.$1()")}var n,r,i,s}limit(e){try{return new Uj(this.firestore,QU(this._delegate,(FF("limit",t=e),new XU("limit",t,"F"))))}catch(e){throw Dj(e,"limit()","Query.limit()")}var t}limitToLast(e){try{return new Uj(this.firestore,QU(this._delegate,(FF("limitToLast",t=e),new XU("limitToLast",t,"L"))))}catch(e){throw Dj(e,"limitToLast()","Query.limitToLast()")}var t}startAt(...e){try{return new Uj(this.firestore,QU(this._delegate,function(...e){return new ZU("startAt",e,!0)}(...e)))}catch(e){throw Dj(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Uj(this.firestore,QU(this._delegate,function(...e){return new ZU("startAfter",e,!1)}(...e)))}catch(e){throw Dj(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Uj(this.firestore,QU(this._delegate,function(...e){return new ej("endBefore",e,!1)}(...e)))}catch(e){throw Dj(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Uj(this.firestore,QU(this._delegate,function(...e){return new ej("endAt",e,!0)}(...e)))}catch(e){throw Dj(e,"endAt()","Query.endAt()")}}isEqual(e){return zF(this._delegate,e._delegate)}get(e){let t;return t=("cache"===(null==e?void 0:e.source)?dj:"server"===(null==e?void 0:e.source)?function(t){t=LF(t,qF);const n=LF(t.firestore,eU),e=tU(n),r=new uj(n);return AF(e,t._query,{source:"server"}).then(e=>new WU(n,r,t,e))}:function(t){t=LF(t,qF);const n=LF(t.firestore,eU),e=tU(n),r=new uj(n);return HU(t._query),AF(e,t._query).then(e=>new WU(n,r,t,e))})(this._delegate),t.then(e=>new Vj(this.firestore,new WU(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)))}onSnapshot(...e){var t=Oj(e),n=Mj(e,e=>new Vj(this.firestore,new WU(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)));return gj(this._delegate,t,n)}withConverter(e){return new Uj(this.firestore,e?this._delegate.withConverter(xj.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class jj{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Fj(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Vj{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Uj(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Fj(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(e=>new jj(this._firestore,e))}forEach(t,n){this._delegate.forEach(e=>{t.call(n,new Fj(this._firestore,e))})}isEqual(e){return zU(this._delegate,e._delegate)}}class qj extends Uj{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){var e=this._delegate.parent;return e?new Pj(this.firestore,e):null}doc(e){try{return void 0===e?new Pj(this.firestore,KF(this._delegate)):new Pj(this.firestore,KF(this._delegate,e))}catch(e){throw Dj(e,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=LF(e.firestore,eU),r=KF(e),i=oj(e.converter,t);return vj(n,[wU(_U(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,GP.exists(!1))]).then(()=>r)}(this._delegate,e).then(e=>new Pj(this.firestore,e))}isEqual(e){return WF(this._delegate,e._delegate)}withConverter(e){return new qj(this.firestore,e?this._delegate.withConverter(xj.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Bj(e){return LF(e,VF)}const $j={Firestore:Cj,GeoPoint:dU,Timestamp:rx,Blob:Ej,Transaction:Nj,WriteBatch:Rj,DocumentReference:Pj,DocumentSnapshot:Lj,Query:Uj,QueryDocumentSnapshot:Fj,QuerySnapshot:Vj,CollectionReference:qj,FieldPath:class q${constructor(...e){this._delegate=new lU(...e)}static documentId(){return new q$(hx.keyField().canonicalString())}isEqual(e){return(e=Kd(e))instanceof lU&&this._delegate._internalPath.isEqual(e._internalPath)}},FieldValue:class B${constructor(e){this._delegate=e}static serverTimestamp(){const e=new TU("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new B$(e)}static delete(){const e=new bU("deleteField");return e._methodName="FieldValue.delete",new B$(e)}static arrayUnion(...e){const t=function(...e){return new EU("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new B$(t)}static arrayRemove(...e){const t=function(...e){return new SU("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new B$(t)}static increment(e){const t=new kU("increment",e);return t._methodName="FieldValue.increment",new B$(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}},setLogLevel:function(e){e=e,DR.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};YF=Xf,JF=(e,t)=>new Cj(e,t,new kj),YF.INTERNAL.registerComponent(new Wd("firestore-compat",e=>{var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("firestore").getImmediate();return JF(t,n)},"PUBLIC").setServiceProps(Object.assign({},$j))),YF.registerVersion("@firebase/firestore-compat","0.1.14");function Kj(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function Wj(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>Wj(e)):"function"==typeof e||"object"==typeof e?Kj(e,e=>Wj(e)):e}const zj="functions",Hj={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Gj extends gd{constructor(e,t,n){super(`${zj}/${e}`,t||""),this.details=n}}function Qj(e,t){let n=function(e){if(200<=e&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=n,i=void 0;try{var s=t&&t.error;if(s){const e=s.status;if("string"==typeof e){if(!Hj[e])return new Gj("internal","internal");n=Hj[e],r=e}var o=s.message;"string"==typeof o&&(r=o),i=s.details,void 0!==i&&(i=Wj(i))}}catch(e){}return"ok"===n?null:new Gj(n,r,i)}class Yj{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(e=>this.auth=e,()=>{}),this.messaging||t.get().then(e=>this.messaging=e,()=>{}),this.appCheck||n.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{var e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){var e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken()}}}const Jj="us-central1";class Xj{constructor(e,t,n,r,i=Jj,s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Yj(t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{var o=new URL(i);this.customDomain=o.origin,this.region=Jj}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){var t=this.app.options.projectId;return null===this.emulatorOrigin?null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`:`${this.emulatorOrigin}/${t}/${this.region}/${e}`}}function Zj(t,n,r){return e=>async function(e,t,n,r){const i=e._url(t),s={data:n=function t(e){if(null==e)return null;if("number"==typeof(e=e instanceof Number?e.valueOf():e)&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>t(e));if("function"==typeof e||"object"==typeof e)return Kj(e,e=>t(e));throw new Error("Data cannot be encoded in JSON: "+e)}(n)},o={},a=await e.contextProvider.getContext();a.authToken&&(o.Authorization="Bearer "+a.authToken);a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken);null!==a.appCheckToken&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const c=r.timeout||7e4,l=function(n){let r=null;return{promise:new Promise((e,t)=>{r=setTimeout(()=>{t(new Gj("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{r&&clearTimeout(r)}}}(c),u=await Promise.race([async function(e,t,n,r){n["Content-Type"]="application/json";let i;try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}(i,s,o,e.fetchImpl),l.promise,e.cancelAllRequests]);if(l.cancel(),!u)throw new Gj("cancelled","Firebase Functions instance was deleted.");var h=Qj(u.status,u.json);if(h)throw h;if(!u.json)throw new Gj("internal","Response is not valid JSON object.");let d=u.json.data;void 0===d&&(d=u.json.result);if(void 0===d)throw new Gj("internal","Response is missing data field.");h=Wj(d);return{data:h}}(t,n,e,r||{})}const eV="@firebase/functions";function tV(e,t,n){Kd(e).emulatorOrigin=`http://${t}:${n}`}XF=fetch.bind(self),kf(new Wd(zj,(e,{instanceIdentifier:t})=>{var n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging-internal"),s=e.getProvider("app-check-internal");return new Xj(n,r,i,s,t,XF)},"PUBLIC").setMultipleInstances(!0)),Of(eV,"0.7.8",ZF),Of(eV,"0.7.8","esm2017");var nV,rV,iV,sV;class oV{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return Zj(Kd(this._delegate),e,t)}useFunctionsEmulator(e){var t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new gd("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new gd("functions","Port missing in origin provided to useFunctionsEmulator()");return tV(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return tV(this._delegate,e,t)}}const aV="us-central1",cV=(e,{instanceIdentifier:t})=>{var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions").getImmediate({identifier:null!=t?t:aV});return new oV(n,r)};nV={Functions:oV},Xf.INTERNAL.registerComponent(new Wd("functions-compat",cV,"PUBLIC").setServiceProps(nV).setMultipleInstances(!0)),Xf.registerVersion("@firebase/functions-compat","0.1.9");const lV="/firebase-messaging-sw.js",uV="/firebase-cloud-messaging-push-scope",hV="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",dV="https://fcmregistrations.googleapis.com/v1",fV="google.c.a.c_id",pV="google.c.a.e";function gV(e){var t=new Uint8Array(e);const n=btoa(String.fromCharCode(...t));return n.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(yt=T2=T2||{})[yt.DATA_MESSAGE=1]="DATA_MESSAGE",yt[yt.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",(yt=rV=rV||{}).PUSH_RECEIVED="push-received",yt.NOTIFICATION_CLICKED="notification-clicked";const mV="fcm_token_details_db",vV="fcm_token_object_Store";async function yV(s){if("databases"in indexedDB){const t=await indexedDB.databases(),n=t.map(e=>e.name);if(!n.includes(mV))return null}let o=null;const e=await pf(mV,5,async e=>{var t;if(!(e.oldVersion<2)&&e.objectStoreNames.contains(vV)){const i=e.transaction.objectStore(vV);var n,r=await i.index("fcmSenderId").get(s);await i.clear(),r&&(2===e.oldVersion?(n=r).auth&&n.p256dh&&n.endpoint&&(o={token:n.fcmToken,createTime:null!==(t=n.createTime)&&void 0!==t?t:Date.now(),subscriptionOptions:{auth:n.auth,p256dh:n.p256dh,endpoint:n.endpoint,swScope:n.swScope,vapidKey:"string"==typeof n.vapidKey?n.vapidKey:gV(n.vapidKey)}}):3===e.oldVersion?(n=r,o={token:n.fcmToken,createTime:n.createTime,subscriptionOptions:{auth:gV(n.auth),p256dh:gV(n.p256dh),endpoint:n.endpoint,swScope:n.swScope,vapidKey:gV(n.vapidKey)}}):4===e.oldVersion&&(r=r,o={token:r.fcmToken,createTime:r.createTime,subscriptionOptions:{auth:gV(r.auth),p256dh:gV(r.p256dh),endpoint:r.endpoint,swScope:r.swScope,vapidKey:gV(r.vapidKey)}}))}});return e.close(),await gf(mV),await gf("fcm_vapid_details_db"),await gf("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;var t=e["subscriptionOptions"];return"number"==typeof e.createTime&&0<e.createTime&&"string"==typeof e.token&&0<e.token.length&&"string"==typeof t.auth&&0<t.auth.length&&"string"==typeof t.p256dh&&0<t.p256dh.length&&"string"==typeof t.endpoint&&0<t.endpoint.length&&"string"==typeof t.swScope&&0<t.swScope.length&&"string"==typeof t.vapidKey&&0<t.vapidKey.length}(o)?o:null}const _V="firebase-messaging-database",wV=1,bV="firebase-messaging-store";let IV=null;function TV(){return IV=IV||pf(_V,wV,e=>{0===e.oldVersion&&e.createObjectStore(bV)}),IV}async function EV(e){var t=kV(e);const n=await TV();t=await n.transaction(bV).objectStore(bV).get(t);if(t)return t;t=await yV(e.appConfig.senderId);return t?(await SV(e,t),t):void 0}async function SV(e,t){var n=kV(e);const r=await TV(),i=r.transaction(bV,"readwrite");return await i.objectStore(bV).put(t,n),await i.complete,t}function kV({appConfig:e}){return e.appId}const CV=new md("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function AV(e,t){var n={method:"DELETE",headers:await RV(e)};try{const s=await fetch(`${NV(e.appConfig)}/${t}`,n);var r=await s.json();if(r.error){var i=r.error.message;throw CV.create("token-unsubscribe-failed",{errorInfo:i})}}catch(e){throw CV.create("token-unsubscribe-failed",{errorInfo:e})}}function NV({projectId:e}){return`${dV}/projects/${e}/registrations`}async function RV({appConfig:e,installations:t}){var n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function xV({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==hV&&(i.web.applicationPubKey=r),i}const PV=6048e5;async function DV(e){const t=await async function(e,t){var n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/");const n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}(t)})}(e.swRegistration,e.vapidKey);var n,r,i,s,o,a={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:gV(t.getKey("auth")),p256dh:gV(t.getKey("p256dh"))},c=await EV(e.firebaseDependencies);if(c){if(n=c.subscriptionOptions,r=a.vapidKey===n.vapidKey,i=a.endpoint===n.endpoint,s=a.auth===n.auth,o=a.p256dh===n.p256dh,r&&i&&s&&o)return Date.now()>=c.createTime+PV?async function(t,e){try{var n=await async function(e,t){var n=await RV(e),r=xV(t.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{const s=await fetch(`${NV(e.appConfig)}/${t.token}`,r);i=await s.json()}catch(e){throw CV.create("token-update-failed",{errorInfo:e})}if(i.error){r=i.error.message;throw CV.create("token-update-failed",{errorInfo:r})}if(!i.token)throw CV.create("token-update-no-token");return i.token}(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await SV(t.firebaseDependencies,r),n}catch(e){throw await OV(t),e}}(e,{token:c.token,createTime:Date.now(),subscriptionOptions:a}):c.token;try{await AV(e.firebaseDependencies,c.token)}catch(e){console.warn(e)}return MV(e.firebaseDependencies,a)}return MV(e.firebaseDependencies,a)}async function OV(e){var t=await EV(e.firebaseDependencies);t&&(await AV(e.firebaseDependencies,t.token),await async function(e){var t=kV(e);const n=await TV(),r=n.transaction(bV,"readwrite");await r.objectStore(bV).delete(t),await r.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function MV(e,t){var n={token:await async function(e,t){var n=await RV(e),r=xV(t),r={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{const s=await fetch(NV(e.appConfig),r);i=await s.json()}catch(e){throw CV.create("token-subscribe-failed",{errorInfo:e})}if(i.error){r=i.error.message;throw CV.create("token-subscribe-failed",{errorInfo:r})}if(!i.token)throw CV.create("token-subscribe-no-token");return i.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await SV(e,n),n.token}function LV(e){var t,n,r,i={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return n=i,(t=e).notification&&(n.notification={},(r=t.notification.title)&&(n.notification.title=r),(r=t.notification.body)&&(n.notification.body=r),(r=t.notification.image)&&(n.notification.image=r)),t=i,(n=e).data&&(t.data=n.data),n=i,(e=e).fcmOptions&&(n.fcmOptions={},(r=e.fcmOptions.link)&&(n.fcmOptions.link=r),(r=e.fcmOptions.analytics_label)&&(n.fcmOptions.analyticsLabel=r)),i}function FV(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function UV(e){return CV.create("missing-app-config-values",{valueName:e})}FV("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),FV("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class jV{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var r=function(e){if(!e||!e.options)throw UV("App Configuration Object");if(!e.name)throw UV("App Name");var t=e["options"];for(const n of["projectId","apiKey","appId","messagingSenderId"])if(!t[n])throw UV(n);return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function VV(e){try{e.swRegistration=await navigator.serviceWorker.register(lV,{scope:uV}),e.swRegistration.update().catch(()=>{})}catch(e){throw CV.create("failed-service-worker-registration",{browserErrorMessage:e.message})}}async function qV(e,t){if(!navigator)throw CV.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw CV.create("permission-blocked");var n,r;return n=e,await((r=null==t?void 0:t.vapidKey)?n.vapidKey=r:n.vapidKey||(n.vapidKey=hV)),await async function(e,t){if(t||e.swRegistration||await VV(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw CV.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),DV(e)}async function BV(e,t,n){var r=function(e){switch(e){case rV.NOTIFICATION_CLICKED:return"notification_open";case rV.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);const i=await e.firebaseDependencies.analyticsProvider.get();i.logEvent(r,{message_id:n[fV],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function $V(e,t){var n,r=t.data;r.isFirebaseMessaging&&(e.onMessageHandler&&r.messageType===rV.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(LV(r)):e.onMessageHandler.next(LV(r))),n=r.data,"object"==typeof(t=n)&&t&&fV in t&&"1"===n[pV]&&await BV(e,r.messageType,n))}const KV="@firebase/messaging",WV=e=>{const t=new jV(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>$V(t,e)),t},zV=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>qV(t,e)}};function HV(e){return async function(e){if(!navigator)throw CV.create("only-available-in-window");return e.swRegistration||await VV(e),OV(e)}(e=Kd(e))}function GV(e,t){return function(e,t){if(!navigator)throw CV.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=Kd(e),t)}kf(new Wd("messaging",WV,"PUBLIC")),kf(new Wd("messaging-internal",zV,"PRIVATE")),Of(KV,"0.9.9"),Of(KV,"0.9.9","esm2017");const QV="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",YV="https://fcmregistrations.googleapis.com/v1",JV="FCM_MSG",XV="google.c.a.c_id",ZV=3,eq=1;function tq(e){var t=new Uint8Array(e);const n=btoa(String.fromCharCode(...t));return n.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(yt=iV=iV||{})[yt.DATA_MESSAGE=1]="DATA_MESSAGE",yt[yt.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",(c=sV=sV||{}).PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked";const nq="fcm_token_details_db",rq="fcm_token_object_Store";async function iq(s){if("databases"in indexedDB){const t=await indexedDB.databases(),n=t.map(e=>e.name);if(!n.includes(nq))return null}let o=null;const e=await pf(nq,5,async e=>{var t;if(!(e.oldVersion<2)&&e.objectStoreNames.contains(rq)){const i=e.transaction.objectStore(rq);var n,r=await i.index("fcmSenderId").get(s);await i.clear(),r&&(2===e.oldVersion?(n=r).auth&&n.p256dh&&n.endpoint&&(o={token:n.fcmToken,createTime:null!==(t=n.createTime)&&void 0!==t?t:Date.now(),subscriptionOptions:{auth:n.auth,p256dh:n.p256dh,endpoint:n.endpoint,swScope:n.swScope,vapidKey:"string"==typeof n.vapidKey?n.vapidKey:tq(n.vapidKey)}}):3===e.oldVersion?(n=r,o={token:n.fcmToken,createTime:n.createTime,subscriptionOptions:{auth:tq(n.auth),p256dh:tq(n.p256dh),endpoint:n.endpoint,swScope:n.swScope,vapidKey:tq(n.vapidKey)}}):4===e.oldVersion&&(r=r,o={token:r.fcmToken,createTime:r.createTime,subscriptionOptions:{auth:tq(r.auth),p256dh:tq(r.p256dh),endpoint:r.endpoint,swScope:r.swScope,vapidKey:tq(r.vapidKey)}}))}});return e.close(),await gf(nq),await gf("fcm_vapid_details_db"),await gf("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;var t=e["subscriptionOptions"];return"number"==typeof e.createTime&&0<e.createTime&&"string"==typeof e.token&&0<e.token.length&&"string"==typeof t.auth&&0<t.auth.length&&"string"==typeof t.p256dh&&0<t.p256dh.length&&"string"==typeof t.endpoint&&0<t.endpoint.length&&"string"==typeof t.swScope&&0<t.swScope.length&&"string"==typeof t.vapidKey&&0<t.vapidKey.length}(o)?o:null}const sq="firebase-messaging-database",oq=1,aq="firebase-messaging-store";let cq=null;function lq(){return cq=cq||pf(sq,oq,e=>{0===e.oldVersion&&e.createObjectStore(aq)}),cq}async function uq(e){var t=dq(e);const n=await lq();t=await n.transaction(aq).objectStore(aq).get(t);if(t)return t;t=await iq(e.appConfig.senderId);return t?(await hq(e,t),t):void 0}async function hq(e,t){var n=dq(e);const r=await lq(),i=r.transaction(aq,"readwrite");return await i.objectStore(aq).put(t,n),await i.complete,t}function dq({appConfig:e}){return e.appId}const fq=new md("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function pq(e,t){var n={method:"DELETE",headers:await mq(e)};try{const s=await fetch(`${gq(e.appConfig)}/${t}`,n);var r=await s.json();if(r.error){var i=r.error.message;throw fq.create("token-unsubscribe-failed",{errorInfo:i})}}catch(e){throw fq.create("token-unsubscribe-failed",{errorInfo:e})}}function gq({projectId:e}){return`${YV}/projects/${e}/registrations`}async function mq({appConfig:e,installations:t}){var n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function vq({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==QV&&(i.web.applicationPubKey=r),i}async function yq(e){const t=await async function(e,t){var n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/");const n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}(t)})}(e.swRegistration,e.vapidKey);var n,r,i,s,o,a={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:tq(t.getKey("auth")),p256dh:tq(t.getKey("p256dh"))},c=await uq(e.firebaseDependencies);if(c){if(n=c.subscriptionOptions,r=a.vapidKey===n.vapidKey,i=a.endpoint===n.endpoint,s=a.auth===n.auth,o=a.p256dh===n.p256dh,r&&i&&s&&o)return Date.now()>=c.createTime+6048e5?async function(t,e){try{var n=await async function(e,t){var n=await mq(e),r=vq(t.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{const s=await fetch(`${gq(e.appConfig)}/${t.token}`,r);i=await s.json()}catch(e){throw fq.create("token-update-failed",{errorInfo:e})}if(i.error){r=i.error.message;throw fq.create("token-update-failed",{errorInfo:r})}if(!i.token)throw fq.create("token-update-no-token");return i.token}(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await hq(t.firebaseDependencies,r),n}catch(e){throw await _q(t),e}}(e,{token:c.token,createTime:Date.now(),subscriptionOptions:a}):c.token;try{await pq(e.firebaseDependencies,c.token)}catch(e){console.warn(e)}return wq(e.firebaseDependencies,a)}return wq(e.firebaseDependencies,a)}async function _q(e){var t=await uq(e.firebaseDependencies);t&&(await pq(e.firebaseDependencies,t.token),await async function(e){var t=dq(e);const n=await lq(),r=n.transaction(aq,"readwrite");await r.objectStore(aq).delete(t),await r.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function wq(e,t){var n={token:await async function(e,t){var n=await mq(e),r=vq(t),r={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{const s=await fetch(gq(e.appConfig),r);i=await s.json()}catch(e){throw fq.create("token-subscribe-failed",{errorInfo:e})}if(i.error){r=i.error.message;throw fq.create("token-subscribe-failed",{errorInfo:r})}if(!i.token)throw fq.create("token-subscribe-no-token");return i.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await hq(e,n),n.token}async function bq(e,t){var n=function(e,t){var n;const r={};e.from&&(r.project_number=e.from);e.fcmMessageId&&(r.message_id=e.fcmMessageId);r.instance_id=t,e.notification?r.message_type=iV.DISPLAY_NOTIFICATION.toString():r.message_type=iV.DATA_MESSAGE.toString();r.sdk_platform=ZV.toString(),r.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),e.collapse_key&&(r.collapse_key=e.collapse_key);r.event=eq.toString(),null!==(n=e.fcmOptions)&&void 0!==n&&n.analytics_label&&(r.analytics_label=null===(n=e.fcmOptions)||void 0===n?void 0:n.analytics_label);return r}(t,await e.firebaseDependencies.installations.getId());!function(e,t){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(t),e.logEvents.push(n)}(e,n)}function Iq(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}async function Tq(e,t){var n=function({data:e}){if(!e)return null;try{return e.json()}catch(e){return null}}(e);if(n){t.deliveryMetricsExportedToBigQueryEnabled&&await bq(t,n);var r,i,s=await Sq();if(s.some(e=>"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")))return function(e,t){t.isFirebaseMessaging=!0,t.messageType=sV.PUSH_RECEIVED;for(const n of e)n.postMessage(t)}(s,n);n.notification&&await function(e){var t=e["actions"],n=Notification["maxActions"];t&&n&&t.length>n&&console.warn(`This browser only supports ${n} actions. The remaining actions will not be displayed.`);return self.registration.showNotification(null!==(n=e.title)&&void 0!==n?n:"",e)}(function(e){const t=Object.assign({},e.notification);return t.data={[JV]:e},t}(n)),t&&t.onBackgroundMessageHandler&&(s={from:(r=n).from,collapseKey:r.collapse_key,messageId:r.fcmMessageId},n=s,(e=r).notification&&(n.notification={},(i=e.notification.title)&&(n.notification.title=i),(i=e.notification.body)&&(n.notification.body=i),(i=e.notification.image)&&(n.notification.image=i)),e=s,(n=r).data&&(e.data=n.data),n=s,(r=r).fcmOptions&&(n.fcmOptions={},(i=r.fcmOptions.link)&&(n.fcmOptions.link=i),(i=r.fcmOptions.analytics_label)&&(n.fcmOptions.analyticsLabel=i)),s=s,"function"==typeof t.onBackgroundMessageHandler?await t.onBackgroundMessageHandler(s):t.onBackgroundMessageHandler.next(s))}}async function Eq(e){const t=null===(s=null===(i=e.notification)||void 0===i?void 0:i.data)||void 0===s?void 0:s[JV];if(t&&!e.action){e.stopImmediatePropagation(),e.notification.close();var n=function(e){var t;var n=null!==(t=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==t?t:null===(n=e.notification)||void 0===n?void 0:n.click_action;if(n)return n;return function(e){return"object"==typeof e&&e&&XV in e}(e.data)?self.location.origin:null}(t);if(n){var r,i=new URL(n,self.location.href),s=new URL(self.location.origin);if(i.host===s.host){let e=await async function(e){var t=await Sq();for(const r of t){var n=new URL(r.url,self.location.href);if(e.host===n.host)return r}return null}(i);if(e?e=await e.focus():(e=await self.clients.openWindow(n),r=3e3,await new Promise(e=>{setTimeout(e,r)})),e)return t.messageType=sV.NOTIFICATION_CLICKED,t.isFirebaseMessaging=!0,e.postMessage(t)}}}}function Sq(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function kq(e){return fq.create("missing-app-config-values",{valueName:e})}Iq("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Iq("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Cq{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var r=function(e){if(!e||!e.options)throw kq("App Configuration Object");if(!e.name)throw kq("App Name");var t=e["options"];for(const n of["projectId","apiKey","appId","messagingSenderId"])if(!t[n])throw kq(n);return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}const Aq=e=>{const t=new Cq(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",e=>{e.waitUntil(Tq(e,t))}),self.addEventListener("pushsubscriptionchange",e=>{e.waitUntil(async function(e,t){var n;(n=e["newSubscription"])?(n=await uq(t.firebaseDependencies),await _q(t),t.vapidKey=null!==(n=null===(n=null==n?void 0:n.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==n?n:QV,await yq(t)):await _q(t)}(e,t))}),self.addEventListener("notificationclick",e=>{e.waitUntil(Eq(e))}),t};function Nq(e,t){return function(e,t){if(void 0!==self.document)throw fq.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,()=>{e.onBackgroundMessageHandler=null}}(e=Kd(e),t)}kf(new Wd("messaging-sw",Aq,"PUBLIC"));var Rq,xq,Pq;class Dq{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return async function(e,t){return qV(e=Kd(e),t)}(this._delegate,e)}async deleteToken(){return HV(this._delegate)}onMessage(e){return GV(this._delegate,e)}onBackgroundMessage(e){return Nq(this._delegate,e)}}const Oq=e=>self&&"ServiceWorkerGlobalScope"in self?new Dq(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-sw").getImmediate()):new Dq(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging").getImmediate()),Mq={isSupported:function(){return self&&"ServiceWorkerGlobalScope"in self?dd()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"undefined"!=typeof window&&dd()&&pd()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}};Xf.INTERNAL.registerComponent(new Wd("messaging-compat",Oq,"PUBLIC").setServiceProps(Mq)),Xf.registerVersion("@firebase/messaging-compat","0.1.9");const Lq="firebasestorage.googleapis.com",Fq="storageBucket";class Uq extends gd{constructor(e,t){super(jq(e),`Firebase Storage: ${t} (${jq(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Uq.prototype)}_codeEquals(e){return jq(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function jq(e){return"storage/"+e}function Vq(){return new Uq("unknown","An unknown error occurred, please check the error payload for server response.")}function qq(){return new Uq("canceled","User canceled the upload/download.")}function Bq(){return new Uq("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function $q(e){return new Uq("invalid-argument",e)}function Kq(){return new Uq("app-deleted","The Firebase app was deleted.")}function Wq(e){return new Uq("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function zq(e,t){return new Uq("invalid-format","String does not match format '"+e+"': "+t)}function Hq(e){throw new Uq("internal-error","Internal error: "+e)}class Gq{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=Gq.makeFromUrl(t,e)}catch(e){return new Gq(t,"")}if(""===n.path)return n;throw t=t,new Uq("invalid-default-bucket","Invalid default bucket '"+t+"'.")}static makeFromUrl(e,t){let n=null;var r="([A-Za-z0-9.\\-_]+)";var i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}var o=t.replace(/[.]/g,"\\."),a=new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),o=t===Lq?"(?:storage.googleapis.com|storage.cloud.google.com)":t,c=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:a,indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${o}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let h=0;h<c.length;h++){const d=c[h];var l=d.regex.exec(e);if(l){var u=l[d.indices.bucket];let e=l[d.indices.path];e=e||"",n=new Gq(u,e),d.postModify(n);break}}if(null==n)throw t=e,new Uq("invalid-url","Invalid URL '"+t+"'.");return n}}class Qq{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=0){}}function Yq(e){return"string"==typeof e||e instanceof String}function Jq(e){return Xq()&&e instanceof Blob}function Xq(){return"undefined"!=typeof Blob}function Zq(e,t,n,r){if(r<t)throw $q(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n<r)throw $q(`Invalid value for '${e}'. Expected ${n} or less.`)}function eB(e,t,n){let r=null==n?`https://${t}`:t;return`${n}://${r}/v0${e}`}function tB(e){const t=encodeURIComponent;let n="?";for(const i in e){var r;e.hasOwnProperty(i)&&(r=t(i)+"="+t(e[i]),n=n+r+"&")}return n=n.slice(0,-1),n}(c=Rq=Rq||{})[c.NO_ERROR=0]="NO_ERROR",c[c.NETWORK_ERROR=1]="NETWORK_ERROR",c[c.ABORT=2]="ABORT";class nB{constructor(e,t,n,r,i,s,o,a,c,l,u){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){var e=(r,e)=>{if(e)r(!1,new rB(!1,null,!0));else{const i=this.connectionFactory_();this.pendingConnection_=i;const s=e=>{var t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&i.addUploadProgressListener(s),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&i.removeUploadProgressListener(s),this.pendingConnection_=null;var e,t=i.getErrorCode()===Rq.NO_ERROR,n=i.getStatus();t&&!this.isRetryStatusCode_(n)?(e=-1!==this.successCodes_.indexOf(n),r(!0,new rB(e,i))):(e=i.getErrorCode()===Rq.ABORT,r(!1,new rB(!1,null,e)))})}},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{var s=this.callback_(i,i.getResponse());void 0!==s?n(s):n()}catch(e){r(e)}else if(null!==i){const a=Vq();a.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,a)):r(a)}else{var o;t.canceled?(o=(this.appDelete_?Kq:qq)(),r(o)):(o=new Uq("retry-limit-exceeded","Max retry time for operation exceeded, please try again."),r(o))}};this.canceled_?t(0,new rB(!1,null,!0)):this.backoffId_=function(t,n,e){let r=1,i=null,s=null,o=!1,a=0;function c(){return 2===a}let l=!1;function u(...e){l||(l=!0,n.apply(null,e))}function h(e){i=setTimeout(()=>{i=null,t(f,c())},e)}function d(){s&&clearTimeout(s)}function f(t,...n){if(l)d();else{if(t)return d(),void u.call(null,t,...n);if(c()||o)return d(),void u.call(null,t,...n);r<64&&(r*=2);let e;e=1===a?(a=2,0):1e3*(r+Math.random()),h(e)}}let p=!1;function g(e){p||(p=!0,d(),l||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout(()=>{g(o=!0)},e),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){var t=500<=e&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class rB{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function iB(...t){const n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){const r=new n;for(let e=0;e<t.length;e++)r.append(t[e]);return r.getBlob()}if(Xq())return new Blob(t);throw new Uq("unsupported-environment","This browser doesn't seem to support creating Blobs")}const sB={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class oB{constructor(e,t){this.data=e,this.contentType=t||null}}function aB(e,t){switch(e){case sB.RAW:return new oB(cB(t));case sB.BASE64:case sB.BASE64URL:return new oB(lB(e,t));case sB.DATA_URL:return new oB((n=t,(r=new uB(n)).base64?lB(sB.BASE64,r.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw zq(sB.DATA_URL,"Malformed data URL.")}return cB(t)}(r.rest)),(n=t,new uB(n).contentType))}var n,r;throw Vq()}function cB(t){const n=[];for(let s=0;s<t.length;s++){let e=t.charCodeAt(s);var r,i;e<=127?n.push(e):e<=2047?n.push(192|e>>6,128|63&e):55296==(64512&e)?s<t.length-1&&56320==(64512&t.charCodeAt(s+1))?(r=e,i=t.charCodeAt(++s),e=65536|(1023&r)<<10|1023&i,n.push(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e)):n.push(239,191,189):56320==(64512&e)?n.push(239,191,189):n.push(224|e>>12,128|e>>6&63,128|63&e)}return new Uint8Array(n)}function lB(t,e){switch(t){case sB.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw zq(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case sB.BASE64URL:r=-1!==e.indexOf("+"),n=-1!==e.indexOf("/");if(r||n)throw zq(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}let i;try{i=atob(e)}catch(e){throw zq(t,"Invalid character found")}const s=new Uint8Array(i.length);for(let o=0;o<i.length;o++)s[o]=i.charCodeAt(o);return s}class uB{constructor(e){this.base64=!1,this.contentType=null;var t,n,r=e.match(/^data:([^,]+)?,/);if(null===r)throw zq(sB.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=r[1]||null;null!=i&&(this.base64=(t=i,n=";base64",t.length>=n.length&&t.substring(t.length-n.length)===n),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=e.substring(e.indexOf(",")+1)}}class hB{constructor(e,t){let n=0,r="";Jq(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(Jq(this.data_)){var n=this.data_,n=(i=e,s=t,(r=n).webkitSlice?r.webkitSlice(i,s):r.mozSlice?r.mozSlice(i,s):r.slice?r.slice(i,s):null);return null===n?null:new hB(n)}var r,i,s,n=new Uint8Array(this.data_.buffer,e,t-e);return new hB(n,!0)}static getBlob(...e){if(Xq()){var t=e.map(e=>e instanceof hB?e.data_:e);return new hB(iB.apply(null,t))}{const r=e.map(e=>Yq(e)?aB(sB.RAW,e).data:e.data_);let t=0;r.forEach(e=>{t+=e.byteLength});const i=new Uint8Array(t);let n=0;return r.forEach(e=>{for(let t=0;t<e.length;t++)i[n++]=e[t]}),new hB(i,!0)}}uploadData(){return this.data_}}function dB(e){let t;try{t=JSON.parse(e)}catch(e){return null}return"object"!=typeof(e=t)||Array.isArray(e)?null:t}function fB(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function pB(e,t){return t}class gB{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||pB}}let mB=null;function vB(){if(mB)return mB;const e=[];e.push(new gB("bucket")),e.push(new gB("generation")),e.push(new gB("metageneration")),e.push(new gB("name","fullPath",!0));const t=new gB("name");t.xform=function(e,t){return!Yq(t=t)||t.length<2?t:fB(t)},e.push(t);const n=new gB("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new gB("timeCreated")),e.push(new gB("updated")),e.push(new gB("md5Hash",null,!0)),e.push(new gB("cacheControl",null,!0)),e.push(new gB("contentDisposition",null,!0)),e.push(new gB("contentEncoding",null,!0)),e.push(new gB("contentLanguage",null,!0)),e.push(new gB("contentType",null,!0)),e.push(new gB("metadata","customMetadata",!0)),mB=e,mB}function yB(n,r){Object.defineProperty(n,"ref",{get:function(){var e=n.bucket,t=n.fullPath,t=new Gq(e,t);return r._makeStorageReference(t)}})}function _B(e,t,n){var r=dB(t);return null===r?null:function(e,t,n){const r={type:"file"};var i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,t[o.server])}return yB(r,e),r}(e,r,n)}function wB(e,t){const n={};var r=t.length;for(let s=0;s<r;s++){var i=t[s];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}function bB(e,t,n){var r=dB(n);return null===r?null:function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(const o of n.prefixes){var i=o.replace(/\/$/,""),i=e._makeStorageReference(new Gq(t,i));r.prefixes.push(i)}if(n.items)for(const a of n.items){var s=e._makeStorageReference(new Gq(t,a.name));r.items.push(s)}return r}(e,t,r)}class IB{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function TB(e){if(!e)throw Vq()}function EB(r,i){return function(e,t){var n=_B(r,t,i);return TB(null!==n),n}}function SB(r,i){return function(e,t){var n=bB(r,i,t);return TB(null!==n),n}}function kB(r,i){return function(e,t){var n=_B(r,t,i);return TB(null!==n),function(r,e,i,s){var t=dB(e);if(null===t)return null;if(!Yq(t.downloadTokens))return null;const n=t.downloadTokens;if(0===n.length)return null;const o=encodeURIComponent,a=n.split(",");return a.map(e=>{var t=r.bucket,n=r.fullPath;return eB("/b/"+o(t)+"/o/"+o(n),i,s)+tB({alt:"media",token:e})})[0]}(n,t,r.host,r._protocol)}}function CB(i){return function(e,t){let n;var r;return n=401===e.getStatus()?e.getErrorText().includes("Firebase App Check token is invalid")?new Uq("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Uq("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(r=i.bucket,new Uq("quota-exceeded","Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(e=i.path,new Uq("unauthorized","User does not have permission to access '"+e+"'.")):t,n.serverResponse=t.serverResponse,n}}function AB(r){const i=CB(r);return function(e,t){let n=i(e,t);return 404===e.getStatus()&&(n=(e=r.path,new Uq("object-not-found","Object '"+e+"' does not exist."))),n.serverResponse=t.serverResponse,n}}function NB(e,t,n){var r=eB(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime;const s=new IB(r,"GET",EB(e,n),i);return s.errorHandler=AB(t),s}function RB(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=(e=t,(t=null)&&t.contentType||e&&e.type()||"application/octet-stream")),r}function xB(e,t,n,r,i){var s=t.bucketOnlyServerUrl();const o={"X-Goog-Upload-Protocol":"multipart"};var a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;var c=RB(t,r,i),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+wB(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",a="\r\n--"+a+"--";const u=hB.getBlob(l,r,a);if(null===u)throw Bq();a={name:c.fullPath},c=eB(s,e.host,e._protocol),s=e.maxUploadRetryTime;const h=new IB(c,"POST",EB(e,n),s);return h.urlParams=a,h.headers=o,h.body=u.uploadData(),h.errorHandler=CB(t),h}class PB{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function DB(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){TB(!1)}const r=t||["active"];return TB(!!n&&-1!==r.indexOf(n)),n}function OB(e,t,n,r,i){var s=t.bucketOnlyServerUrl(),o=RB(t,r,i),a={name:o.fullPath},c=eB(s,e.host,e._protocol),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},s=wB(o,n),o=e.maxUploadRetryTime;const u=new IB(c,"POST",function(e){DB(e);let t;try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){TB(!1)}return TB(Yq(t)),t},o);return u.urlParams=a,u.headers=l,u.body=s,u.errorHandler=CB(t),u}function MB(e,t,n,i){var r=e.maxUploadRetryTime;const s=new IB(n,"POST",function(e){var t=DB(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){TB(!1)}n||TB(!1);var r=Number(n);return TB(!isNaN(r)),new PB(r,i.size(),"final"===t)},r);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=CB(t),s}function LB(e,o,t,a,n,c,r,i){const l=new PB(0,0);if(r?(l.current=r.current,l.total=r.total):(l.current=0,l.total=a.size()),a.size()!==l.total)throw new Uq("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var s=l.total-l.current;let u=s;0<n&&(u=Math.min(u,n));var h=l.current,d=h+u,s={"X-Goog-Upload-Command":u===s?"upload, finalize":"upload","X-Goog-Upload-Offset":`${l.current}`};const f=a.slice(h,d);if(null===f)throw Bq();d=o.maxUploadRetryTime;const p=new IB(t,"POST",function(e,t){var n=DB(e,["active","final"]),r=l.current+u,i=a.size();let s;return s="final"===n?EB(o,c)(e,t):null,new PB(r,i,"final"===n,s)},d);return p.headers=s,p.body=f.uploadData(),p.progressCallback=i||null,p.errorHandler=CB(e),p}const FB={STATE_CHANGED:"state_changed"},UB={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function jB(e){switch(e){case"running":case"pausing":case"canceling":return UB.RUNNING;case"paused":return UB.PAUSED;case"success":return UB.SUCCESS;case"canceled":return UB.CANCELED;default:return UB.ERROR}}class VB{constructor(e,t,n){var r;"function"==typeof e||null!=t||null!=n?(this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0):(this.next=(r=e).next,this.error=r.error,this.complete=r.complete)}}function qB(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class BB extends class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Rq.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Rq.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Rq.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw Hq("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Hq("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Hq("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw Hq("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Hq("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function $B(){return new BB}class KB{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=vB(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=e,this._transition("error"))},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))},this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const t=this._transferred;return e=>this._updateProgress(t+e)}_shouldDoResumable(e){return 262144<e.size()}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(n){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([e,t])=>{switch(this._state){case"running":n(e,t);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{var n=OB(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata);const r=this._ref.storage._makeRequest(n,$B,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const i=this._uploadUrl;this._resolveToken((e,t)=>{var n=MB(this._ref.storage,this._ref._location,i,this._blob);const r=this._ref.storage._makeRequest(n,$B,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const i=262144*this._chunkMultiplier,s=new PB(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken((e,t)=>{let n;try{n=LB(this._ref._location,this._ref.storage,o,this._blob,i,this._mappings,s,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const r=this._ref.storage._makeRequest(n,$B,e,t);this._request=r,r.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{var n=NB(this._ref.storage,this._ref._location,this._mappings);const r=this._ref.storage._makeRequest(n,$B,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{var n=xB(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata);const r=this._ref.storage._makeRequest(n,$B,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=qq(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){var e=jB(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new VB(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();const e=this._observers.slice();e.forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(jB(this._state)){case UB.SUCCESS:qB(this._resolve.bind(null,this.snapshot))();break;case UB.CANCELED:case UB.ERROR:const t=this._reject;qB(t.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(jB(this._state)){case UB.RUNNING:case UB.PAUSED:e.next&&qB(e.next.bind(e,this.snapshot))();break;case UB.SUCCESS:e.complete&&qB(e.complete.bind(e))();break;case UB.CANCELED:case UB.ERROR:default:e.error&&qB(e.error.bind(e,this._error))()}}resume(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){var e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class WB{constructor(e,t){this._service=e,t instanceof Gq?this._location=t:this._location=Gq.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new WB(e,t)}get root(){var e=new Gq(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fB(this._location.path)}get storage(){return this._service}get parent(){var e=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;e=new Gq(this._location.bucket,e);return new WB(this._service,e)}_throwIfRoot(e){if(""===this._location.path)throw Wq(e)}}function zB(e){const t={prefixes:[],items:[]};return async function e(t,n,r){const i={pageToken:r};const s=await HB(t,i);n.prefixes.push(...s.prefixes);n.items.push(...s.items);null!=s.nextPageToken&&await e(t,n,s.nextPageToken)}(e,t).then(()=>t)}function HB(e,t){null!=t&&"number"==typeof t.maxResults&&Zq("options.maxResults",1,1e3,t.maxResults);var n=t||{},n=function(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&0<n.length&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);var o=eB(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime;const c=new IB(o,"GET",SB(e,t.bucket),a);return c.urlParams=s,c.errorHandler=CB(t),c}(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(n,$B)}function GB(e,t){e._throwIfRoot("updateMetadata");var n=function(e,t,n,r){var i=eB(t.fullServerUrl(),e.host,e._protocol),s=wB(n,r),o=e.maxOperationRetryTime;const a=new IB(i,"PATCH",EB(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=AB(t),a}(e.storage,e._location,t,vB());return e.storage.makeRequestWithTokens(n,$B)}function QB(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=eB(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime;const s=new IB(r,"GET",kB(e,n),i);return s.errorHandler=AB(t),s}(e.storage,e._location,vB());return e.storage.makeRequestWithTokens(t,$B).then(e=>{if(null===e)throw new Uq("no-download-url","The given file does not have any download URLs.");return e})}function YB(e){e._throwIfRoot("deleteObject");var t=function(e,t){var n=eB(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime;const i=new IB(n,"DELETE",function(e,t){},r);return i.successCodes=[200,204],i.errorHandler=AB(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,$B)}function JB(e,t){var n,r=(n=e._location.path,r=t.split("/").filter(e=>0<e.length).join("/"),0===n.length?r:n+"/"+r),r=new Gq(e._location.bucket,r);return new WB(e.storage,r)}function XB(e,t){if(e instanceof t2){var n=e;if(null==n._bucket)throw new Uq("no-default-bucket","No default bucket found. Did you set the '"+Fq+"' property when initializing the app?");n=new WB(n,n._bucket);return null!=t?XB(n,t):n}return void 0!==t?JB(e,t):e}function ZB(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof t2)return n=e,r=t,new WB(n,r);throw $q("To use ref(service, url), the first argument must be a Storage instance.")}return XB(e,t);var n,r}function e2(e,t){var n=null==t?void 0:t[Fq];return null==n?null:Gq.makeFromBucketSpec(n,e)}class t2{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=Lq,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Gq.makeFromBucketSpec(r,this._host):e2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Gq.makeFromBucketSpec(this._url,e):this._bucket=e2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Zq("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Zq("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){var t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new WB(this,e)}_makeRequest(e,t,n,r){if(this._deleted)return new Qq(Kq());{const l=(i=e,s=this._appId,o=n,e=r,n=t,r=this._firebaseVersion,a=tB(i.urlParams),c=i.url+a,a=Object.assign({},i.headers),t=a,(s=s)&&(t["X-Firebase-GMPID"]=s),s=a,null!==(o=o)&&0<o.length&&(s.Authorization="Firebase "+o),r=r,a["X-Firebase-Storage-Version"]="webjs/"+(null!=r?r:"AppManager"),r=a,null!==(e=e)&&(r["X-Firebase-AppCheck"]=e),new nB(c,i.method,a,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,n));return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}var i,s,o,a,c}async makeRequestWithTokens(e,t){var[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const n2="@firebase/storage";function r2(e,t,n){return e=Kd(e),t=t,n=n,(e=e)._throwIfRoot("uploadBytesResumable"),new KB(e,new hB(t),n)}function i2(e){return function(e){e._throwIfRoot("getMetadata");var t=NB(e.storage,e._location,vB());return e.storage.makeRequestWithTokens(t,$B)}(e=Kd(e))}function s2(e,t){return ZB(e=Kd(e),t)}function o2(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";var i=r["mockUserToken"];i&&(e._overrideAuthToken="string"==typeof i?i:id(i,e.app.options.projectId))}(e,t,n,r)}function a2(e,{instanceIdentifier:t}){var n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new t2(n,r,i,t,Rf)}kf(new Wd("storage",a2,"PUBLIC").setMultipleInstances(!0)),Of(n2,"0.9.2",""),Of(n2,"0.9.2","esm2017");class c2{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class l2{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new c2(this._delegate.snapshot,this,this._ref)}then(t,e){return this._delegate.then(e=>{if(t)return t(new c2(e,this,this._ref))},e)}on(e,t,n,r){let i=void 0;return t&&(i="function"==typeof t?e=>t(new c2(e,this,this._ref)):{next:t.next?e=>t.next(new c2(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class u2{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new h2(e,this._service))}get items(){return this._delegate.items.map(e=>new h2(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class h2{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){var t=JB(this._delegate,e);return new h2(t,this.storage)}get root(){return new h2(this._delegate.root,this.storage)}get parent(){var e=this._delegate.parent;return null==e?null:new h2(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new l2(r2(this._delegate,e,t),this)}putString(e,t=sB.RAW,n){this._throwIfRoot("putString");var r=aB(t,e);const i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new l2(new KB(this._delegate,new hB(r.data,!0),i),this)}listAll(){return zB(Kd(this._delegate)).then(e=>new u2(e,this.storage))}list(e){return t=this._delegate,e=e||void 0,HB(t=Kd(t),e).then(e=>new u2(e,this.storage));var t}getMetadata(){return i2(this._delegate)}updateMetadata(e){return GB(Kd(this._delegate),e)}getDownloadURL(){return QB(Kd(this._delegate))}delete(){return this._throwIfRoot("delete"),YB(Kd(this._delegate))}_throwIfRoot(e){if(""===this._delegate._location.path)throw Wq(e)}}class d2{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(f2(e))throw $q("ref() expected a child path but got a URL, use refFromURL instead.");return new h2(s2(this._delegate,e),this)}refFromURL(e){if(!f2(e))throw $q("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Gq.makeFromUrl(e,this._delegate.host)}catch(e){throw $q("refFromUrl() expected a valid full URL but got an invalid one.")}return new h2(s2(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,n={}){o2(this._delegate,e,t,n)}}function f2(e){return/^[A-Za-z]+:\/\//.test(e)}function p2(e,{instanceIdentifier:t}){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage").getImmediate({identifier:t});return new d2(n,r)}xq=Xf,Pq={TaskState:UB,TaskEvent:FB,StringFormat:sB,Storage:d2,Reference:h2},xq.INTERNAL.registerComponent(new Wd("storage-compat",p2,"PUBLIC").setServiceProps(Pq).setMultipleInstances(!0)),xq.registerVersion("@firebase/storage-compat","0.1.10");const g2="@firebase/performance",m2="0.5.5",v2="FB-PERF-TRACE-MEASURE",y2="@firebase/performance/config",_2="@firebase/performance/configexpire";var w2,b2,I2,T2="Performance";const E2=new md("performance",T2,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),S2=new ef(T2);S2.logLevel=Kh.INFO;let k2,C2;class A2{constructor(e){if(!(this.window=e))throw E2.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&pd()?!!dd()||(S2.info("IndexedDB is not supported by current browswer"),!1):(S2.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,n){if(this.PerformanceObserver){const t=new this.PerformanceObserver(e=>{for(const t of e.getEntries())n(t)});t.observe({entryTypes:[e]})}}static getInstance(){return void 0===k2&&(k2=new A2(C2)),k2}}let N2;function R2(e,t){var n=e.length-t.length;if(n<0||1<n)throw E2.create("invalid String merger input");const r=[];for(let i=0;i<e.length;i++)r.push(e.charAt(i)),t.length>i&&r.push(t.charAt(i));return r.join("")}let x2;class P2{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=R2("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=R2("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===x2&&(x2=new P2),x2}}(c=w2=w2||{})[c.UNKNOWN=0]="UNKNOWN",c[c.VISIBLE=1]="VISIBLE",c[c.HIDDEN=2]="HIDDEN";const D2=["firebase_","google_","ga_"],O2=new RegExp("^[a-zA-Z]\\w*$");function M2(){switch(A2.getInstance().document.visibilityState){case"visible":return w2.VISIBLE;case"hidden":return w2.HIDDEN;default:return w2.UNKNOWN}}function L2(e){var t=null===(t=e.options)||void 0===t?void 0:t.appId;if(!t)throw E2.create("no app id");return t}const F2="0.0.1",U2={loggingEnabled:!0},j2="FIREBASE_INSTALLATIONS_AUTH";function V2(e,t){var r,i,n=function(){const e=A2.getInstance().localStorage;if(e){var t=e.getItem(_2);if(t&&function(e){return Number(e)>Date.now()}(t)){t=e.getItem(y2);if(t)try{return JSON.parse(t)}catch(e){return}}}}();return n?(B2(n),Promise.resolve()):(i=t,function(e){const t=e.getToken();return t.then(e=>{}),t}((r=e).installations).then(e=>{var t=function(e){var t=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!t)throw E2.create("no project id");return t}(r.app),n=function(e){var t=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!t)throw E2.create("no api key");return t}(r.app),n=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${t}/namespaces/fireperf:fetch?key=${n}`,{method:"POST",headers:{Authorization:`${j2} ${e}`},body:JSON.stringify({app_instance_id:i,app_instance_id_token:e,app_id:L2(r.app),app_version:m2,sdk_version:F2})});return fetch(n).then(e=>{if(e.ok)return e.json();throw E2.create("RC response not ok")})}).catch(()=>{S2.info(q2)}).then(B2).then(e=>function(e){const t=A2.getInstance().localStorage;e&&t&&(t.setItem(y2,JSON.stringify(e)),t.setItem(_2,String(Date.now()+60*P2.getInstance().configTimeToLive*60*1e3)))}(e),()=>{}))}const q2="Could not fetch config, will use default configs";function B2(e){if(!e)return e;const t=P2.getInstance();var n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=U2.loggingEnabled,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=$2(t.tracesSamplingRate),t.logNetworkAfterSampling=$2(t.networkRequestsSamplingRate),e}function $2(e){return Math.random()<=e}let K2=1,W2;function z2(e){var t;return K2=2,W2=W2||(t=e,function(){const n=A2.getInstance().document;return new Promise(e=>{if(n&&"complete"!==n.readyState){const t=()=>{"complete"===n.readyState&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}().then(()=>function(e){const t=e.getId();return t.then(e=>{N2=e}),t}(t.installations)).then(e=>V2(t,e)).then(()=>H2(),()=>H2())),W2}function H2(){K2=3}const G2=1e4,Q2=3,Y2=1e3;let J2=Q2,X2=[],Z2=!1;function e$(e){setTimeout(()=>{if(0!==J2)return X2.length?void function(){const e=X2.splice(0,Y2),t=e.map(e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:P2.getInstance().logSource,log_event:t};!function(e,r){return function(e){var t=P2.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then(e=>(e.ok||S2.info("Call to Firebase backend failed."),e.json())).then(e=>{var t=Number(e.nextRequestWaitMillis);let n=G2;isNaN(t)||(n=Math.max(t,n));t=e.logResponseDetails;Array.isArray(t)&&0<t.length&&"RETRY_REQUEST_LATER"===t[0].responseAction&&(X2=[...r,...X2],S2.info("Retry transport request later.")),J2=Q2,e$(n)})}(n,e).catch(()=>{X2=[...e,...X2],J2--,S2.info(`Tries left: ${J2}.`),e$(G2)})}():e$(G2)},e)}function t$(t){return(...e)=>{!function(e){if(!e.eventTime||!e.message)throw E2.create("invalid cc log");X2=[...X2,e]}({message:t(...e),eventTime:Date.now()})}}let n$;function r$(e,t){n$=n$||t$(o$),n$(e,t)}function i$(e){var t=P2.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&A2.getInstance().requiredApisAvailable()&&(e.isAuto&&M2()!==w2.VISIBLE||(3===K2?s$(e):z2(e.performanceController).then(()=>s$(e),()=>s$(e))))}function s$(e){var t;!N2||(t=P2.getInstance()).loggingEnabled&&t.logTraceAfterSampling&&setTimeout(()=>r$(e,1),0)}function o$(e,t){return 0===t?(n={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:a$(e.performanceController.app),network_request_metric:n},JSON.stringify(n)):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);var n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);n={application_info:a$(e.performanceController.app),trace_metric:t};return JSON.stringify(n)}(e);var n}function a$(e){return{google_app_id:L2(e),app_instance_id:N2,web_app_info:{sdk_version:m2,page_url:A2.getInstance().getUrl(),service_worker_status:"serviceWorker"in(t=A2.getInstance().navigator)?t.serviceWorker.controller?2:3:1,visibility_state:M2(),effective_connection_type:function(){var e=A2.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var t}const c$=["_fp","_fcp","_fid"];class l${constructor(e,t,n=!1,r){this.performanceController=e,this.name=t,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=A2.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`${v2}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw E2.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw E2.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),i$(this)}record(e,t,n){if(e<=0)throw E2.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw E2.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const r of Object.keys(n.metrics))isNaN(Number(n.metrics[r]))||(this.counters[r]=Math.floor(Number(n.metrics[r])));i$(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(r=e,i=this.name,0===r.length||100<r.length||!(i&&i.startsWith("_wt_")&&-1<c$.indexOf(r))&&r.startsWith("_"))throw E2.create("invalid custom metric name",{customMetricName:e});var n,r,i;this.counters[e]=(t=null!=t?t:0,(n=Math.floor(t))<t&&S2.info(`Metric value should be an Integer, setting the value as : ${n}.`),n)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){var n,r,i=!(0===(n=e).length||40<n.length)&&(!D2.some(e=>n.startsWith(e))&&!!n.match(O2)),s=0!==(r=t).length&&r.length<=100;if(i&&s)this.customAttributes[e]=t;else{if(!i)throw E2.create("invalid attribute name",{attributeName:e});if(!s)throw E2.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){var e=this.api.getEntriesByName(this.traceMeasure),e=e&&e[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n,r){var i=A2.getInstance().getUrl();if(i){const s=new l$(e,"_wt_"+i,!0);i=Math.floor(1e3*A2.getInstance().getTimeOrigin());s.setStartTime(i),t&&t[0]&&(s.setDuration(Math.floor(1e3*t[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));n&&((i=n.find(e=>"first-paint"===e.name))&&i.startTime&&s.putMetric("_fp",Math.floor(1e3*i.startTime)),(i=n.find(e=>"first-contentful-paint"===e.name))&&i.startTime&&s.putMetric("_fcp",Math.floor(1e3*i.startTime)),r&&s.putMetric("_fid",Math.floor(1e3*r))),i$(s)}}static createUserTimingTrace(e,t){i$(new l$(e,t,!1,t))}}function u$(e,t){const n=t;var r,i,s;n&&void 0!==n.responseStart&&(s=A2.getInstance().getTimeOrigin(),r=Math.floor(1e3*(n.startTime+s)),i=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,s=Math.floor(1e3*(n.responseEnd-n.startTime)),function(e){const t=P2.getInstance();var n,r,i;t.instrumentationEnabled&&(n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0],n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout(()=>r$(e,0),0))}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:s}))}const h$=5e3;function d$(e){N2&&(setTimeout(()=>function(n){const e=A2.getInstance(),r=e.getEntriesByType("navigation"),i=e.getEntriesByType("paint");if(e.onFirstInputDelay){let t=setTimeout(()=>{l$.createOobTrace(n,r,i),t=void 0},h$);e.onFirstInputDelay(e=>{t&&(clearTimeout(t),l$.createOobTrace(n,r,i,e))})}else l$.createOobTrace(n,r,i)}(e),0),setTimeout(()=>function(t){const e=A2.getInstance(),n=e.getEntriesByType("resource");for(const r of n)u$(t,r);e.setupObserver("resource",e=>u$(t,e))}(e),0),setTimeout(()=>function(t){const e=A2.getInstance(),n=e.getEntriesByType("measure");for(const r of n)f$(t,r);e.setupObserver("measure",e=>f$(t,e))}(e),0))}function f$(e,t){const n=t.name;n.substring(0,v2.length)!==v2&&l$.createUserTimingTrace(e,n)}class p${constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),A2.getInstance().requiredApisAvailable()?fd().then(e=>{e&&(Z2||(e$(5500),Z2=!0),z2(this).then(()=>d$(this),()=>d$(this)),this.initialized=!0)}).catch(e=>{S2.info(`Environment doesn't support IndexedDB: ${e}`)}):S2.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){P2.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return P2.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){P2.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return P2.getInstance().dataCollectionEnabled}}const g$="[DEFAULT]";const m$=(e,{options:t})=>{var n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(n.name!==g$)throw E2.create("FB not default");if("undefined"==typeof window)throw E2.create("no window");e=window,C2=e;const i=new p$(n,r);return i._init(t),i};kf(new Wd("performance",m$,"PUBLIC")),Of(g2,"0.5.5"),Of(g2,"0.5.5","esm2017");class v${constructor(e,t){this.app=e,this._delegate=t}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return t=this._delegate,e=e,t=Kd(t),new l$(t,e);var t}}function y$(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("performance").getImmediate();return new v$(t,n)}(b2=Xf).INTERNAL.registerComponent(new Wd("performance-compat",y$,"PUBLIC")),b2.registerVersion("@firebase/performance-compat","0.1.5");const _$="@firebase/remote-config";class w${constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}const b$=new md("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});const I$=["1","true","t","yes","y","on"];class T${constructor(e,t=""){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return"static"!==this._source&&0<=I$.indexOf(this._value.toLowerCase())}asNumber(){if("static"===this._source)return 0;let e=Number(this._value);return isNaN(e)&&(e=0),e}getSource(){return this._source}}async function E$(e){const t=Kd(e);var[n,r]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!!(n&&n.config&&n.eTag&&n.eTag!==r)&&(await Promise.all([t._storageCache.setActiveConfig(n.config),t._storage.setActiveConfigEtag(n.eTag)]),!0)}function S$(e){const t=Kd(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0})),t._initializePromise}async function k$(t){const n=Kd(t),e=new w$;setTimeout(async()=>{e.abort()},n.settings.fetchTimeoutMillis);try{await n._client.fetch({cacheMaxAgeMillis:n.settings.minimumFetchIntervalMillis,signal:e}),await n._storageCache.setLastFetchStatus("success")}catch(e){var r=(i="fetch-throttle",(t=e)instanceof gd&&-1!==t.code.indexOf(i)?"throttle":"failure");throw await n._storageCache.setLastFetchStatus(r),e}var i}function C$(n){const e=Kd(n);return[t={},r={}]=[e._storageCache.getActiveConfig(),e.defaultConfig],Object.keys(Object.assign(Object.assign({},t),r)).reduce((e,t)=>(e[t]=A$(n,t),e),{});var t,r}function A$(e,t){const n=Kd(e);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${t}" before SDK initialization completed.`+" Await on ensureInitialized if the intent was to get a previously activated value.");var r=n._storageCache.getActiveConfig();return r&&void 0!==r[t]?new T$("remote",r[t]):n.defaultConfig&&void 0!==n.defaultConfig[t]?new T$("default",String(n.defaultConfig[t])):(n._logger.debug(`Returning static value for key "${t}".`+" Define a default or remote value if this is unintentional."),new T$("static"))}class N${constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check."+` Cache age millis: ${n}.`+` Cache max age millis (minimumFetchIntervalMillis setting): ${e}.`+` Is cache hit: ${r}.`),r}async fetch(e){var[t,n]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(n&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return n;e.eTag=n&&n.eTag;n=await this.client.fetch(e);const r=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===n.status&&r.push(this.storage.setLastSuccessfulFetchResponse(n)),await Promise.all(r),n}}class R${constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}async fetch(n){var e,[t,r]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),i=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":n.eTag||"*"},r={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:r,app_id:this.appId,language_code:(e=navigator).languages&&e.languages[0]||e.language},r={method:"POST",headers:s,body:JSON.stringify(r)},i=fetch(i,r),r=new Promise((e,t)=>{n.signal.addEventListener(()=>{const e=new Error("The operation was aborted.");e.name="AbortError",t(e)})});let o;try{await Promise.race([i,r]),o=await i}catch(e){let t="fetch-client-network";throw"AbortError"===e.name&&(t="fetch-timeout"),b$.create(t,{originalErrorMessage:e.message})}let a=o.status;i=o.headers.get("ETag")||void 0;let c,l;if(200===o.status){let e;try{e=await o.json()}catch(e){throw b$.create("fetch-client-parse",{originalErrorMessage:e.message})}c=e.entries,l=e.state}if("INSTANCE_STATE_UNSPECIFIED"===l?a=500:"NO_CHANGE"===l?a=304:"NO_TEMPLATE"!==l&&"EMPTY_CONFIG"!==l||(c={}),304!==a&&200!==a)throw b$.create("fetch-status",{httpStatus:a});return{status:a,eTag:i,config:c}}}class x${constructor(e,t){this.client=e,this.storage=t}async fetch(e){var t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:n}){var i,s;i=t.signal,s=e,await new Promise((e,t)=>{var n=Math.max(s-Date.now(),0);const r=setTimeout(e,n);i.addEventListener(()=>{clearTimeout(r),t(b$.create("fetch-throttle",{throttleEndTimeMillis:s}))})});try{var r=await this.client.fetch(t);return await this.storage.deleteThrottleMetadata(),r}catch(e){if(!function(e){if(e instanceof gd&&e.customData){var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}}(e))throw e;r={throttleEndTimeMillis:Date.now()+$d(n),backoffCount:n+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(t,r)}}}class P${constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function D$(e,t){var n=e.target.error||void 0;return b$.create(t,{originalErrorMessage:n&&n.message})}const O$="app_namespace_store";class M${constructor(e,t,n,r=function(){return new Promise((t,n)=>{try{const e=indexedDB.open("firebase_remote_config",1);e.onerror=e=>{n(D$(e,"storage-open"))},e.onsuccess=e=>{t(e.target.result)},e.onupgradeneeded=e=>{const t=e.target.result;0===e.oldVersion&&t.createObjectStore(O$,{keyPath:"compositeKey"})}}catch(e){n(b$.create("storage-open",{originalErrorMessage:e}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(o){const a=await this.openDbPromise;return new Promise((n,t)=>{const e=a.transaction([O$],"readonly"),r=e.objectStore(O$);var i=this.createCompositeKey(o);try{const s=r.get(i);s.onerror=e=>{t(D$(e,"storage-get"))},s.onsuccess=e=>{var t=e.target.result;n(t?t.value:void 0)}}catch(e){t(b$.create("storage-get",{originalErrorMessage:e&&e.message}))}})}async set(o,a){const c=await this.openDbPromise;return new Promise((e,t)=>{const n=c.transaction([O$],"readwrite"),r=n.objectStore(O$);var i=this.createCompositeKey(o);try{const s=r.put({compositeKey:i,value:a});s.onerror=e=>{t(D$(e,"storage-set"))},s.onsuccess=()=>{e()}}catch(e){t(b$.create("storage-set",{originalErrorMessage:e&&e.message}))}})}async delete(o){const a=await this.openDbPromise;return new Promise((e,t)=>{const n=a.transaction([O$],"readwrite"),r=n.objectStore(O$);var i=this.createCompositeKey(o);try{const s=r.delete(i);s.onerror=e=>{t(D$(e,"storage-delete"))},s.onsuccess=()=>{e()}}catch(e){t(b$.create("storage-delete",{originalErrorMessage:e&&e.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class L${constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){var e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),e=await e;e&&(this.lastFetchStatus=e);t=await t;t&&(this.lastSuccessfulFetchTimestampMillis=t);n=await n;n&&(this.activeConfig=n)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}async function F$(){if(!dd())return!1;try{return await fd()}catch(e){return!1}}kf(new Wd("remote-config",function(e,{instanceIdentifier:t}){var n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw b$.create("registration-window");if(!dd())throw b$.create("indexed-db-unavailable");var{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw b$.create("registration-project-id");if(!s)throw b$.create("registration-api-key");if(!o)throw b$.create("registration-app-id");t=t||"firebase";const a=new M$(o,n.name,t),c=new L$(a),l=new ef(_$);l.logLevel=Kh.ERROR;o=new R$(r,Rf,t,i,s,o),o=new x$(o,a),o=new N$(o,a,c,l),o=new P$(n,o,c,a,l);return S$(o),o},"PUBLIC").setMultipleInstances(!0)),Of(_$,"0.3.4"),Of(_$,"0.3.4","esm2017");class U${constructor(e,t){this.app=e,this._delegate=t}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return E$(this._delegate)}ensureInitialized(){return S$(this._delegate)}fetch(){return k$(this._delegate)}fetchAndActivate(){return async function(e){return await k$(e=Kd(e)),E$(e)}(this._delegate)}getAll(){return C$(this._delegate)}getBoolean(e){return A$(Kd(this._delegate),e).asBoolean()}getNumber(e){return A$(Kd(this._delegate),e).asNumber()}getString(e){return A$(Kd(this._delegate),e).asString()}getValue(e){return A$(this._delegate,e)}setLogLevel(e){!function(e,t){const n=Kd(e);switch(t){case"debug":n._logger.logLevel=Kh.DEBUG;break;case"silent":n._logger.logLevel=Kh.SILENT;break;default:n._logger.logLevel=Kh.ERROR}}(this._delegate,e)}}function j$(e,{instanceIdentifier:t}){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("remote-config").getImmediate({identifier:t});return new U$(n,r)}return(I2=Xf).INTERNAL.registerComponent(new Wd("remoteConfig-compat",j$,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:F$})),I2.registerVersion("@firebase/remote-config-compat","0.1.5"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),Xf.registerVersion("firebase","9.6.8","compat-cdn"),Xf});
//# sourceMappingURL=firebase-compat.js.map
